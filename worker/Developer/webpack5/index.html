<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no"><title>webpack5 | Ada</title><meta name="keywords" content="前端基础,Webpack,eslint"><meta name="author" content="Ada"><meta name="copyright" content="Ada"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#f7f9fe"><meta name="mobile-web-app-capable" content="yes"><meta name="apple-touch-fullscreen" content="yes"><meta name="apple-mobile-web-app-title" content="webpack5"><meta name="application-name" content="webpack5"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="#f7f9fe"><meta property="og:type" content="article"><meta property="og:title" content="webpack5"><meta property="og:url" content="https://adalucky.github.io/worker/Developer/webpack5/index.html"><meta property="og:site_name" content="Ada"><meta property="og:description" content="简介webpack 是代码编译工具，有入口、出口、loader 和插件。webpack 是一个用于现代JavaScript应用程序的静态模块打包工具。当 webpack 处理应用程序时，它会在内部构建一个依赖图(dependency graph)，此依赖图对应映射到项目所需的每个模块，并生成一个或多"><meta property="og:locale" content="zh-CN"><meta property="og:image" content="https://automation-manage.oss-cn-shanghai.aliyuncs.com/blog/auto/webpack.jpg"><meta property="article:author" content="Ada"><meta property="article:tag"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://automation-manage.oss-cn-shanghai.aliyuncs.com/blog/auto/webpack.jpg"><link rel="shortcut icon" href="https://image.3001.net/images/20210606/16229390604952.png"><link rel="canonical" href="https://adalucky.github.io/worker/Developer/webpack5/"><link rel="preconnect" href="//npm.elemecdn.com"/><link rel="preconnect" href="//npm.onmicrosoft.cn"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><meta name="google-site-verification" content="xxx"/><meta name="baidu-site-verification" content="code-xxx"/><meta name="msvalidate.01" content="xxx"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.cbd.int/@fortawesome/fontawesome-free@6.4.0/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.cbd.int/node-snackbar@0.1.16/dist/snackbar.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.cbd.int/@fancyapps/ui@5.0.20/dist/fancybox/fancybox.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  preloader: {"source":3},
  friends_vue_info: undefined,
  navMusic: false,
  mainTone: {"mode":"both","api":"https://img2color-go.vercel.app/api?img=","cover_change":true},
  authorStatus: undefined,
  algolia: {"appId":"Y7A93ZJERO","apiKey":"c032c0266df92b8e1e7f23f484b1992a","indexName":"hexo","hits":{"per_page":6},"languages":{"input_placeholder":"键入后按下回车搜索！","hits_empty":"找不到您查询的内容：${query}","hits_stats":"找到 ${hits} 条结果，用时 ${time} 毫秒"}},
  localSearch: undefined,
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"简","rightMenuMsgToTraditionalChinese":"转为繁体","rightMenuMsgToSimplifiedChinese":"转为简体"},
  noticeOutdate: {"limitDay":365,"position":"top","messagePrev":"It has been","messageNext":"days since the last update, the content of the article may be outdated."},
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":330},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    simplehomepage: true,
    post: false
  },
  runtime: '天',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: {"chs_to_cht":"你已切换为繁体","cht_to_chs":"你已切换为简体","day_to_night":"你已切换为深色模式","night_to_day":"你已切换为浅色模式","bgLight":"#3b70fc","bgDark":"#1f1f1f","position":"top-center"},
  source: {
    justifiedGallery: {
      js: 'https://cdn.cbd.int/flickr-justified-gallery@2.1.2/dist/fjGallery.min.js',
      css: 'https://cdn.cbd.int/flickr-justified-gallery@2.1.2/dist/fjGallery.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: true,
  isAnchor: false,
  shortcutKey: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'webpack5',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2023-09-15 12:42:30',
  postMainColor: '',
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
    win.getCSS = (url,id = false) => new Promise((resolve, reject) => {
      const link = document.createElement('link')
      link.rel = 'stylesheet'
      link.href = url
      if (id) link.id = id
      link.onerror = reject
      link.onload = link.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        link.onload = link.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(link)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#18171d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#f7f9fe')
        }
      }
      const t = saveToLocal.get('theme')
    
          const isDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches
          const isLightMode = window.matchMedia('(prefers-color-scheme: light)').matches
          const isNotSpecified = window.matchMedia('(prefers-color-scheme: no-preference)').matches
          const hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified

          if (t === undefined) {
            if (isLightMode) activateLightMode()
            else if (isDarkMode) activateDarkMode()
            else if (isNotSpecified || hasNoSupport) {
              const now = new Date()
              const hour = now.getHours()
              const isNight = hour <= 6 || hour >= 18
              isNight ? activateDarkMode() : activateLightMode()
            }
            window.matchMedia('(prefers-color-scheme: dark)').addListener(function (e) {
              if (saveToLocal.get('theme') === undefined) {
                e.matches ? activateDarkMode() : activateLightMode()
              }
            })
          } else if (t === 'light') activateLightMode()
          else activateDarkMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><link rel="stylesheet" href="/assets/css/webpushr.css?1"><meta name="generator" content="Hexo 6.3.0"></head><body data-type="anzhiyu"><div id="web_bg"></div><div id="an_music_bg"></div><div id="loading-box" onclick="document.getElementById(&quot;loading-box&quot;).classList.add(&quot;loaded&quot;)"><div class="loading-bg"><img class="loading-img nolazyload" alt="加载头像" src="https://image.3001.net/images/20210606/16229390604952.png"/><div class="loading-image-dot"></div><div id="loading-percentage">0%</div></div></div><script>if (GLOBAL_CONFIG.preloader.source == "2" || GLOBAL_CONFIG.preloader.source == "3") {
  const loadingPercentage = document.getElementById("loading-percentage");
  let loadingPercentageTimer = setInterval(function() {
    var progressBar = document.querySelector(".pace-progress");
    if (!progressBar) return
    var currentValue = progressBar.getAttribute("data-progress-text");
    if (currentValue !== loadingPercentage.textContent) {
      loadingPercentage.textContent = currentValue;
      if (currentValue === "100%") {
        clearInterval(loadingPercentageTimer);
      }
    }
  }, 100);
}

const preloader = {
  endLoading: () => {
    document.body.style.overflow = 'auto';
    document.getElementById('loading-box').classList.add("loaded");
  },
  initLoading: () => {
    document.body.style.overflow = '';
    document.getElementById('loading-box').classList.remove("loaded")
  }
}
window.addEventListener('load',()=> { preloader.endLoading() })
setTimeout(function(){preloader.endLoading();},10000)

if (true) {
  document.addEventListener('pjax:send', () => { preloader.initLoading() })
  document.addEventListener('pjax:complete', () => { preloader.endLoading() })
}</script><link rel="stylesheet" href="https://cdn.cbd.int/anzhiyu-theme-static@1.0.0/progress_bar/progress_bar.css"/><script async="async" src="https://cdn.cbd.int/pace-js@1.2.4/pace.min.js" data-pace-options="{ &quot;restartOnRequestAfter&quot;:false,&quot;eventLag&quot;:false}"></script><div id="web_box"><div id="web_container"><div id="menu-mask"></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header"><nav id="nav"><div id="nav-group"><span id="blog_name"><div class="back-home-button"><i class="anzhiyufont anzhiyu-icon-grip-vertical"></i><div class="back-menu-list-groups"><div class="back-menu-list-group"><div class="back-menu-list-title">网页</div><div class="back-menu-list"><a class="back-menu-item" href="https://adalucky.github.io/" title="博客" target="_blank"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/favicon.ico" alt="博客"/><span class="back-menu-item-text">博客</span></a></div></div><div class="back-menu-list-group"><div class="back-menu-list-title">项目</div><div class="back-menu-list"><a class="back-menu-item" href="https://gitee.com/automatex/automate/" title="测试平台" target="_blank"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://image.anheyu.com/favicon.ico" alt="测试平台"/><span class="back-menu-item-text">测试平台</span></a></div></div></div></div><a id="site-name" href="/" accesskey="h"><div class="title">Ada</div><i class="anzhiyufont anzhiyu-icon-house-chimney"></i></a></span><div class="mask-name-container"><div id="name-container"><a id="page-name" href="javascript:anzhiyu.scrollToDest(0, 500)">PAGE_NAME</a></div></div><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page faa-parent animated-hover" href="/archives/"><span> 总览</span></a></div><div class="menus_item"><a class="site-page faa-parent animated-hover" href="/categories/"><span> 分类</span></a></div><div class="menus_item"><a class="site-page faa-parent animated-hover" href="/tags/"><span> 标签</span></a></div></div></div><div id="nav-right"><div class="nav-button" id="randomPost_button"><a class="site-page" onclick="toRandomPost()" title="随机前往一个文章" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-dice"></i></a></div><div class="nav-button" id="search-button"><a class="site-page social-icon search" href="javascript:void(0);" title="搜索🔍" accesskey="s"><i class="anzhiyufont anzhiyu-icon-magnifying-glass"></i><span> 搜索</span></a></div><input id="center-console" type="checkbox"/><label class="widget" for="center-console" title="中控台" onclick="anzhiyu.switchConsole();"><i class="left"></i><i class="widget center"></i><i class="widget right"></i></label><div id="console"><div class="console-card-group-reward"><ul class="reward-all console-card"><li class="reward-item"><a href="https://automation-manage.oss-cn-shanghai.aliyuncs.com/blog/wechat.png" target="_blank"><img class="post-qr-code-img" alt="wechat" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://automation-manage.oss-cn-shanghai.aliyuncs.com/blog/wechat.png"/></a><div class="post-qr-code-desc">wechat</div></li><li class="reward-item"><a href="https://automation-manage.oss-cn-shanghai.aliyuncs.com/blog/alipay.png" target="_blank"><img class="post-qr-code-img" alt="alipay" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://automation-manage.oss-cn-shanghai.aliyuncs.com/blog/alipay.png"/></a><div class="post-qr-code-desc">alipay</div></li></ul></div><div class="console-card-group"><div class="console-card-group-left"><div class="console-card" id="card-newest-comments"><div class="card-content"><div class="author-content-item-tips">互动</div><span class="author-content-item-title"> <span>最新评论</span></span></div><div class="aside-list"><span>正在加载中...</span></div></div></div><div class="console-card-group-right"><div class="console-card tags"><div class="card-content"><div class="author-content-item-tips">兴趣点</div><span class="author-content-item-title">寻找你感兴趣的领域</span><div class="card-tags"><div class="item-headline"></div><div class="card-tag-cloud"><a href="/tags/Appium/" style="font-size: 1.05rem;">Appium<sup>1</sup></a><a href="/tags/Axios/" style="font-size: 1.05rem;">Axios<sup>1</sup></a><a href="/tags/Centos/" style="font-size: 1.05rem;">Centos<sup>1</sup></a><a href="/tags/Docker/" style="font-size: 1.05rem;">Docker<sup>2</sup></a><a href="/tags/ES6/" style="font-size: 1.05rem;">ES6<sup>1</sup></a><a href="/tags/Fiddler/" style="font-size: 1.05rem;">Fiddler<sup>1</sup></a><a href="/tags/Gradle/" style="font-size: 1.05rem;">Gradle<sup>1</sup></a><a href="/tags/Hexo/" style="font-size: 1.05rem;">Hexo<sup>2</sup></a><a href="/tags/JDK17/" style="font-size: 1.05rem;">JDK17<sup>1</sup></a><a href="/tags/Java/" style="font-size: 1.05rem;">Java<sup>3</sup></a><a href="/tags/Kafka/" style="font-size: 1.05rem;">Kafka<sup>1</sup></a><a href="/tags/Linux/" style="font-size: 1.05rem;">Linux<sup>1</sup></a><a href="/tags/MQ/" style="font-size: 1.05rem;">MQ<sup>1</sup></a><a href="/tags/MongoDB/" style="font-size: 1.05rem;">MongoDB<sup>1</sup></a><a href="/tags/NPM/" style="font-size: 1.05rem;">NPM<sup>1</sup></a><a href="/tags/NeoVim/" style="font-size: 1.05rem;">NeoVim<sup>1</sup></a><a href="/tags/Nginx/" style="font-size: 1.05rem;">Nginx<sup>2</sup></a><a href="/tags/OSS/" style="font-size: 1.05rem;">OSS<sup>1</sup></a><a href="/tags/Obsidian/" style="font-size: 1.05rem;">Obsidian<sup>1</sup></a><a href="/tags/SpringBoot/" style="font-size: 1.05rem;">SpringBoot<sup>3</sup></a><a href="/tags/TS/" style="font-size: 1.05rem;">TS<sup>3</sup></a><a href="/tags/Tmux/" style="font-size: 1.05rem;">Tmux<sup>1</sup></a><a href="/tags/Vite/" style="font-size: 1.05rem;">Vite<sup>1</sup></a><a href="/tags/Vue3/" style="font-size: 1.05rem;">Vue3<sup>1</sup></a><a href="/tags/Webpack/" style="font-size: 1.05rem;">Webpack<sup>1</sup></a><a href="/tags/Yarn/" style="font-size: 1.05rem;">Yarn<sup>1</sup></a><a href="/tags/asdf/" style="font-size: 1.05rem;">asdf<sup>1</sup></a><a href="/tags/css/" style="font-size: 1.05rem;">css<sup>1</sup></a><a href="/tags/docker/" style="font-size: 1.05rem;">docker<sup>1</sup></a><a href="/tags/docker-compose/" style="font-size: 1.05rem;">docker-compose<sup>1</sup></a><a href="/tags/eslint/" style="font-size: 1.05rem;">eslint<sup>1</sup></a><a href="/tags/html/" style="font-size: 1.05rem;">html<sup>1</sup></a><a href="/tags/jenkins/" style="font-size: 1.05rem;">jenkins<sup>1</sup></a><a href="/tags/pinia/" style="font-size: 1.05rem;">pinia<sup>1</sup></a><a href="/tags/setting/" style="font-size: 1.05rem;">setting<sup>1</sup></a><a href="/tags/%E5%89%8D%E7%AB%AF%E5%9F%BA%E7%A1%80/" style="font-size: 1.05rem;">前端基础<sup>6</sup></a><a href="/tags/%E6%95%B0%E6%8D%AE%E5%BA%93/" style="font-size: 1.05rem;">数据库<sup>1</sup></a><a href="/tags/%E6%B6%88%E6%81%AF%E9%98%9F%E5%88%97/" style="font-size: 1.05rem;">消息队列<sup>1</sup></a><a href="/tags/%E7%8E%AF%E5%A2%83%E7%AE%A1%E7%90%86/" style="font-size: 1.05rem;">环境管理<sup>1</sup></a><a href="/tags/%E9%9D%9E%E5%85%B3%E7%B3%BB%E5%9E%8B/" style="font-size: 1.05rem;">非关系型<sup>1</sup></a></div></div><hr/></div></div><div class="console-card history"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-box-archiv"></i><span>文章</span></div><div class="card-archives"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-archive"></i><span>归档</span><a class="card-more-btn" href="/archives/" title="查看更多">
    <i class="anzhiyufont anzhiyu-icon-angle-right"></i></a></div><ul class="card-archive-list"><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2023/08/"><span class="card-archive-list-date">八月 2023</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">1</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2023/07/"><span class="card-archive-list-date">七月 2023</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">1</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2023/06/"><span class="card-archive-list-date">六月 2023</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">3</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2023/05/"><span class="card-archive-list-date">五月 2023</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">5</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2022/08/"><span class="card-archive-list-date">八月 2022</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">3</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2022/06/"><span class="card-archive-list-date">六月 2022</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">2</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2022/05/"><span class="card-archive-list-date">五月 2022</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">3</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2022/04/"><span class="card-archive-list-date">四月 2022</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">1</span><span>篇</span></div></a></li></ul></div><hr/></div></div></div><div class="button-group"><div class="console-btn-item"><a class="darkmode_switchbutton" onclick="anzhiyu.switchDarkMode()" title="显示模式切换" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-moon"></i></a></div><div class="console-btn-item" id="consoleHideAside" onclick="anzhiyu.hideAsideBtn()" title="边栏显示控制"><a class="asideSwitch"><i class="anzhiyufont anzhiyu-icon-arrows-left-right"></i></a></div><div class="console-btn-item on" id="consoleCommentBarrage" onclick="anzhiyu.switchCommentBarrage()" title="热评开关"><a class="commentBarrage"><i class="anzhiyufont anzhiyu-icon-message"></i></a></div><div class="console-btn-item" id="consoleMusic" onclick="anzhiyu.musicToggle()" title="音乐开关"><a class="music-switch"><i class="anzhiyufont anzhiyu-icon-music"></i></a></div></div><div class="console-mask" onclick="anzhiyu.hideConsole()" href="javascript:void(0);"></div></div><div class="nav-button" id="nav-totop"><a class="totopbtn" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i><span id="percent" onclick="anzhiyu.scrollToDest(0,500)">0</span></a></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);" title="切换"><i class="anzhiyufont anzhiyu-icon-bars"></i></a></div></div></div></nav><div id="post-info"><div id="post-firstinfo"><div class="meta-firstline"><a class="post-meta-original">原创</a><span class="post-meta-categories"><span class="post-meta-separator"></span><i class="anzhiyufont anzhiyu-icon-inbox post-meta-icon"></i><a class="post-meta-categories" href="/categories/Develop/">Develop</a></span><span class="article-meta tags"><a class="article-meta__tags" href="/tags/%E5%89%8D%E7%AB%AF%E5%9F%BA%E7%A1%80/" tabindex="-1"> <span> <i class="anzhiyufont anzhiyu-icon-hashtag"></i>前端基础</span></a><a class="article-meta__tags" href="/tags/Webpack/" tabindex="-1"> <span> <i class="anzhiyufont anzhiyu-icon-hashtag"></i>Webpack</span></a><a class="article-meta__tags" href="/tags/eslint/" tabindex="-1"> <span> <i class="anzhiyufont anzhiyu-icon-hashtag"></i>eslint</span></a></span></div></div><h1 class="post-title">webpack5</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="anzhiyufont anzhiyu-icon-calendar-days post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2022-02-22T10:00:00.000Z" title="发表于 2022-02-22 18:00:00">2022-02-22</time><span class="post-meta-separator"></span><i class="anzhiyufont anzhiyu-icon-history post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2023-09-15T04:42:30.131Z" title="更新于 2023-09-15 12:42:30">2023-09-15</time></span></div><div class="meta-secondline"><span class="post-meta-separator"></span><span class="post-meta-wordcount"><i class="anzhiyufont anzhiyu-icon-file-word post-meta-icon" title="文章字数"></i><span class="post-meta-label" title="文章字数">字数总计:</span><span class="word-count" title="文章字数">9.3k</span><span class="post-meta-separator"></span><i class="anzhiyufont anzhiyu-icon-clock post-meta-icon" title="阅读时长"></i><span class="post-meta-label" title="阅读时长">阅读时长:</span><span>40分钟</span></span><span class="post-meta-separator"></span><span class="post-meta-pv-cv" id="" data-flag-title="webpack5"><i class="anzhiyufont anzhiyu-icon-fw-eye post-meta-icon"></i><span class="post-meta-label" title="阅读量">阅读量:</span><span id="busuanzi_value_page_pv"><i class="anzhiyufont anzhiyu-icon-spinner anzhiyu-spin"></i></span></span><span class="post-meta-separator">       </span><span class="post-meta-position" title="作者IP属地为成都"><i class="anzhiyufont anzhiyu-icon-location-dot"></i>成都</span><span class="post-meta-separator"></span><span class="post-meta-commentcount"><i class="anzhiyufont anzhiyu-icon-comments post-meta-icon"></i><span class="post-meta-label">评论数:</span><a href="/worker/Developer/webpack5/#post-comment" itemprop="discussionUrl"><span class="valine-comment-count" data-xid="/worker/Developer/webpack5/" itemprop="commentCount"><i class="anzhiyufont anzhiyu-icon-spinner anzhiyu-spin"></i></span></a></span></div></div></div><section class="main-hero-waves-area waves-area"><svg class="waves-svg" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto"><defs><path id="gentle-wave" d="M -160 44 c 30 0 58 -18 88 -18 s 58 18 88 18 s 58 -18 88 -18 s 58 18 88 18 v 44 h -352 Z"></path></defs><g class="parallax"><use href="#gentle-wave" x="48" y="0"></use><use href="#gentle-wave" x="48" y="3"></use><use href="#gentle-wave" x="48" y="5"></use><use href="#gentle-wave" x="48" y="7"></use></g></svg></section><div id="post-top-cover"><img class="nolazyload" id="post-top-bg" src="https://automation-manage.oss-cn-shanghai.aliyuncs.com/blog/auto/webpack.jpg"></div></header><main class="layout" id="content-inner"><div id="post"><div class="post-ai-description"><div class="ai-title"><i class="anzhiyufont anzhiyu-icon-bilibili"></i><div class="ai-title-text">AI-摘要</div><i class="anzhiyufont anzhiyu-icon-arrow-rotate-right"></i><div id="ai-tag">Tianli GPT</div></div><div class="ai-explanation">AI初始化中...</div><div class="ai-btn-box"><div class="ai-btn-item">介绍自己</div><div class="ai-btn-item">生成本文简介</div><div class="ai-btn-item">推荐相关文章</div><div class="ai-btn-item">前往主页</div><div class="ai-btn-item" id="go-tianli-blog">前往tianli博客</div></div><script data-pjax>(function(){
  // 当前随机到的ai摘要到index
  let lastAiRandomIndex = -1;
  let animationRunning = true; // 标志变量，控制动画函数的运行
  // 当前gpt模式
  let mode = "tianli"
  // 刷新点击次数
  let refreshNum = 0
  // 记录上一次传递给aiAbstract的参数
  let prevParam;
  const aiTitleRefreshIcon = document.querySelector(".ai-title .anzhiyufont.anzhiyu-icon-arrow-rotate-right")
  const explanation = document.querySelector(".ai-explanation");
  const post_ai = document.querySelector(".post-ai-description");
  let ai_str = "";
  let ai_str_length = "";
  let delay_init = 600;
  let i = 0;
  let j = 0;
  let sto = [];
  let elapsed = 0;
  const animate = timestamp => {
    if (!animationRunning) {
      return; // 动画函数停止运行
    }
    if (!animate.start) animate.start = timestamp;
    elapsed = timestamp - animate.start;
    if (elapsed >= 20) {
      animate.start = timestamp;
      if (i < ai_str_length - 1) {
        let char = ai_str.charAt(i + 1);
        let delay = /[,.，。!?！？]/.test(char) ? 150 : 20;
        if (explanation.firstElementChild) {
          explanation.removeChild(explanation.firstElementChild);
        }
        explanation.innerHTML += char;
        let div = document.createElement("div");
        div.className = "ai-cursor";
        explanation.appendChild(div);
        i++;
        if (delay === 150) {
          document.querySelector(".ai-explanation .ai-cursor").style.opacity = "0";
        }
        if (i === ai_str_length - 1) {
          observer.disconnect(); // 暂停监听
          explanation.removeChild(explanation.firstElementChild);
        }
        sto[0] = setTimeout(() => {
          requestAnimationFrame(animate);
        }, delay);
      }
    } else {
      requestAnimationFrame(animate);
    }
  };
  const observer = new IntersectionObserver(
    entries => {
      let isVisible = entries[0].isIntersecting;
      animationRunning = isVisible; // 标志变量更新
      if (animationRunning) {
        delay_init = i === 0 ? 200 : 20;
        sto[1] = setTimeout(() => {
          if (j) {
            i = 0;
            j = 0;
          }
          if (i === 0) {
            explanation.innerHTML = ai_str.charAt(0);
          }
          requestAnimationFrame(animate);
        }, delay_init);
      }
    },
    { threshold: 0 }
  );
  function clearSTO() {
    if (sto.length) {
      sto.forEach(item => {
        if (item) {
          clearTimeout(item);
        }
      });
    }
  }
  function startAI(str, df = true) {
    i = 0; //重置计数器
    j = 1;
    clearSTO();
    animationRunning = false;
    elapsed = 0;
    observer.disconnect(); // 暂停上一次监听
    explanation.innerHTML = df ? "生成中. . ." : "请等待. . .";
    ai_str = str;
    ai_str_length = ai_str.length;
    observer.observe(post_ai); //启动新监听
  }

  async function aiAbstract(num = 1000) {
    i = 0; //重置计数器
    j = 1;
    clearSTO();
    animationRunning = false;
    elapsed = 0;
    observer.disconnect(); // 暂停上一次监听
    if (mode === "tianli") {
      num = Math.max(10, Math.min(2000, num));
      const options = {
        key: "4e3ea06311f19e3442c0",
        Referer: "https://adalucky.github.io/"
      };
      const truncateDescription = ("webpack5" + "简介, 参考资料, 简介安装配置, 简介, webpack原理和概念, webpack环境安装, webpack基础配置, html资源打包配置, 插件安装, 配置webpack.config.js文件, 分开打包 html 文件, css资源打包, 内联打包, css资源打包到html, webpack.config.js配置, Lessx2FSass资源打包, 插件安装, webpack.config.js配置, lessx2Fsass 语法, 单独打包样式文件, 下载插件, webpack.config.js配置, css兼容性处理, 插件安装, 配置文件, 新建 postcss 配置文件, package.json文件配置信息, webpack.config.js配置, 压缩 css, 下载插件, webpack.config.js 配置, 图片资源打包, css中引入图片, 实现方式, webpack.config.js 配置, html中引入图片, 实现方式, webpack.config.js 配置, 打包其它资源, 字体icon资源打包, 流程, 下载及 copy 字体文件, 入口 js 中引入 iconfont, webpack.config.js 配置, eslint, 简介, 安装插件包, 配置文件, 特殊配置, 热部署, 简介, 流程, 示例, 下载包, webpack.config.js 配置, package.json, 环境优化, 开发环境HMR(模块热替换), 样式文件, html, js, 线上环境(去除死代码), js, css, 下载插件, webpack.config.js 配置简介是代码编译工具有入口出口和插件是一个用于现代应用程序的静态模块打包工具当处理应用程序时它会在内部构建一个依赖图此依赖图对应映射到项目所需的每个模块并生成一个或多个参考资料简介安装配置简介是一个模块打包器构建工具它的主要目标是将文件打包在一起打包后的文件用于在浏览器中使用但它也能够胜任转换打包或包裹任何资源官网中文文档原理和概念树结构在一个入口文件中引入所有资源形成所有依赖关系树状图模块模块就是模块可以是模块也可以是或者模块对于来说所有的资源打包过程中被操作的模块文件叫做例如异步加载一个模块就是一个是最后打包后的文件最终文件可以和长的一模一样但是大部分情况下他是多个的集合为了优化最后生产出的数量可能不等于的数量因为有可能多个被组合到了一个中工作原理为打包过程为打包结果资源代码环境安装安装至开发环境注意看看版本打包指定模式开发模式文件较大包含注释等信息生产模式无注释无空格全部在一行最终会在生成文件夹下有个生成模式打包后的文件更小里面也没有多余的说明和注释等信息默认是打包下的文件如果没有该文件夹会报错基础配置项目根目录下新建文件就用这个名字换其它的名字需要在执行命令的时候重新指定一遍默认会读取这个名字的文件不需要指定该文件为执行命令默认读取的配置文件默认打包资源中的包可获取当前项目的根路径的核心有五个入口输出插件指示应该使用哪个模块来作为构建其内部依赖图的开始进入入口起点后会找出有哪些模块和库是入口起点直接和间接依赖的默认值是入口配置选一单入口如果只有一个入口文件使用字符串指定入口文件打包一个名称是默认的中的的值输出一个多入口数组可多个入口文件所有的入口文件生成一个名称是默认的中的的值输出一个多入口对象通过配置多个入口有几个入口文件就有几个并输出几个的名称是中的的值要写成混合模式数组的多个打成个其它的单独生成一个的值还是写成告诉在哪里输出它所创建的以及如何命名这些文件主要输出文件的默认值是其他生成文件默认放置在文件夹如果是时的值要写成只能理解和文件让能够去处理其他类型的文件并将它们转换为有效模块以供应用程序使用以及被添加到依赖图中用于转换某些类型的模块而插件则可以用于执行范围更广的任务包括打包优化资源管理注入环境变量模式指示使用相应的配置开发模式配置比较简单能让代码本地调试运行的环境生产模式代码需要不断优化达到性能最好能让代码优化上线运行的环境都会自动启用一些插件生产模式使用插件更多资源打包配置由于默认只能打包资源我们想要打包资源需要在开发环境安装插件插件安装插件大步骤下载引入使用方式一安装插件方式二安装插件配置文件打包文件的核心有五个入口输出插件用于转换某些类型的模块而插件则可以用于执行范围更广的任务包括打包优化资源管理注入环境变量默认会创建一个空的会自动引入文件源文件不指定就会自动生成一个空的文件目标文件名不指定就会使用的文件作为文件名如果也没有指定就会使用系统默认的压缩移除空格结构中的空格文字间的还是保留的移除注释分开打包文件不同的文件需要引入不同的文件因此需要对不同的文件分别或组合打包成一个在不同的页面中引用模拟真实打包将和依赖打包在一起剩下的两个单独打包在一起用于转换某些类型的模块而插件则可以用于执行范围更广的任务包括打包优化资源管理注入环境变量源文件不指定就会自动生成一个空的文件目标文件名不指定就会使用的文件作为文件名如果也没有指定就会使用系统默认的中的值为中的键多个之间有依赖关系从右往左写数组中最后一个最先引入压缩移除空格结构中的空格文字间的还是保留的移除注释移除空格结构中的空格文字间的还是保留的移除注释资源打包内联打包实现原理先用把样式打包到的一个然后用创建了一个标签引入样式属于内联式打包开发环境安装插件把资源打包捆绑到文件中作用是处理中的和这样的外部资源把加载引入到中作用是把样式插入到中方法是在中插入一个标签并把样式写入到这个标签的里方式一安装插件方式二安装插件资源打包到配置标签打包的导入文件打包的时候会通过把打到中这是入口文件配置打包两个斜杠表示正则中间的表示所有的结尾的文件是用来转移的注意顺序一定是在的左边因为加载规则的时候是从右边到左通过把正则中的这里也就是所有的文件打包到中打包后再通过把这些插入到中移除空格结构中的空格文字间的还是保留的移除注释资源打包因为只是单纯的属性描述它并不具有变量条件语句等的特性导致了它难组织和维护和都属于预处理器定义了一种新的语言其基本思想是用一种专门的编程语言为增加一些编程的特性将作为目标生成文件然后开发者使用这种语言进行编码工作需要使用下载包和需要使用下载包和需要在打包的文件中引如插件安装的插件开发环境的插件开发环境配置两个斜杠表示正则中间的表示所有的结尾的文件是用来转移的注意顺序一定是在的左边因为加载规则的时候是从右边到左通过把正则中的这里也就是所有的文件打包到中打包后再通过把这些插入到中先通过转成然后通过打包到入口文件中插入到中顺序从后往前原理一致只是文件后缀名称是所以正则的时候别写错了语法语法全局变量用符号定义和引用局部变量语法样式是以结尾的文件定义变量用全局变量用符号定义和引用局部变量单独打包样式文件把等资源打包成一个独立的资源文件下载插件插件大步骤下载引入使用下载下载配置将资源单独打包成独立的文件不嵌入在中将换成移除空格结构中的空格文字间的还是保留的移除注释指定单独打包的文件的路径和文件名标签的下的兼容性处理通过插件确保所有的样式中的属性在所有类型的浏览器大多数浏览器的大多数版本都支持且显示效果一致需要使用处理下载两个包和会找到中的里面的配置通过配置加载的兼容性修改的配置新版需要写和兼容性同理插件安装安装安装至开发环境安装配置文件需要新建文件中新增标签中使用新建配置文件项目根路径新建文件该文件为的默认配置文件配置文件该配置文件引入插件该插件会读取文件下的文件配置信息支持以上的浏览器支持最后两个版本忽略已经死掉的浏览器配置执行打包时如果文件中有注释会出现如下截图报错删除注释即可解决兼容问题后新增会去找到对应的配置文件下的属性移除空格结构中的空格文字间的还是保留的移除注释指定单独打包的文件的路径和文件名标签的下的压缩下载插件引入插件使用插件下载插件引入插件开发环境引入插件开发环境配置引入创建对象压缩用于压缩的开发环境下可以先不要压缩不然格式不太好看图片资源打包中引入图片实现方式需要用这两个插件需要下载直接使用因为在中已经被废弃该模块不需要下载配置打包图片资源中引入打包图片的规则配置只有一个可以直接写不用写在里面解析超过不转文件生成路径及规则超出的会在标签下的下也就是自己定义的下生成文件名值图片后缀用于压缩的开发环境下可以先不要压缩不然格式不太好看中引入图片实现方式使用插件实现安装开发环境安装开发环境配置打包图片资源中引入打包图片的规则配置只有一个可以直接写不用写在里面解析超过不转文件生成路径及规则超出的会在标签下的下也就是自己定义的下生成文件名值图片后缀中引入的图片打包用于压缩的开发环境下可以先不要压缩不然格式不太好看打包其它资源不需要优化和压缩处理直接输出的资源称为其他资源如字体字体资源打包流程图标库下载对应的资源后将文件至项目下入口中引入直接使用模块无需下载配置规则下载及字体文件入口中引入在入口文件中引入文件配置打包字体资源中引入的图片打包打包字体资源简介是一个开源的代码检查工具初衷是为了让程序员可以创建自己的检测规则实际生产中团队内往往会制订一套统一的标准让整个团队的编码风格达到一致其实与没有任何关系两者并不互相依赖甚至一般情况下我们并不会在中进行的配置可以单独使用语法检查使用并基于包只用来检查语法注意只检查自己写的源代码第三方库是不用检查的可以在中查看规则需要使用来的规则库来检查代码需要和两个包进行检查需要依赖同时告诉它用什么标准去检查常用的就是又依赖和两个包安装插件包有很多视频在使用我在使用时会有如下报错网上说已经弃用了采用插件安装开发环境安装开发环境如果在安装的插件的时候有提示需要更换版本我是在官网下载最近的一个稳定版本重新安装的就可以了配置文件引入插件使用插件自动修复不合理写法规则会根据中的下对应的属性去检查语法规范检查中引入的图片打包打包字体资源语法检查自动修复不合理的写法在控制台可通过执行或者会去检查目录下的规范定义的检查规范为支持以上的浏览器支持最后两个版本忽略已经死掉的浏览器特殊配置有的时候想针对某行代码跳过检查只需要在该行代码上添加即可跳过对下一行的检查只针对下一行有效热部署简介在前面的章节中我们每次写完程序或者修改了内容后都需要通过进行打包到目录这种情况一般是用在生产环境开发完了打包测试上线在实际的工作中我们更加希望我们每次修改完代码后就能够自动刷新对应的等内容便于我们实时的查看调试这也就本次记录的内容热部署给我们提供了开发过程中的服务器是一个使用了的服务器它的作用主要是为了监听资源文件的改变该服务器和使用了通信协议只要资源文件发生改变就会实时的进行编译只会在内存中编译不会有任何输出下载包并不能读取你的的配置也就是说每次修改了配置文件需要手动重启一下修改其它的会自动刷新启动指令为本目录执行无法自动刷新解决添加配置流程下载包下新增属性用于指定端口等信息中指定启动命令示例下载包安装开发环境安装开发环境配置每次配置文件发生了变化需要重启服务器因为配置文件是在启动时生效发生改变不能修改启动时的参数设置这些注释了检查开发环境不方便去除了更改为在启动命令中指定新增需要指定为不然会报错应该是热部署启动后默认去读取文件如果自动刷新无效的话注意一般是开启了中看属性下有没有配置需要监听的这里的就是需要自动刷新的页面热部署需要指定为不然会报错中引入的图片打包打包字体资源语法检查自动修复不合理的写法在需要加上这个配置项才可以自动刷新如果自动刷新无效的话注意一般是开启了中看属性下有没有配置需要监听的设定的根目录如果不进行设定的话默认是在当前目录下控制台中不输出打包的信息开发中一般设置为进行打印这样查看错误比较方面不显示任何信息对信息进行颜色输出对信息不进行颜色输出开启压缩设置设置端口号默认是会在你的的入口配置文件中再添加一个入口开发热替换启动命令自动打开浏览器查看历史下新增通过命令指定开发模式启动或者打包并且携带参数指定这样就不需要在中指定命令行中的比配置文件中参数的优先级高支持以上的浏览器支持最后两个版本忽略已经死掉的浏览器环境优化开发环境的优化打包构建速度比如我们只更新了一个文件重新编译的时候只编译这一个文件热加载优化代码调式生产环境的优化代码运行的性能例如尽量减小代码文件的大小只打包引用到了的开发环境模块热替换热模块替换一般是针对开发环境的优化模块热替换即是提供的最有用的功能之一它允许在运行时更新各种模块而无需进行完全刷新启用这个功能只需要修改一下的配置使用内置的插件就可以了在中使用参数启用内置的插件后接口就会暴露在中接下来需要在中配置告诉接受的模块样式文件样式文件在使用功能的时候开发环境中使用之前使用的把所有打包成一个单独的文件这样就没有意义了因为更新了这个所有打包一起的文件比较大开发环境使用就不会打包成单独的文件这样就能做到只更新这一个样式文件这里我没去实践一般是会根据配置什么的去设置比如开发环境用线上用打包成一个文件的功能默认也没有功能不用做功能需要在入口中引入文件的功能默认没有功能只能处理非入口文件的文件启用内置的插件后接口就会暴露在中接下来需要在中配置告诉接受的模块通过代码如上图所示当一个文件发生变化时所有的都会去执行如果想要去实现只更新我们自己修改了的文件需要在入口文件中通过代码指定文件示例如下告诉接受热替换的模块为服务器检测到了的代码变化后需要执行的的回调函数这个文件有发生变化修改中将改为后并未执行中的打印语句打包样式的文件这句话只执行了的回调函数修改后并未再次打印这句话也就证明热加载只加载了中只监听了服务器检测到了的代码变化后需要执行的的回调函数线上环境去除死代码该内容是针对线上环境且指的是这类文件文件不需要因为如果不需要的我们会注释掉然后打包的时候会去压缩注释掉的内容但是这些可能会留着暂时不注释可能以后会用那么我们就期望打包的时候没有引用的这些东西不打包进去比如去网上了一个一万行的但是我们只用了其中的一部分但是又不敢乱删除以前的方法就会把所有的一万行打包进去优化了的话它自动就会去找到这一万行代码中我们使用到的打包进去或者说引入的第三方的我们也期望只把我们项目使用到的打包进去多余的就不要通过去掉了实际上并没有使用的代码来减少包的大小是自带的功能不需要下载其它的包树摇摇晃树子把黄了的叶子摇下来不要前提条件必须使用模块化开启环境中指定下载插件安装开发环境安装开发环境配置下新增以下内容四个引入一个").trim().substring(0, num)

      const queryParams = `key=${options.key}&content=${truncateDescription}`;
      const requestOptions = {
        method: "GET",
        headers: {
          "Content-Type": "application/json",
          Referer: options.Referer
        },
      };
      try {
        let animationInterval = null
        if (animationInterval) clearInterval(animationInterval);
        animationInterval = setInterval(() => {
          const animationText = "生成中" + ".".repeat(j);
          explanation.innerHTML = animationText;
          j = (j % 3) + 1; // 在 1、2、3 之间循环
        }, 500);
        const response = await fetch(`https://summary.tianli0.top/?${queryParams}`, requestOptions);
        let result;
        if (response.status === 403) {
          result = {
            summary: "403 refer与key不匹配，本地无法显示。"
          }
        } else if (response.status === 500) {
          result = {
            summary: "500 系统内部错误"
          }
        } else {
          result = await response.json();
        }
        const summary = result.summary.trim();
        setTimeout(() => {
          aiTitleRefreshIcon.style.opacity = "1";
        }, 300)
        startAI(summary);
        clearInterval(animationInterval)
      } catch (error) {
        console.error(error);
        explanation.innerHTML = "发生异常" + error;
      }
    } else {
      const strArr = "true".split(",").map(item => item.trim()); // 将字符串转换为数组，去除每个字符串前后的空格
      if (strArr.length !== 1) {
        let randomIndex = Math.floor(Math.random() * strArr.length); // 随机生成一个索引
        while (randomIndex === lastAiRandomIndex) { // 如果随机到了上次的索引
          randomIndex = Math.floor(Math.random() * strArr.length); // 再次随机
        }
        lastAiRandomIndex = randomIndex; // 更新上次随机到的索引
        startAI(strArr[randomIndex]);
      } else {
        startAI(strArr[0])
      }
      setTimeout(() => {
        aiTitleRefreshIcon.style.opacity = "1";
      }, 600)
    }
  }

  function aiRecommend() {
    i = 0; //重置计数器
    j = 1;
    clearSTO();
    animationRunning = false;
    elapsed = 0;
    explanation.innerHTML = "生成中. . .";
    ai_str = "";
    ai_str_length = "";
    observer.disconnect(); // 暂停上一次监听
    sto[2] = setTimeout(() => {
      explanation.innerHTML = recommendList();
    }, 600);
  }
  function aiGoHome() {
    startAI("正在前往博客主页...", false);
    sto[2] = setTimeout(() => {
      pjax.loadUrl("/");
    }, 1000);
  }
  const ai_btn_item = document.querySelectorAll(".ai-btn-item");
  function Introduce() {
    if (mode == "tianli") {
      startAI("我是文章辅助AI: TianliGPT，点击下方的按钮，让我生成本文简介、推荐相关文章等。")
    } else {
      startAI("我是文章辅助AI: AnZhiYu GPT，点击下方的按钮，让我生成本文简介、推荐相关文章等。")
    }
  }
  function aiTitleRefreshIconClick() {
    aiTitleRefreshIcon.click()
  }
  const aiFunctions = [Introduce, aiTitleRefreshIconClick, aiRecommend, aiGoHome];
  ai_btn_item.forEach((item, index) => {
    item.addEventListener("click", () => {
      aiFunctions[index]();
    });
  });

  function recommendList() {
    let thumbnail = document.querySelectorAll('.relatedPosts-list a');
    if (!thumbnail.length) {
      const cardRecentPost = document.querySelector('.card-widget.card-recent-post'); 
      if (!cardRecentPost) return '';

      thumbnail = cardRecentPost.querySelectorAll('.aside-list-item a');

      let list = '';
      for (let i = 0; i < thumbnail.length; i++) {
        const item = thumbnail[i];
        list += `<div class="ai-recommend-item"><span class="index">${i + 1}：</span><a href="javascript:;" onclick="pjax.loadUrl('${item.href}')" title="${item.title}" data-pjax-state="">${item.title}</a></div>`;
      }
      
      return `很抱歉，无法找到类似的文章，你也可以看看本站最新发布的文章：<br /><div class="ai-recommend">${list}</div>`;
    }

    let list = '';
    for (let i = 0; i < thumbnail.length; i++) {
      const item = thumbnail[i];
      list += `<div class="ai-recommend-item"><span>推荐${i + 1}：</span><a href="javascript:;" onclick="pjax.loadUrl('${item.href}')" title="${item.title}" data-pjax-state="">${item.title}</a></div>`;
    }

    return `推荐文章：<br /><div class="ai-recommend">${list}</div>`;
  }


  function changeShowMode() {
    if (mode === "tianli") {
      mode = "local";
      document.getElementById("ai-tag").innerHTML = "AnZhiYu GPT";
      aiAbstract(1000);
    } else {
      mode = "tianli";
      document.getElementById("ai-tag").innerHTML = "Tianli GPT";

      const truncateDescription = ("" + "简介, 参考资料, 简介安装配置, 简介, webpack原理和概念, webpack环境安装, webpack基础配置, html资源打包配置, 插件安装, 配置webpack.config.js文件, 分开打包 html 文件, css资源打包, 内联打包, css资源打包到html, webpack.config.js配置, Lessx2FSass资源打包, 插件安装, webpack.config.js配置, lessx2Fsass 语法, 单独打包样式文件, 下载插件, webpack.config.js配置, css兼容性处理, 插件安装, 配置文件, 新建 postcss 配置文件, package.json文件配置信息, webpack.config.js配置, 压缩 css, 下载插件, webpack.config.js 配置, 图片资源打包, css中引入图片, 实现方式, webpack.config.js 配置, html中引入图片, 实现方式, webpack.config.js 配置, 打包其它资源, 字体icon资源打包, 流程, 下载及 copy 字体文件, 入口 js 中引入 iconfont, webpack.config.js 配置, eslint, 简介, 安装插件包, 配置文件, 特殊配置, 热部署, 简介, 流程, 示例, 下载包, webpack.config.js 配置, package.json, 环境优化, 开发环境HMR(模块热替换), 样式文件, html, js, 线上环境(去除死代码), js, css, 下载插件, webpack.config.js 配置简介是代码编译工具有入口出口和插件是一个用于现代应用程序的静态模块打包工具当处理应用程序时它会在内部构建一个依赖图此依赖图对应映射到项目所需的每个模块并生成一个或多个参考资料简介安装配置简介是一个模块打包器构建工具它的主要目标是将文件打包在一起打包后的文件用于在浏览器中使用但它也能够胜任转换打包或包裹任何资源官网中文文档原理和概念树结构在一个入口文件中引入所有资源形成所有依赖关系树状图模块模块就是模块可以是模块也可以是或者模块对于来说所有的资源打包过程中被操作的模块文件叫做例如异步加载一个模块就是一个是最后打包后的文件最终文件可以和长的一模一样但是大部分情况下他是多个的集合为了优化最后生产出的数量可能不等于的数量因为有可能多个被组合到了一个中工作原理为打包过程为打包结果资源代码环境安装安装至开发环境注意看看版本打包指定模式开发模式文件较大包含注释等信息生产模式无注释无空格全部在一行最终会在生成文件夹下有个生成模式打包后的文件更小里面也没有多余的说明和注释等信息默认是打包下的文件如果没有该文件夹会报错基础配置项目根目录下新建文件就用这个名字换其它的名字需要在执行命令的时候重新指定一遍默认会读取这个名字的文件不需要指定该文件为执行命令默认读取的配置文件默认打包资源中的包可获取当前项目的根路径的核心有五个入口输出插件指示应该使用哪个模块来作为构建其内部依赖图的开始进入入口起点后会找出有哪些模块和库是入口起点直接和间接依赖的默认值是入口配置选一单入口如果只有一个入口文件使用字符串指定入口文件打包一个名称是默认的中的的值输出一个多入口数组可多个入口文件所有的入口文件生成一个名称是默认的中的的值输出一个多入口对象通过配置多个入口有几个入口文件就有几个并输出几个的名称是中的的值要写成混合模式数组的多个打成个其它的单独生成一个的值还是写成告诉在哪里输出它所创建的以及如何命名这些文件主要输出文件的默认值是其他生成文件默认放置在文件夹如果是时的值要写成只能理解和文件让能够去处理其他类型的文件并将它们转换为有效模块以供应用程序使用以及被添加到依赖图中用于转换某些类型的模块而插件则可以用于执行范围更广的任务包括打包优化资源管理注入环境变量模式指示使用相应的配置开发模式配置比较简单能让代码本地调试运行的环境生产模式代码需要不断优化达到性能最好能让代码优化上线运行的环境都会自动启用一些插件生产模式使用插件更多资源打包配置由于默认只能打包资源我们想要打包资源需要在开发环境安装插件插件安装插件大步骤下载引入使用方式一安装插件方式二安装插件配置文件打包文件的核心有五个入口输出插件用于转换某些类型的模块而插件则可以用于执行范围更广的任务包括打包优化资源管理注入环境变量默认会创建一个空的会自动引入文件源文件不指定就会自动生成一个空的文件目标文件名不指定就会使用的文件作为文件名如果也没有指定就会使用系统默认的压缩移除空格结构中的空格文字间的还是保留的移除注释分开打包文件不同的文件需要引入不同的文件因此需要对不同的文件分别或组合打包成一个在不同的页面中引用模拟真实打包将和依赖打包在一起剩下的两个单独打包在一起用于转换某些类型的模块而插件则可以用于执行范围更广的任务包括打包优化资源管理注入环境变量源文件不指定就会自动生成一个空的文件目标文件名不指定就会使用的文件作为文件名如果也没有指定就会使用系统默认的中的值为中的键多个之间有依赖关系从右往左写数组中最后一个最先引入压缩移除空格结构中的空格文字间的还是保留的移除注释移除空格结构中的空格文字间的还是保留的移除注释资源打包内联打包实现原理先用把样式打包到的一个然后用创建了一个标签引入样式属于内联式打包开发环境安装插件把资源打包捆绑到文件中作用是处理中的和这样的外部资源把加载引入到中作用是把样式插入到中方法是在中插入一个标签并把样式写入到这个标签的里方式一安装插件方式二安装插件资源打包到配置标签打包的导入文件打包的时候会通过把打到中这是入口文件配置打包两个斜杠表示正则中间的表示所有的结尾的文件是用来转移的注意顺序一定是在的左边因为加载规则的时候是从右边到左通过把正则中的这里也就是所有的文件打包到中打包后再通过把这些插入到中移除空格结构中的空格文字间的还是保留的移除注释资源打包因为只是单纯的属性描述它并不具有变量条件语句等的特性导致了它难组织和维护和都属于预处理器定义了一种新的语言其基本思想是用一种专门的编程语言为增加一些编程的特性将作为目标生成文件然后开发者使用这种语言进行编码工作需要使用下载包和需要使用下载包和需要在打包的文件中引如插件安装的插件开发环境的插件开发环境配置两个斜杠表示正则中间的表示所有的结尾的文件是用来转移的注意顺序一定是在的左边因为加载规则的时候是从右边到左通过把正则中的这里也就是所有的文件打包到中打包后再通过把这些插入到中先通过转成然后通过打包到入口文件中插入到中顺序从后往前原理一致只是文件后缀名称是所以正则的时候别写错了语法语法全局变量用符号定义和引用局部变量语法样式是以结尾的文件定义变量用全局变量用符号定义和引用局部变量单独打包样式文件把等资源打包成一个独立的资源文件下载插件插件大步骤下载引入使用下载下载配置将资源单独打包成独立的文件不嵌入在中将换成移除空格结构中的空格文字间的还是保留的移除注释指定单独打包的文件的路径和文件名标签的下的兼容性处理通过插件确保所有的样式中的属性在所有类型的浏览器大多数浏览器的大多数版本都支持且显示效果一致需要使用处理下载两个包和会找到中的里面的配置通过配置加载的兼容性修改的配置新版需要写和兼容性同理插件安装安装安装至开发环境安装配置文件需要新建文件中新增标签中使用新建配置文件项目根路径新建文件该文件为的默认配置文件配置文件该配置文件引入插件该插件会读取文件下的文件配置信息支持以上的浏览器支持最后两个版本忽略已经死掉的浏览器配置执行打包时如果文件中有注释会出现如下截图报错删除注释即可解决兼容问题后新增会去找到对应的配置文件下的属性移除空格结构中的空格文字间的还是保留的移除注释指定单独打包的文件的路径和文件名标签的下的压缩下载插件引入插件使用插件下载插件引入插件开发环境引入插件开发环境配置引入创建对象压缩用于压缩的开发环境下可以先不要压缩不然格式不太好看图片资源打包中引入图片实现方式需要用这两个插件需要下载直接使用因为在中已经被废弃该模块不需要下载配置打包图片资源中引入打包图片的规则配置只有一个可以直接写不用写在里面解析超过不转文件生成路径及规则超出的会在标签下的下也就是自己定义的下生成文件名值图片后缀用于压缩的开发环境下可以先不要压缩不然格式不太好看中引入图片实现方式使用插件实现安装开发环境安装开发环境配置打包图片资源中引入打包图片的规则配置只有一个可以直接写不用写在里面解析超过不转文件生成路径及规则超出的会在标签下的下也就是自己定义的下生成文件名值图片后缀中引入的图片打包用于压缩的开发环境下可以先不要压缩不然格式不太好看打包其它资源不需要优化和压缩处理直接输出的资源称为其他资源如字体字体资源打包流程图标库下载对应的资源后将文件至项目下入口中引入直接使用模块无需下载配置规则下载及字体文件入口中引入在入口文件中引入文件配置打包字体资源中引入的图片打包打包字体资源简介是一个开源的代码检查工具初衷是为了让程序员可以创建自己的检测规则实际生产中团队内往往会制订一套统一的标准让整个团队的编码风格达到一致其实与没有任何关系两者并不互相依赖甚至一般情况下我们并不会在中进行的配置可以单独使用语法检查使用并基于包只用来检查语法注意只检查自己写的源代码第三方库是不用检查的可以在中查看规则需要使用来的规则库来检查代码需要和两个包进行检查需要依赖同时告诉它用什么标准去检查常用的就是又依赖和两个包安装插件包有很多视频在使用我在使用时会有如下报错网上说已经弃用了采用插件安装开发环境安装开发环境如果在安装的插件的时候有提示需要更换版本我是在官网下载最近的一个稳定版本重新安装的就可以了配置文件引入插件使用插件自动修复不合理写法规则会根据中的下对应的属性去检查语法规范检查中引入的图片打包打包字体资源语法检查自动修复不合理的写法在控制台可通过执行或者会去检查目录下的规范定义的检查规范为支持以上的浏览器支持最后两个版本忽略已经死掉的浏览器特殊配置有的时候想针对某行代码跳过检查只需要在该行代码上添加即可跳过对下一行的检查只针对下一行有效热部署简介在前面的章节中我们每次写完程序或者修改了内容后都需要通过进行打包到目录这种情况一般是用在生产环境开发完了打包测试上线在实际的工作中我们更加希望我们每次修改完代码后就能够自动刷新对应的等内容便于我们实时的查看调试这也就本次记录的内容热部署给我们提供了开发过程中的服务器是一个使用了的服务器它的作用主要是为了监听资源文件的改变该服务器和使用了通信协议只要资源文件发生改变就会实时的进行编译只会在内存中编译不会有任何输出下载包并不能读取你的的配置也就是说每次修改了配置文件需要手动重启一下修改其它的会自动刷新启动指令为本目录执行无法自动刷新解决添加配置流程下载包下新增属性用于指定端口等信息中指定启动命令示例下载包安装开发环境安装开发环境配置每次配置文件发生了变化需要重启服务器因为配置文件是在启动时生效发生改变不能修改启动时的参数设置这些注释了检查开发环境不方便去除了更改为在启动命令中指定新增需要指定为不然会报错应该是热部署启动后默认去读取文件如果自动刷新无效的话注意一般是开启了中看属性下有没有配置需要监听的这里的就是需要自动刷新的页面热部署需要指定为不然会报错中引入的图片打包打包字体资源语法检查自动修复不合理的写法在需要加上这个配置项才可以自动刷新如果自动刷新无效的话注意一般是开启了中看属性下有没有配置需要监听的设定的根目录如果不进行设定的话默认是在当前目录下控制台中不输出打包的信息开发中一般设置为进行打印这样查看错误比较方面不显示任何信息对信息进行颜色输出对信息不进行颜色输出开启压缩设置设置端口号默认是会在你的的入口配置文件中再添加一个入口开发热替换启动命令自动打开浏览器查看历史下新增通过命令指定开发模式启动或者打包并且携带参数指定这样就不需要在中指定命令行中的比配置文件中参数的优先级高支持以上的浏览器支持最后两个版本忽略已经死掉的浏览器环境优化开发环境的优化打包构建速度比如我们只更新了一个文件重新编译的时候只编译这一个文件热加载优化代码调式生产环境的优化代码运行的性能例如尽量减小代码文件的大小只打包引用到了的开发环境模块热替换热模块替换一般是针对开发环境的优化模块热替换即是提供的最有用的功能之一它允许在运行时更新各种模块而无需进行完全刷新启用这个功能只需要修改一下的配置使用内置的插件就可以了在中使用参数启用内置的插件后接口就会暴露在中接下来需要在中配置告诉接受的模块样式文件样式文件在使用功能的时候开发环境中使用之前使用的把所有打包成一个单独的文件这样就没有意义了因为更新了这个所有打包一起的文件比较大开发环境使用就不会打包成单独的文件这样就能做到只更新这一个样式文件这里我没去实践一般是会根据配置什么的去设置比如开发环境用线上用打包成一个文件的功能默认也没有功能不用做功能需要在入口中引入文件的功能默认没有功能只能处理非入口文件的文件启用内置的插件后接口就会暴露在中接下来需要在中配置告诉接受的模块通过代码如上图所示当一个文件发生变化时所有的都会去执行如果想要去实现只更新我们自己修改了的文件需要在入口文件中通过代码指定文件示例如下告诉接受热替换的模块为服务器检测到了的代码变化后需要执行的的回调函数这个文件有发生变化修改中将改为后并未执行中的打印语句打包样式的文件这句话只执行了的回调函数修改后并未再次打印这句话也就证明热加载只加载了中只监听了服务器检测到了的代码变化后需要执行的的回调函数线上环境去除死代码该内容是针对线上环境且指的是这类文件文件不需要因为如果不需要的我们会注释掉然后打包的时候会去压缩注释掉的内容但是这些可能会留着暂时不注释可能以后会用那么我们就期望打包的时候没有引用的这些东西不打包进去比如去网上了一个一万行的但是我们只用了其中的一部分但是又不敢乱删除以前的方法就会把所有的一万行打包进去优化了的话它自动就会去找到这一万行代码中我们使用到的打包进去或者说引入的第三方的我们也期望只把我们项目使用到的打包进去多余的就不要通过去掉了实际上并没有使用的代码来减少包的大小是自带的功能不需要下载其它的包树摇摇晃树子把黄了的叶子摇下来不要前提条件必须使用模块化开启环境中指定下载插件安装开发环境安装开发环境配置下新增以下内容四个引入一个").trim().substring(0, 1000);
      let value = Math.floor(Math.random() * 3) + 1000;
      while (value === prevParam || truncateDescription.length - value === prevParam) {
        value = Math.floor(Math.random() * 3) + 1000;
      }
      aiTitleRefreshIcon.style.opacity = "0.2";
      aiTitleRefreshIcon.style.transitionDuration = "0.3s";
      aiTitleRefreshIcon.style.transform = "rotate(" + 360 * refreshNum + "deg)";
      if (truncateDescription.length <= 1000) {
        let param = truncateDescription.length - Math.floor(Math.random() * 3);
        while (param === prevParam) {
          param = truncateDescription.length - Math.floor(Math.random() * 3);
        }
        aiAbstract(param);
        prevParam = param;
      } else {
        aiAbstract(value);
        prevParam = value;
      }
      refreshNum++;
    }
  }

  //- 监听tag点击事件
  document.getElementById("ai-tag").addEventListener("click", () => {
    if (mode === "tianli") {
      document.querySelectorAll(".ai-btn-item").forEach(item => item.style.display = "none");
      document.getElementById("go-tianli-blog").style.display = "block";
      startAI("你好，我是Tianli开发的摘要生成助理TianliGPT，是一个基于GPT-4的生成式AI。我在这里只负责摘要的预生成和显示，你无法与我直接沟通，如果你也需要一个这样的AI摘要接口，可以在下方购买。（暂未开放购买，敬请期待）")
    } else {
      document.getElementById("go-tianli-blog").style.display = "none";
      startAI("你好，我是本站摘要生成助理AnZhiYu GPT，是一个基于GPT-4的生成式AI。我在这里只负责摘要的预生成和显示，你无法与我直接沟通。")
    }

  });

  aiTitleRefreshIcon.addEventListener("click", () => {
    const truncateDescription = ("" + "简介, 参考资料, 简介安装配置, 简介, webpack原理和概念, webpack环境安装, webpack基础配置, html资源打包配置, 插件安装, 配置webpack.config.js文件, 分开打包 html 文件, css资源打包, 内联打包, css资源打包到html, webpack.config.js配置, Lessx2FSass资源打包, 插件安装, webpack.config.js配置, lessx2Fsass 语法, 单独打包样式文件, 下载插件, webpack.config.js配置, css兼容性处理, 插件安装, 配置文件, 新建 postcss 配置文件, package.json文件配置信息, webpack.config.js配置, 压缩 css, 下载插件, webpack.config.js 配置, 图片资源打包, css中引入图片, 实现方式, webpack.config.js 配置, html中引入图片, 实现方式, webpack.config.js 配置, 打包其它资源, 字体icon资源打包, 流程, 下载及 copy 字体文件, 入口 js 中引入 iconfont, webpack.config.js 配置, eslint, 简介, 安装插件包, 配置文件, 特殊配置, 热部署, 简介, 流程, 示例, 下载包, webpack.config.js 配置, package.json, 环境优化, 开发环境HMR(模块热替换), 样式文件, html, js, 线上环境(去除死代码), js, css, 下载插件, webpack.config.js 配置简介是代码编译工具有入口出口和插件是一个用于现代应用程序的静态模块打包工具当处理应用程序时它会在内部构建一个依赖图此依赖图对应映射到项目所需的每个模块并生成一个或多个参考资料简介安装配置简介是一个模块打包器构建工具它的主要目标是将文件打包在一起打包后的文件用于在浏览器中使用但它也能够胜任转换打包或包裹任何资源官网中文文档原理和概念树结构在一个入口文件中引入所有资源形成所有依赖关系树状图模块模块就是模块可以是模块也可以是或者模块对于来说所有的资源打包过程中被操作的模块文件叫做例如异步加载一个模块就是一个是最后打包后的文件最终文件可以和长的一模一样但是大部分情况下他是多个的集合为了优化最后生产出的数量可能不等于的数量因为有可能多个被组合到了一个中工作原理为打包过程为打包结果资源代码环境安装安装至开发环境注意看看版本打包指定模式开发模式文件较大包含注释等信息生产模式无注释无空格全部在一行最终会在生成文件夹下有个生成模式打包后的文件更小里面也没有多余的说明和注释等信息默认是打包下的文件如果没有该文件夹会报错基础配置项目根目录下新建文件就用这个名字换其它的名字需要在执行命令的时候重新指定一遍默认会读取这个名字的文件不需要指定该文件为执行命令默认读取的配置文件默认打包资源中的包可获取当前项目的根路径的核心有五个入口输出插件指示应该使用哪个模块来作为构建其内部依赖图的开始进入入口起点后会找出有哪些模块和库是入口起点直接和间接依赖的默认值是入口配置选一单入口如果只有一个入口文件使用字符串指定入口文件打包一个名称是默认的中的的值输出一个多入口数组可多个入口文件所有的入口文件生成一个名称是默认的中的的值输出一个多入口对象通过配置多个入口有几个入口文件就有几个并输出几个的名称是中的的值要写成混合模式数组的多个打成个其它的单独生成一个的值还是写成告诉在哪里输出它所创建的以及如何命名这些文件主要输出文件的默认值是其他生成文件默认放置在文件夹如果是时的值要写成只能理解和文件让能够去处理其他类型的文件并将它们转换为有效模块以供应用程序使用以及被添加到依赖图中用于转换某些类型的模块而插件则可以用于执行范围更广的任务包括打包优化资源管理注入环境变量模式指示使用相应的配置开发模式配置比较简单能让代码本地调试运行的环境生产模式代码需要不断优化达到性能最好能让代码优化上线运行的环境都会自动启用一些插件生产模式使用插件更多资源打包配置由于默认只能打包资源我们想要打包资源需要在开发环境安装插件插件安装插件大步骤下载引入使用方式一安装插件方式二安装插件配置文件打包文件的核心有五个入口输出插件用于转换某些类型的模块而插件则可以用于执行范围更广的任务包括打包优化资源管理注入环境变量默认会创建一个空的会自动引入文件源文件不指定就会自动生成一个空的文件目标文件名不指定就会使用的文件作为文件名如果也没有指定就会使用系统默认的压缩移除空格结构中的空格文字间的还是保留的移除注释分开打包文件不同的文件需要引入不同的文件因此需要对不同的文件分别或组合打包成一个在不同的页面中引用模拟真实打包将和依赖打包在一起剩下的两个单独打包在一起用于转换某些类型的模块而插件则可以用于执行范围更广的任务包括打包优化资源管理注入环境变量源文件不指定就会自动生成一个空的文件目标文件名不指定就会使用的文件作为文件名如果也没有指定就会使用系统默认的中的值为中的键多个之间有依赖关系从右往左写数组中最后一个最先引入压缩移除空格结构中的空格文字间的还是保留的移除注释移除空格结构中的空格文字间的还是保留的移除注释资源打包内联打包实现原理先用把样式打包到的一个然后用创建了一个标签引入样式属于内联式打包开发环境安装插件把资源打包捆绑到文件中作用是处理中的和这样的外部资源把加载引入到中作用是把样式插入到中方法是在中插入一个标签并把样式写入到这个标签的里方式一安装插件方式二安装插件资源打包到配置标签打包的导入文件打包的时候会通过把打到中这是入口文件配置打包两个斜杠表示正则中间的表示所有的结尾的文件是用来转移的注意顺序一定是在的左边因为加载规则的时候是从右边到左通过把正则中的这里也就是所有的文件打包到中打包后再通过把这些插入到中移除空格结构中的空格文字间的还是保留的移除注释资源打包因为只是单纯的属性描述它并不具有变量条件语句等的特性导致了它难组织和维护和都属于预处理器定义了一种新的语言其基本思想是用一种专门的编程语言为增加一些编程的特性将作为目标生成文件然后开发者使用这种语言进行编码工作需要使用下载包和需要使用下载包和需要在打包的文件中引如插件安装的插件开发环境的插件开发环境配置两个斜杠表示正则中间的表示所有的结尾的文件是用来转移的注意顺序一定是在的左边因为加载规则的时候是从右边到左通过把正则中的这里也就是所有的文件打包到中打包后再通过把这些插入到中先通过转成然后通过打包到入口文件中插入到中顺序从后往前原理一致只是文件后缀名称是所以正则的时候别写错了语法语法全局变量用符号定义和引用局部变量语法样式是以结尾的文件定义变量用全局变量用符号定义和引用局部变量单独打包样式文件把等资源打包成一个独立的资源文件下载插件插件大步骤下载引入使用下载下载配置将资源单独打包成独立的文件不嵌入在中将换成移除空格结构中的空格文字间的还是保留的移除注释指定单独打包的文件的路径和文件名标签的下的兼容性处理通过插件确保所有的样式中的属性在所有类型的浏览器大多数浏览器的大多数版本都支持且显示效果一致需要使用处理下载两个包和会找到中的里面的配置通过配置加载的兼容性修改的配置新版需要写和兼容性同理插件安装安装安装至开发环境安装配置文件需要新建文件中新增标签中使用新建配置文件项目根路径新建文件该文件为的默认配置文件配置文件该配置文件引入插件该插件会读取文件下的文件配置信息支持以上的浏览器支持最后两个版本忽略已经死掉的浏览器配置执行打包时如果文件中有注释会出现如下截图报错删除注释即可解决兼容问题后新增会去找到对应的配置文件下的属性移除空格结构中的空格文字间的还是保留的移除注释指定单独打包的文件的路径和文件名标签的下的压缩下载插件引入插件使用插件下载插件引入插件开发环境引入插件开发环境配置引入创建对象压缩用于压缩的开发环境下可以先不要压缩不然格式不太好看图片资源打包中引入图片实现方式需要用这两个插件需要下载直接使用因为在中已经被废弃该模块不需要下载配置打包图片资源中引入打包图片的规则配置只有一个可以直接写不用写在里面解析超过不转文件生成路径及规则超出的会在标签下的下也就是自己定义的下生成文件名值图片后缀用于压缩的开发环境下可以先不要压缩不然格式不太好看中引入图片实现方式使用插件实现安装开发环境安装开发环境配置打包图片资源中引入打包图片的规则配置只有一个可以直接写不用写在里面解析超过不转文件生成路径及规则超出的会在标签下的下也就是自己定义的下生成文件名值图片后缀中引入的图片打包用于压缩的开发环境下可以先不要压缩不然格式不太好看打包其它资源不需要优化和压缩处理直接输出的资源称为其他资源如字体字体资源打包流程图标库下载对应的资源后将文件至项目下入口中引入直接使用模块无需下载配置规则下载及字体文件入口中引入在入口文件中引入文件配置打包字体资源中引入的图片打包打包字体资源简介是一个开源的代码检查工具初衷是为了让程序员可以创建自己的检测规则实际生产中团队内往往会制订一套统一的标准让整个团队的编码风格达到一致其实与没有任何关系两者并不互相依赖甚至一般情况下我们并不会在中进行的配置可以单独使用语法检查使用并基于包只用来检查语法注意只检查自己写的源代码第三方库是不用检查的可以在中查看规则需要使用来的规则库来检查代码需要和两个包进行检查需要依赖同时告诉它用什么标准去检查常用的就是又依赖和两个包安装插件包有很多视频在使用我在使用时会有如下报错网上说已经弃用了采用插件安装开发环境安装开发环境如果在安装的插件的时候有提示需要更换版本我是在官网下载最近的一个稳定版本重新安装的就可以了配置文件引入插件使用插件自动修复不合理写法规则会根据中的下对应的属性去检查语法规范检查中引入的图片打包打包字体资源语法检查自动修复不合理的写法在控制台可通过执行或者会去检查目录下的规范定义的检查规范为支持以上的浏览器支持最后两个版本忽略已经死掉的浏览器特殊配置有的时候想针对某行代码跳过检查只需要在该行代码上添加即可跳过对下一行的检查只针对下一行有效热部署简介在前面的章节中我们每次写完程序或者修改了内容后都需要通过进行打包到目录这种情况一般是用在生产环境开发完了打包测试上线在实际的工作中我们更加希望我们每次修改完代码后就能够自动刷新对应的等内容便于我们实时的查看调试这也就本次记录的内容热部署给我们提供了开发过程中的服务器是一个使用了的服务器它的作用主要是为了监听资源文件的改变该服务器和使用了通信协议只要资源文件发生改变就会实时的进行编译只会在内存中编译不会有任何输出下载包并不能读取你的的配置也就是说每次修改了配置文件需要手动重启一下修改其它的会自动刷新启动指令为本目录执行无法自动刷新解决添加配置流程下载包下新增属性用于指定端口等信息中指定启动命令示例下载包安装开发环境安装开发环境配置每次配置文件发生了变化需要重启服务器因为配置文件是在启动时生效发生改变不能修改启动时的参数设置这些注释了检查开发环境不方便去除了更改为在启动命令中指定新增需要指定为不然会报错应该是热部署启动后默认去读取文件如果自动刷新无效的话注意一般是开启了中看属性下有没有配置需要监听的这里的就是需要自动刷新的页面热部署需要指定为不然会报错中引入的图片打包打包字体资源语法检查自动修复不合理的写法在需要加上这个配置项才可以自动刷新如果自动刷新无效的话注意一般是开启了中看属性下有没有配置需要监听的设定的根目录如果不进行设定的话默认是在当前目录下控制台中不输出打包的信息开发中一般设置为进行打印这样查看错误比较方面不显示任何信息对信息进行颜色输出对信息不进行颜色输出开启压缩设置设置端口号默认是会在你的的入口配置文件中再添加一个入口开发热替换启动命令自动打开浏览器查看历史下新增通过命令指定开发模式启动或者打包并且携带参数指定这样就不需要在中指定命令行中的比配置文件中参数的优先级高支持以上的浏览器支持最后两个版本忽略已经死掉的浏览器环境优化开发环境的优化打包构建速度比如我们只更新了一个文件重新编译的时候只编译这一个文件热加载优化代码调式生产环境的优化代码运行的性能例如尽量减小代码文件的大小只打包引用到了的开发环境模块热替换热模块替换一般是针对开发环境的优化模块热替换即是提供的最有用的功能之一它允许在运行时更新各种模块而无需进行完全刷新启用这个功能只需要修改一下的配置使用内置的插件就可以了在中使用参数启用内置的插件后接口就会暴露在中接下来需要在中配置告诉接受的模块样式文件样式文件在使用功能的时候开发环境中使用之前使用的把所有打包成一个单独的文件这样就没有意义了因为更新了这个所有打包一起的文件比较大开发环境使用就不会打包成单独的文件这样就能做到只更新这一个样式文件这里我没去实践一般是会根据配置什么的去设置比如开发环境用线上用打包成一个文件的功能默认也没有功能不用做功能需要在入口中引入文件的功能默认没有功能只能处理非入口文件的文件启用内置的插件后接口就会暴露在中接下来需要在中配置告诉接受的模块通过代码如上图所示当一个文件发生变化时所有的都会去执行如果想要去实现只更新我们自己修改了的文件需要在入口文件中通过代码指定文件示例如下告诉接受热替换的模块为服务器检测到了的代码变化后需要执行的的回调函数这个文件有发生变化修改中将改为后并未执行中的打印语句打包样式的文件这句话只执行了的回调函数修改后并未再次打印这句话也就证明热加载只加载了中只监听了服务器检测到了的代码变化后需要执行的的回调函数线上环境去除死代码该内容是针对线上环境且指的是这类文件文件不需要因为如果不需要的我们会注释掉然后打包的时候会去压缩注释掉的内容但是这些可能会留着暂时不注释可能以后会用那么我们就期望打包的时候没有引用的这些东西不打包进去比如去网上了一个一万行的但是我们只用了其中的一部分但是又不敢乱删除以前的方法就会把所有的一万行打包进去优化了的话它自动就会去找到这一万行代码中我们使用到的打包进去或者说引入的第三方的我们也期望只把我们项目使用到的打包进去多余的就不要通过去掉了实际上并没有使用的代码来减少包的大小是自带的功能不需要下载其它的包树摇摇晃树子把黄了的叶子摇下来不要前提条件必须使用模块化开启环境中指定下载插件安装开发环境安装开发环境配置下新增以下内容四个引入一个").trim().substring(0, 1000);
    let value = Math.floor(Math.random() * 3) + 1000;
    while (value === prevParam || truncateDescription.length - value === prevParam) {
      value = Math.floor(Math.random() * 3) + 1000;
    }
    aiTitleRefreshIcon.style.opacity = "0.2";
    aiTitleRefreshIcon.style.transitionDuration = "0.3s";
    aiTitleRefreshIcon.style.transform = "rotate(" + 360 * refreshNum + "deg)";
    if (truncateDescription.length <= 1000) {
      let param = truncateDescription.length - Math.floor(Math.random() * 3);
      while (param === prevParam) {
        param = truncateDescription.length - Math.floor(Math.random() * 3);
      }
      aiAbstract(param);
      prevParam = param;
    } else {
      aiAbstract(value);
      prevParam = value;
    }
    showAiBtn();
    refreshNum++;
  });

  document.getElementById("go-tianli-blog").addEventListener("click", () => {
    window.open("https://afdian.net/item/886a79d4db6711eda42a52540025c377", "_blank");
  });
  
  if (false) {
    document.getElementById("ai-Toggle").addEventListener("click", () => {
      changeShowMode()
    });
  }

  function showAiBtn() {
    document.querySelectorAll(".ai-btn-item").forEach(item => {
      if (item.id !== "go-tianli-blog") {
        item.style.display = "block";
      }
      if (item.id === "go-tianli-blog") {
        item.style.display = "none";
      }
    });
  }


  aiAbstract();
  showAiBtn()
})()</script></div><article class="post-content" id="article-container"><h1 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h1><p>webpack 是代码编译工具，有入口、出口、loader 和插件。webpack 是一个用于现代<a target="_blank" rel="noopener" href="https://baike.baidu.com/item/JavaScript/321142">JavaScript</a>应用程序的静态模块打包工具。当 webpack 处理应用程序时，它会在内部构建一个依赖图(dependency graph)，此依赖图对应映射到项目所需的每个模块，并生成一个或多个 <em>bundle</em></p>
<span id="more"></span>

<h3 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h3><div style="position: relative; width: 100%; height: 0; padding-bottom: 75%;"><iframe src="//player.bilibili.com/player.html?aid=586217027&bvid=BV1Pz4y1S7Uv&cid=283045652&page=9" scrolling="no" border="0" frameborder="no" framespacing="0" allowfullscreen="true" style="position: absolute;width: 100%;height: 100%;left: 0;top: 0;"> </iframe></div>



<h1 id="简介安装配置"><a href="#简介安装配置" class="headerlink" title="简介安装配置"></a>简介安装配置</h1><h2 id="简介-1"><a href="#简介-1" class="headerlink" title="简介"></a>简介</h2><ul>
<li>webpack 是一个模块打包器(构建工具)。它的主要目标是将 JavaScript 文件打包在一起，打包后的文件用于在浏览器中使用，但它也能够胜任转换（transform）、打包（bundle）或包裹（package）任何资源(resource or asset)。</li>
<li>官网： <a target="_blank" rel="noopener" href="https://webpack.js.org/">https://webpack.js.org/</a>    </li>
<li>中文文档：<a target="_blank" rel="noopener" href="https://webpack.docschina.org/">https://webpack.docschina.org/</a></li>
</ul>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://automation-manage.oss-cn-shanghai.aliyuncs.com/blog/image-20220205144447552.png" alt="官网简介图"></p>
<h2 id="webpack原理和概念"><a href="#webpack原理和概念" class="headerlink" title="webpack原理和概念"></a>webpack原理和概念</h2><ul>
<li>树结构: 在一个入口文件中引入所有资源，形成所有依赖关系树状图</li>
<li>模块：模块就是模块可以是ES6模块也可以是commonJS或者AMD模块，对于webpack来说，所有的资源（css,img…）</li>
<li>chunk：打包过程中被操作的模块文件叫做chunk,例如异步加载一个模块就是一个chunk</li>
<li>bundel：bundle是最后打包后的文件,最终文件可以和chunk长的一模一样,但是大部分情况下他是多个chunk的集合</li>
<li>为了优化最后生产出的bundle数量可能不等于chunk的数量，因为有可能多个chunk被组合到了一个Bundle中。</li>
</ul>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://automation-manage.oss-cn-shanghai.aliyuncs.com/blog/image-20220205144548953.png" alt="webpack打包过程"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">graph LR</span><br><span class="line">A(webpack工作原理) --&gt;B1[png]</span><br><span class="line">    A--&gt;B2[JPG]</span><br><span class="line">    A--&gt;B3[CSS]</span><br><span class="line">    A--&gt;B4[JS]</span><br><span class="line">B[chuck为打包过程bundle为打包结果]</span><br><span class="line">subgraph 资源</span><br><span class="line">    B1 --&gt; A1((A1)) </span><br><span class="line">    B1 --&gt; A2((A2))</span><br><span class="line">    B2 --&gt;A3((B1))</span><br><span class="line">	B2 --&gt;A4((B1))</span><br><span class="line">end</span><br><span class="line">subgraph 代码</span><br><span class="line">	B3</span><br><span class="line">	B4</span><br><span class="line">end</span><br><span class="line">subgraph dist</span><br><span class="line">	main.js</span><br><span class="line">end</span><br><span class="line">A1 --&gt;|chuck1| bundle1--&gt;main.js</span><br><span class="line">A2 --&gt; |chuck1|bundle1</span><br><span class="line">A3 --&gt;|chuck1| bundle1</span><br><span class="line">A4 --&gt; |chuck1|bundle1</span><br><span class="line"></span><br><span class="line">A4 --&gt; |chuck2|bundle2--&gt;main.js</span><br><span class="line">B3 --&gt; |chuck2|bundle2</span><br><span class="line">B4 --&gt; |chuck2|bundle2</span><br></pre></td></tr></table></figure>



<h2 id="webpack环境安装"><a href="#webpack环境安装" class="headerlink" title="webpack环境安装"></a>webpack环境安装</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">安装webpack、webpack-cli至开发环境 i=install -D=--save-dev 注意看看pack.json webpack版本5+ webpack-cli4+</span></span><br><span class="line">sudo npm i webpack webpack-cli -D -g</span><br><span class="line">sudo yarn add webpack webpack-cli -D -g</span><br><span class="line">webpack -v</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">打包 --mode指定模式  development开发模式（文件较大，包含注释等信息）,production生产模式（无注释，无空格全部在一行）  最终会在生成dist文件夹下有个main.js</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">生成模式打包后的文件更小，里面也没有多余的说明和注释等信息，默认是打包 src 下的文件，如果没有该文件夹会报错</span></span><br><span class="line">webpack --mode development</span><br><span class="line">webpack --mode production</span><br></pre></td></tr></table></figure>

<h2 id="webpack基础配置"><a href="#webpack基础配置" class="headerlink" title="webpack基础配置"></a>webpack基础配置</h2><ul>
<li>项目根目录下，新建<code>webpack.config.js</code>文件（就用这个名字，换其它的名字需要在执行 webpack 命令的时候重新指定一遍，默认会读取这个名字的文件不需要指定）</li>
<li>该文件为执行 webpack 命令默认读取的配置文件</li>
<li>webpack默认打包js资源</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//node中的包，可获取当前项目的根路径</span></span><br><span class="line"><span class="keyword">const</span> &#123;resolve&#125; = <span class="built_in">require</span>(<span class="string">&quot;path&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// webpack 的核心有五个: 1.entry 入口 2.output 输出 3.loader  4.plugin 插件 5.module</span></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = &#123;</span><br><span class="line">    <span class="comment">// entry指示 webpack 应该使用哪个模块，来作为构建其内部 依赖图(dependency graph) 的开始。进入入口起点后，webpack 会找出有哪些模块和库是入口起点（直接和间接）依赖的.默认值是 ./src/index.js，入口配置3选一</span></span><br><span class="line">    <span class="comment">//单入口：如果只有一个入口文件，使用字符串指定入口文件，打包一个chunk,名称是默认的（output中的filename的值build.js）输出一个bundle</span></span><br><span class="line">    <span class="attr">entry</span>: <span class="string">&quot;./src/main.js&quot;</span>,</span><br><span class="line">    <span class="comment">//多入口：Array数组可多个入口文件，所有的入口文件生成一个chunk，名称是默认的（output中的filename的值build.js）输出一个bundle</span></span><br><span class="line">    <span class="attr">entry</span>:[<span class="string">&quot;./src/main.js&quot;</span>,<span class="string">&quot;./src/index.js&quot;</span>],</span><br><span class="line">    <span class="comment">//多入口：Object对象，通过Key：Value,配置多个入口，有几个入口文件就有几个chunk，并输出几个bundle，chunk的名称是key（output中的filename的值要写成&quot;[name].js&quot;）</span></span><br><span class="line">    <span class="attr">entry</span>:&#123;</span><br><span class="line">        <span class="attr">test</span>:<span class="string">&#x27;./src/one.js&#x27;</span>,</span><br><span class="line">        <span class="attr">index</span>:<span class="string">&#x27;./src/index.js&#x27;</span>,</span><br><span class="line">        <span class="attr">main</span>:<span class="string">&#x27;./src/main.js&#x27;</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//混合模式</span></span><br><span class="line">    <span class="attr">entry</span>:&#123;</span><br><span class="line">     <span class="comment">//Array数组的多个打成1个test，其它的单独生成一个，filename的值还是写成[name].js</span></span><br><span class="line">        <span class="attr">test</span>:[<span class="string">&quot;./src/main.js&quot;</span>,<span class="string">&quot;./src/index.js&quot;</span>],  </span><br><span class="line">        <span class="attr">index</span>:<span class="string">&#x27;./src/index.js&#x27;</span>,</span><br><span class="line">        <span class="attr">main</span>:<span class="string">&#x27;./src/main.js&#x27;</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// output告诉 webpack 在哪里输出它所创建的 bundle，以及如何命名这些文件。主要输出文件的默认值是 ./dist/main.js，其他生成文件默认放置在 ./dist 文件夹</span></span><br><span class="line">    <span class="attr">output</span>: &#123;</span><br><span class="line">    <span class="comment">//如果entry是object时，filename的值要写成&quot;[name].js&quot;</span></span><br><span class="line">        <span class="attr">filename</span>: <span class="string">&quot;[name].js&quot;</span>,</span><br><span class="line">        <span class="attr">path</span>: <span class="title function_">resolve</span>(__dirname,<span class="string">&quot;build&quot;</span>)</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="comment">// loader webpack 只能理解 JavaScript 和 JSON 文件。loader 让 webpack 能够去处理其他类型的文件，并将它们转换为有效 模块，以供应用程序使用，以及被添加到依赖图中</span></span><br><span class="line">    <span class="attr">module</span>: &#123;</span><br><span class="line">        <span class="attr">rules</span>: []</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="comment">//plugin loader 用于转换某些类型的模块，而插件则可以用于执行范围更广的任务。包括：打包优化，资源管理，注入环境变量</span></span><br><span class="line">    <span class="attr">plugins</span>: [],</span><br><span class="line">    <span class="comment">//模式（mode）指示webpack使用相应的配置，开发模式（development）：配置比较简单，能让代码本地调试运行的环境 生产模式（production）：代码需要不断优化达到性能最好，能让代码优化上线运行的环境</span></span><br><span class="line">    <span class="comment">//都会自动启用一些插件，生产模式使用插件更多</span></span><br><span class="line">    <span class="attr">mode</span>: <span class="string">&quot;development&quot;</span>,</span><br><span class="line">    <span class="comment">// mode: &quot;production&quot;,</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h1 id="html资源打包配置"><a href="#html资源打包配置" class="headerlink" title="html资源打包配置"></a>html资源打包配置</h1><blockquote>
<p>由于webpack默认只能打包js资源，我们想要打包html资源需要在开发环境安装html-webpack-plugin插件</p>
</blockquote>
<h2 id="插件安装"><a href="#插件安装" class="headerlink" title="插件安装"></a>插件安装</h2><blockquote>
<p>插件3大步骤:</p>
<p>1.下载  npm i html-webpack-plugin -D</p>
<p>2.引入 const htmlWebpackPlugin &#x3D; require(‘html-webpack-plugin’);</p>
<p>3.使用 new htmlWebpackPlugin();</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">方式一：npm安装插件</span></span><br><span class="line">npm i html-webpack-plugin -D</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">方式二：yarn安装插件</span></span><br><span class="line">yarn add  html-webpack-plugin -D</span><br></pre></td></tr></table></figure>

<h2 id="配置webpack-config-js文件"><a href="#配置webpack-config-js文件" class="headerlink" title="配置webpack.config.js文件"></a>配置webpack.config.js文件</h2><ul>
<li>打包 html 文件</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> &#123;resolve&#125; = <span class="built_in">require</span>(<span class="string">&quot;path&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> htmlWebpackPlugin = <span class="built_in">require</span>(<span class="string">&#x27;html-webpack-plugin&#x27;</span>);</span><br><span class="line"><span class="comment">// webpack 的核心有五个: 1.entry 入口 2.output 输出 3.loader  4.plugin 插件 5.module</span></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = &#123;</span><br><span class="line">    <span class="attr">output</span>: &#123;</span><br><span class="line">        <span class="attr">filename</span>: <span class="string">&quot;[name].js&quot;</span>,</span><br><span class="line">        <span class="attr">path</span>: <span class="title function_">resolve</span>(__dirname, <span class="string">&quot;build&quot;</span>)</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">module</span>: &#123;</span><br><span class="line">        <span class="attr">rules</span>: []</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">entry</span>: <span class="string">&#x27;./src/index.js&#x27;</span>,</span><br><span class="line">    <span class="comment">//plugin loader 用于转换某些类型的模块，而插件则可以用于执行范围更广的任务。包括：打包优化，资源管理，注入环境变量</span></span><br><span class="line">    <span class="attr">plugins</span>: [</span><br><span class="line">        <span class="comment">//默认会创建一个空的，会自动引入 js 文件</span></span><br><span class="line">        <span class="keyword">new</span> <span class="title function_">htmlWebpackPlugin</span>(</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="comment">//源文件(不指定template 就会自动生成一个空的 html 文件)</span></span><br><span class="line">                <span class="attr">template</span>: <span class="string">&quot;./src/index.html&quot;</span>,</span><br><span class="line">                <span class="comment">//目标文件名（不指定filename 就会使用 template 的文件作为文件名，如果template也没有指定就会使用系统默认的 index.html）</span></span><br><span class="line">                <span class="attr">filename</span>: <span class="string">&quot;demo.html&quot;</span>,</span><br><span class="line">                <span class="comment">//    压缩</span></span><br><span class="line">                <span class="attr">minify</span>: &#123;</span><br><span class="line">                    <span class="attr">collapseWhitespace</span>: <span class="literal">true</span>, <span class="comment">//    移除空格（结构中的空格，文字间的还是保留的）</span></span><br><span class="line">                    <span class="attr">removeComments</span>: <span class="literal">true</span>    <span class="comment">//    移除注释</span></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        )</span><br><span class="line">    ],</span><br><span class="line">    <span class="attr">mode</span>: <span class="string">&quot;development&quot;</span>,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="分开打包-html-文件"><a href="#分开打包-html-文件" class="headerlink" title="分开打包 html 文件"></a>分开打包 html 文件</h2><ul>
<li>不同的 html 文件需要引入不同的 js 文件，因此需要对不同的 js 文件分别或组合打包成一个bundle,在不同的页面中引用</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//模拟真实打包</span></span><br><span class="line"><span class="keyword">const</span> &#123;resolve&#125; = <span class="built_in">require</span>(<span class="string">&quot;path&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> htmlWebpackPlugin = <span class="built_in">require</span>(<span class="string">&#x27;html-webpack-plugin&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = &#123;</span><br><span class="line">    <span class="attr">mode</span>: <span class="string">&quot;development&quot;</span>,</span><br><span class="line"></span><br><span class="line">    <span class="attr">entry</span>: &#123;</span><br><span class="line">        <span class="comment">// 将 common 和 jquery 依赖打包在一起，剩下的两个单独打包在一起</span></span><br><span class="line">        <span class="attr">vendor</span>: [<span class="string">&#x27;./src/js/common.js&#x27;</span>, <span class="string">&#x27;jquery&#x27;</span>],</span><br><span class="line">        <span class="attr">index</span>: <span class="string">&quot;./src/js/index.js&quot;</span>,</span><br><span class="line">        <span class="attr">cart</span>: <span class="string">&quot;./src/js/cart.js&quot;</span></span><br><span class="line">    &#125;,</span><br><span class="line"></span><br><span class="line">    <span class="attr">output</span>: &#123;</span><br><span class="line">        <span class="attr">filename</span>: <span class="string">&quot;[name].js&quot;</span>,</span><br><span class="line">        <span class="attr">path</span>: <span class="title function_">resolve</span>(__dirname, <span class="string">&quot;build&quot;</span>)</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">module</span>: &#123;</span><br><span class="line">        <span class="attr">rules</span>: []</span><br><span class="line">    &#125;,</span><br><span class="line"></span><br><span class="line">    <span class="comment">//plugin loader 用于转换某些类型的模块，而插件则可以用于执行范围更广的任务。包括：打包优化，资源管理，注入环境变量</span></span><br><span class="line">    <span class="attr">plugins</span>: [</span><br><span class="line">        <span class="keyword">new</span> <span class="title function_">htmlWebpackPlugin</span>(&#123;</span><br><span class="line">            <span class="comment">//源文件(不指定template 就会自动生成一个空的 html 文件)</span></span><br><span class="line">            <span class="attr">template</span>: <span class="string">&quot;./src/view/index.html&quot;</span>,</span><br><span class="line">            <span class="comment">//目标文件名（不指定filename 就会使用 template 的文件作为文件名，如果template也没有指定就会使用系统默认的 index.html）</span></span><br><span class="line">            <span class="attr">filename</span>: <span class="string">&quot;demo.html&quot;</span>,</span><br><span class="line">            <span class="attr">chunks</span>: [<span class="string">&#x27;index&#x27;</span>,<span class="string">&#x27;vendor&#x27;</span>], <span class="comment">// chunks 中的值为 entry 中的键，多个bundle之间有依赖关系，从右往左写，数组中最后一个最先引入</span></span><br><span class="line">            <span class="comment">//    压缩</span></span><br><span class="line">            <span class="attr">minify</span>: &#123;</span><br><span class="line">                <span class="attr">collapseWhitespace</span>: <span class="literal">true</span>, <span class="comment">//    移除空格（结构中的空格，文字间的还是保留的）</span></span><br><span class="line">                <span class="attr">removeComments</span>: <span class="literal">true</span>    <span class="comment">//    移除注释</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;),</span><br><span class="line">        <span class="keyword">new</span> <span class="title function_">htmlWebpackPlugin</span>(&#123;</span><br><span class="line">            <span class="attr">template</span>: <span class="string">&quot;./src/view/cart.html&quot;</span>,</span><br><span class="line">            <span class="attr">filename</span>: <span class="string">&quot;demo2.html&quot;</span>,</span><br><span class="line">            <span class="attr">chunks</span>: [<span class="string">&#x27;cart&#x27;</span>,<span class="string">&#x27;vendor&#x27;</span>],</span><br><span class="line">            <span class="attr">minify</span>: &#123;</span><br><span class="line">                <span class="attr">collapseWhitespace</span>: <span class="literal">true</span>, <span class="comment">//    移除空格（结构中的空格，文字间的还是保留的）</span></span><br><span class="line">                <span class="attr">removeComments</span>: <span class="literal">true</span>    <span class="comment">//    移除注释</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;)</span><br><span class="line">    ]</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>




<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://automation-manage.oss-cn-shanghai.aliyuncs.com/blog/image-20220210220810678.png" alt="分别打包 html"></p>
<h1 id="css资源打包"><a href="#css资源打包" class="headerlink" title="css资源打包"></a>css资源打包</h1><h2 id="内联打包"><a href="#内联打包" class="headerlink" title="内联打包"></a>内联打包</h2><ul>
<li>实现原理：先用css-loader把 css 样式打包到 js 的一个bundle 然后用style-loader创建了一个<style></style>&gt;标签引入样式,属于内联式打包</li>
<li>开发环境安装插件:css-loader style-loader<ul>
<li>css-loader:把css资源打包捆绑到js文件中（作用是处理css中的 @import 和 url 这样的外部资源）</li>
<li>style-loader:把css加载引入到html中（作用是把样式插入到 DOM中，方法是在head中插入一个style标签，并把样式写入到这个标签的 innerHTML里）</li>
</ul>
</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#方式一：npm 安装插件</span></span><br><span class="line">npm i css-loader style-loader -D</span><br><span class="line"><span class="comment">#方式二：yarn 安装插件</span></span><br><span class="line">yarn add css-loader style-loader -D</span><br></pre></td></tr></table></figure>

<h2 id="css资源打包到html"><a href="#css资源打包到html" class="headerlink" title="css资源打包到html"></a>css资源打包到html</h2><ul>
<li>webpack配置<code>module</code>标签</li>
</ul>
<ul>
<li><p>打包的 js 导入css文件(import&#x2F;require)</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//打包index的时候会通过css-loder把css打到index.js中</span></span><br><span class="line"><span class="built_in">require</span>(<span class="string">&#x27;./style.css&#x27;</span>)</span><br><span class="line"><span class="built_in">require</span>(<span class="string">&#x27;./lessstyle.less&#x27;</span>)</span><br><span class="line"><span class="built_in">require</span>(<span class="string">&#x27;./sassstyle.scss&#x27;</span>)</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;这是入口文件&quot;</span>);</span><br></pre></td></tr></table></figure></li>
</ul>
<h2 id="webpack-config-js配置"><a href="#webpack-config-js配置" class="headerlink" title="webpack.config.js配置"></a>webpack.config.js配置</h2>  <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//打包 css</span></span><br><span class="line"><span class="keyword">const</span> &#123;resolve&#125; = <span class="built_in">require</span>(<span class="string">&quot;path&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> htmlWebpackPlugin = <span class="built_in">require</span>(<span class="string">&#x27;html-webpack-plugin&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = &#123;</span><br><span class="line">    <span class="attr">mode</span>: <span class="string">&quot;development&quot;</span>,</span><br><span class="line"></span><br><span class="line">    <span class="attr">entry</span>: <span class="string">&#x27;./src/demo/js/index.js&#x27;</span>,</span><br><span class="line">    <span class="attr">output</span>: &#123;</span><br><span class="line">        <span class="attr">filename</span>: <span class="string">&quot;[name].js&quot;</span>,</span><br><span class="line">        <span class="attr">path</span>: <span class="title function_">resolve</span>(__dirname, <span class="string">&quot;build&quot;</span>)</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">module</span>: &#123;</span><br><span class="line">        <span class="attr">rules</span>: [&#123;</span><br><span class="line">            <span class="comment">// 两个斜杠表示正则,中间的.css$表示所有的.css结尾的文件 &quot;\&quot;是用来转移&quot;.&quot;的</span></span><br><span class="line">            <span class="attr">test</span>:<span class="regexp">/\.css$/</span>,</span><br><span class="line">            <span class="comment">//注意顺序,一定是style-loader在css-loader的左边,因为加载规则的时候是从右边到左</span></span><br><span class="line">            <span class="comment">//1.通过css-loader把正则中的(这里也就是所有的css文件)打包到js中</span></span><br><span class="line">            <span class="comment">//2.打包后再通过style-loader把这些插入到html中</span></span><br><span class="line">            <span class="attr">use</span>: [<span class="string">&#x27;style-loader&#x27;</span>,<span class="string">&#x27;css-loader&#x27;</span>]</span><br><span class="line">        &#125;]</span><br><span class="line">    &#125;,</span><br><span class="line"></span><br><span class="line">    <span class="attr">plugins</span>: [</span><br><span class="line">        <span class="keyword">new</span> <span class="title function_">htmlWebpackPlugin</span>(&#123;</span><br><span class="line">            <span class="attr">template</span>: <span class="string">&quot;./src/demo/index.html&quot;</span>,</span><br><span class="line">            <span class="attr">filename</span>: <span class="string">&quot;demo.html&quot;</span>,</span><br><span class="line">            <span class="attr">chunks</span>: [<span class="string">&#x27;main&#x27;</span>],</span><br><span class="line">            <span class="attr">minify</span>: &#123;</span><br><span class="line">                <span class="attr">collapseWhitespace</span>: <span class="literal">true</span>, <span class="comment">//    移除空格（结构中的空格，文字间的还是保留的）</span></span><br><span class="line">                <span class="attr">removeComments</span>: <span class="literal">true</span>    <span class="comment">//    移除注释</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;)</span><br><span class="line">    ]</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>




<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://automation-manage.oss-cn-shanghai.aliyuncs.com/blog/image-20220210225332026.png" alt="css 样式打包到 html"></p>
<h1 id="Less-Sass资源打包"><a href="#Less-Sass资源打包" class="headerlink" title="Less&#x2F;Sass资源打包"></a>Less&#x2F;Sass资源打包</h1><ul>
<li>因为css只是单纯的属性描述,它并不具有变量、条件语句等,css的特性导致了它难组织和维护。</li>
<li>Sass和Less都属于CSS预处理器,定义了一种新的语言,其基本思想是用一种专门的编程语言,为</li>
<li>CSS增加一些编程的特性,将CSS作为目标生成文件,然后开发者使用这种语言进行CSS编码工作.</li>
<li>Less需要使用npm下载less包和less- loader</li>
<li>Sass需要使用npm下载node-sass包和sass- loader</li>
<li>需要在打包的 js 文件中引如 less sass</li>
</ul>
<h2 id="插件安装-1"><a href="#插件安装-1" class="headerlink" title="插件安装"></a>插件安装</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#Less的插件(开发环境)</span></span><br><span class="line">npm i less less-loader -D</span><br><span class="line">yarn add less less-loader -D</span><br><span class="line"><span class="comment">#Sass的插件(开发环境)</span></span><br><span class="line">npm i node-sass sass-loader -D</span><br><span class="line">yarn add node-sass sass-loader -D</span><br></pre></td></tr></table></figure>

<h2 id="webpack-config-js配置-1"><a href="#webpack-config-js配置-1" class="headerlink" title="webpack.config.js配置"></a>webpack.config.js配置</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">module</span>: &#123;</span><br><span class="line">       <span class="attr">rules</span>: [</span><br><span class="line">           &#123;</span><br><span class="line">               <span class="comment">// 两个斜杠表示正则,中间的.css$表示所有的.css结尾的文件 &quot;\&quot;是用来转移&quot;.&quot;的</span></span><br><span class="line">               <span class="attr">test</span>: <span class="regexp">/\.css$/</span>,</span><br><span class="line">               <span class="comment">//注意顺序,一定是style-loader在css-loader的左边,因为加载规则的时候是从右边到左</span></span><br><span class="line">               <span class="comment">//1.通过css-loader把正则中的(这里也就是所有的css文件)打包到js中</span></span><br><span class="line">               <span class="comment">//2.打包后再通过style-loader把这些插入到html中</span></span><br><span class="line">               <span class="attr">use</span>: [<span class="string">&#x27;style-loader&#x27;</span>, <span class="string">&#x27;css-loader&#x27;</span>]</span><br><span class="line">           &#125;,</span><br><span class="line">           <span class="comment">//先通过less-loader转成css,然后通过css-loader打包到入口文件js中,style-loader插入到html中,顺序从后往前 </span></span><br><span class="line">           &#123;<span class="attr">test</span>: <span class="regexp">/\.less$/</span>,<span class="attr">use</span>: [<span class="string">&#x27;style-loader&#x27;</span>, <span class="string">&#x27;css-loader&#x27;</span>,<span class="string">&#x27;less-loader&#x27;</span>]&#125;,</span><br><span class="line">           <span class="comment">//sass原理一致,只是文件后缀名称是scss,所以正则的时候别写错了</span></span><br><span class="line">           &#123;<span class="attr">test</span>: <span class="regexp">/\.scss$/</span>,<span class="attr">use</span>: [<span class="string">&#x27;style-loader&#x27;</span>, <span class="string">&#x27;css-loader&#x27;</span>, <span class="string">&#x27;sass-loader&#x27;</span>]</span><br><span class="line">           &#125;</span><br><span class="line">       ]</span><br><span class="line">   &#125;,</span><br></pre></td></tr></table></figure>

<h2 id="less-sass-语法"><a href="#less-sass-语法" class="headerlink" title="less&#x2F;sass 语法"></a>less&#x2F;sass 语法</h2><figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//less语法</span></span><br><span class="line"><span class="comment">//全局变量用@符号定义和引用</span></span><br><span class="line"><span class="variable">@color:</span> red;</span><br><span class="line"><span class="variable">@background:</span> yellow;</span><br><span class="line"><span class="variable">@width:</span> <span class="number">200px</span>;</span><br><span class="line"><span class="variable">@height:</span> <span class="number">300px</span>;</span><br><span class="line"><span class="selector-id">#lessBox</span> &#123;</span><br><span class="line">  <span class="comment">//局部变量</span></span><br><span class="line">  <span class="attribute">color</span>: <span class="variable">@color</span>;</span><br><span class="line">  <span class="attribute">width</span>: <span class="variable">@width</span>*<span class="number">0.5</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="variable">@height</span>*<span class="number">0.33333</span>;</span><br><span class="line">  <span class="attribute">background</span>: <span class="variable">@background</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//sass语法</span></span><br><span class="line"><span class="comment">// sass 样式是以 scss 结尾的文件 定义变量用 $</span></span><br><span class="line"><span class="comment">//全局变量用$符号定义和引用</span></span><br><span class="line"><span class="variable">$color</span>: blue;</span><br><span class="line"><span class="variable">$background</span>: black;</span><br><span class="line"><span class="variable">$width</span>: <span class="number">200px</span>;</span><br><span class="line"><span class="variable">$height</span>: <span class="number">300px</span>;</span><br><span class="line"><span class="selector-id">#sassBox</span> &#123;</span><br><span class="line">  <span class="comment">//局部变量</span></span><br><span class="line">  <span class="attribute">color</span>: <span class="variable">$color</span>;</span><br><span class="line">  <span class="attribute">width</span>: <span class="variable">$width</span>*<span class="number">0.8</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="variable">$height</span>*<span class="number">0.5</span>;</span><br><span class="line">  <span class="attribute">background</span>: <span class="variable">$background</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h1 id="单独打包样式文件"><a href="#单独打包样式文件" class="headerlink" title="单独打包样式文件"></a>单独打包样式文件</h1><blockquote>
<p>把less,sass,css等资源打包成一个独立的资源文件</p>
</blockquote>
<h2 id="下载插件"><a href="#下载插件" class="headerlink" title="下载插件"></a>下载插件</h2><blockquote>
<p>插件3大步骤:</p>
<p>1.下载  npm i mini-css-extract-plugin -D</p>
<p>2.引入 const miniCssExtractPlugin &#x3D; require(‘mini-css-extract-plugin’);</p>
<p>3.使用 new miniCssExtractPlugin()</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># npm 下载</span></span><br><span class="line">npm i mini-css-extract-plugin -D</span><br><span class="line"><span class="comment"># yarn 下载</span></span><br><span class="line">yarn add mini-css-extract-plugin -D</span><br></pre></td></tr></table></figure>

<h2 id="webpack-config-js配置-2"><a href="#webpack-config-js配置-2" class="headerlink" title="webpack.config.js配置"></a>webpack.config.js配置</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//将css less sass 资源 单独打包 成独立的文件 不嵌入在 js 中</span></span><br><span class="line"><span class="keyword">const</span> &#123;resolve&#125; = <span class="built_in">require</span>(<span class="string">&quot;path&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> htmlWebpackPlugin = <span class="built_in">require</span>(<span class="string">&#x27;html-webpack-plugin&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> <span class="title class_">MiniCssExtractPlugin</span> = <span class="built_in">require</span>(<span class="string">&#x27;mini-css-extract-plugin&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = &#123;</span><br><span class="line">    <span class="attr">mode</span>: <span class="string">&quot;development&quot;</span>,</span><br><span class="line"></span><br><span class="line">    <span class="attr">entry</span>: <span class="string">&#x27;./src/demo/js/index.js&#x27;</span>,</span><br><span class="line">    <span class="attr">output</span>: &#123;</span><br><span class="line">        <span class="attr">filename</span>: <span class="string">&quot;[name].js&quot;</span>,</span><br><span class="line">        <span class="attr">path</span>: <span class="title function_">resolve</span>(__dirname, <span class="string">&quot;build&quot;</span>)</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">module</span>: &#123;</span><br><span class="line">        <span class="attr">rules</span>: [</span><br><span class="line">            <span class="comment">// 将 style-loader 换成 MiniCssExtractPlugin.loader</span></span><br><span class="line">            &#123;<span class="attr">test</span>: <span class="regexp">/\.css$/</span>, <span class="attr">use</span>: [<span class="title class_">MiniCssExtractPlugin</span>.<span class="property">loader</span>, <span class="string">&#x27;css-loader&#x27;</span>]&#125;,</span><br><span class="line">            &#123;<span class="attr">test</span>: <span class="regexp">/\.less$/</span>, <span class="attr">use</span>: [<span class="title class_">MiniCssExtractPlugin</span>.<span class="property">loader</span>, <span class="string">&#x27;css-loader&#x27;</span>, <span class="string">&#x27;less-loader&#x27;</span>],&#125;,</span><br><span class="line">            &#123;<span class="attr">test</span>: <span class="regexp">/\.scss$/</span>, <span class="attr">use</span>: [<span class="title class_">MiniCssExtractPlugin</span>.<span class="property">loader</span>, <span class="string">&#x27;css-loader&#x27;</span>, <span class="string">&#x27;sass-loader&#x27;</span>],&#125;</span><br><span class="line">        ]</span><br><span class="line">    &#125;,</span><br><span class="line"></span><br><span class="line">    <span class="attr">plugins</span>: [</span><br><span class="line">        <span class="keyword">new</span> <span class="title function_">htmlWebpackPlugin</span>(&#123;</span><br><span class="line">            <span class="attr">template</span>: <span class="string">&quot;./src/demo/index.html&quot;</span>,</span><br><span class="line">            <span class="attr">filename</span>: <span class="string">&quot;demo.html&quot;</span>,</span><br><span class="line">            <span class="attr">chunks</span>: [<span class="string">&#x27;main&#x27;</span>],</span><br><span class="line">            <span class="attr">minify</span>: &#123;</span><br><span class="line">                <span class="attr">collapseWhitespace</span>: <span class="literal">true</span>, <span class="comment">//    移除空格（结构中的空格，文字间的还是保留的）</span></span><br><span class="line">                <span class="attr">removeComments</span>: <span class="literal">true</span>    <span class="comment">//    移除注释</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;),</span><br><span class="line">        <span class="keyword">new</span> <span class="title class_">MiniCssExtractPlugin</span>(&#123;</span><br><span class="line">            <span class="comment">//指定单独打包的 css 文件的路径和文件名  output标签的 path 下的 ./css/demo.css</span></span><br><span class="line">            <span class="attr">filename</span>:<span class="string">&#x27;./css/demo.css&#x27;</span>&#125;)</span><br><span class="line">    ]</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>





<h1 id="css兼容性处理"><a href="#css兼容性处理" class="headerlink" title="css兼容性处理"></a>css兼容性处理</h1><blockquote>
<ul>
<li>通过插件确保所有的css样式中的属性在所有类型的浏览器大多数浏览器的大多数版本都支持,且显示效果一致</li>
<li>需要使用postcss处理,下载两个包postcss-loader和postcss-preset-env</li>
<li>posters会找到 package json中的 browserslist里面的配置,通过配置加载css的兼容性</li>
<li>修改loader的配置， 新版需要写postcss.config.js,  less和sass兼容性同理</li>
</ul>
</blockquote>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://automation-manage.oss-cn-shanghai.aliyuncs.com/blog/image-20220214212919060.png" alt="兼容转换效果"></p>
<h2 id="插件安装-2"><a href="#插件安装-2" class="headerlink" title="插件安装"></a>插件安装</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">npm 安装postcss-loader,postcss-preset-env 安装至开发环境</span></span><br><span class="line">npm i postcss-loader postcss-preset-env -D</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">yarn 安装</span></span><br><span class="line">yarn add postcss-loader postcss-preset-env -D</span><br></pre></td></tr></table></figure>

<h2 id="配置文件"><a href="#配置文件" class="headerlink" title="配置文件"></a>配置文件</h2><ul>
<li>需要新建 <code>postcss.config.js</code>文件、package.json中新增 <code>browserslist</code> 标签、webpack.config.js中使用 <code>postcss-loader</code></li>
</ul>
<h3 id="新建-postcss-配置文件"><a href="#新建-postcss-配置文件" class="headerlink" title="新建 postcss 配置文件"></a>新建 postcss 配置文件</h3><ul>
<li>项目根路径新建 <code>postcss.config.js</code> 文件，该文件为 postcss 的默认配置文件</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// postcss 配置文件，该配置文件引入 postcss-preset-env 插件--&gt;该插件会读取 package.json文件下的 browserslist</span></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> =&#123;</span><br><span class="line">    <span class="attr">plugins</span>: [</span><br><span class="line">        <span class="built_in">require</span>(<span class="string">&#x27;postcss-preset-env&#x27;</span>)()</span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="package-json文件配置信息"><a href="#package-json文件配置信息" class="headerlink" title="package.json文件配置信息"></a>package.json文件配置信息</h3><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;devDependencies&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;css-loader&quot;</span><span class="punctuation">:</span> <span class="string">&quot;^6.6.0&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;html-webpack-plugin&quot;</span><span class="punctuation">:</span> <span class="string">&quot;^5.5.0&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;less&quot;</span><span class="punctuation">:</span> <span class="string">&quot;^4.1.2&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;less-loader&quot;</span><span class="punctuation">:</span> <span class="string">&quot;^10.2.0&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;mini-css-extract-plugin&quot;</span><span class="punctuation">:</span> <span class="string">&quot;^2.5.3&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;node-sass&quot;</span><span class="punctuation">:</span> <span class="string">&quot;^7.0.1&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;postcss-loader&quot;</span><span class="punctuation">:</span> <span class="string">&quot;^6.2.1&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;postcss-preset-env&quot;</span><span class="punctuation">:</span> <span class="string">&quot;^7.3.3&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;sass-loader&quot;</span><span class="punctuation">:</span> <span class="string">&quot;^12.4.0&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;style-loader&quot;</span><span class="punctuation">:</span> <span class="string">&quot;^3.3.1&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;webpack&quot;</span><span class="punctuation">:</span> <span class="string">&quot;^5.68.0&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;webpack-cli&quot;</span><span class="punctuation">:</span> <span class="string">&quot;^4.9.2&quot;</span></span><br><span class="line">  <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;dependencies&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;jquery&quot;</span><span class="punctuation">:</span> <span class="string">&quot;^3.6.0&quot;</span></span><br><span class="line">  <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;browserslistcomment&quot;</span><span class="punctuation">:</span> <span class="string">&quot;支持80%以上的浏览器,支持最后两个版本,忽略已经死掉的浏览器&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;browserslist&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">    <span class="string">&quot;&gt; 0.2%&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="string">&quot;last 2 version&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="string">&quot;not dead&quot;</span></span><br><span class="line">  <span class="punctuation">]</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>

<h3 id="webpack-config-js配置-3"><a href="#webpack-config-js配置-3" class="headerlink" title="webpack.config.js配置"></a>webpack.config.js配置</h3><ul>
<li>执行 webpack 打包时如果 less scss 文件中有注释会出现如下截图报错，删除注释即可</li>
</ul>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://automation-manage.oss-cn-shanghai.aliyuncs.com/blog/image-20220214211912077.png" alt="less sass 打包报错"></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//解决css less sass 兼容问题</span></span><br><span class="line"><span class="keyword">const</span> &#123;resolve&#125; = <span class="built_in">require</span>(<span class="string">&quot;path&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> htmlWebpackPlugin = <span class="built_in">require</span>(<span class="string">&#x27;html-webpack-plugin&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> <span class="title class_">MiniCssExtractPlugin</span> = <span class="built_in">require</span>(<span class="string">&#x27;mini-css-extract-plugin&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = &#123;</span><br><span class="line">    <span class="attr">mode</span>: <span class="string">&quot;development&quot;</span>,</span><br><span class="line"></span><br><span class="line">    <span class="attr">entry</span>: <span class="string">&#x27;./src/demo/js/index.js&#x27;</span>,</span><br><span class="line">    <span class="attr">output</span>: &#123;</span><br><span class="line">        <span class="attr">filename</span>: <span class="string">&quot;[name].js&quot;</span>,</span><br><span class="line">        <span class="attr">path</span>: <span class="title function_">resolve</span>(__dirname, <span class="string">&quot;build&quot;</span>)</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">module</span>: &#123;</span><br><span class="line">        <span class="attr">rules</span>: [</span><br><span class="line">            <span class="comment">// &#x27;css/less/sass-loader&#x27; 后新增 &#x27;postcss-loader&#x27; (postcss-loader 会去找到对应的配置文件 postcss.config.js---&gt;package.json下的browserslist属性)</span></span><br><span class="line">            &#123;<span class="attr">test</span>: <span class="regexp">/\.css$/</span>, <span class="attr">use</span>: [<span class="title class_">MiniCssExtractPlugin</span>.<span class="property">loader</span>, <span class="string">&#x27;css-loader&#x27;</span>,<span class="string">&#x27;postcss-loader&#x27;</span>]&#125;,</span><br><span class="line">            &#123;<span class="attr">test</span>: <span class="regexp">/\.less$/</span>, <span class="attr">use</span>: [<span class="title class_">MiniCssExtractPlugin</span>.<span class="property">loader</span>, <span class="string">&#x27;css-loader&#x27;</span>, <span class="string">&#x27;less-loader&#x27;</span>,<span class="string">&#x27;postcss-loader&#x27;</span>]&#125;,</span><br><span class="line">            &#123;<span class="attr">test</span>: <span class="regexp">/\.scss$/</span>, <span class="attr">use</span>: [<span class="title class_">MiniCssExtractPlugin</span>.<span class="property">loader</span>, <span class="string">&#x27;css-loader&#x27;</span>, <span class="string">&#x27;sass-loader&#x27;</span>,<span class="string">&#x27;postcss-loader&#x27;</span>],&#125;</span><br><span class="line">        ]</span><br><span class="line">    &#125;,</span><br><span class="line"></span><br><span class="line">    <span class="attr">plugins</span>: [</span><br><span class="line">        <span class="keyword">new</span> <span class="title function_">htmlWebpackPlugin</span>(&#123;</span><br><span class="line">            <span class="attr">template</span>: <span class="string">&quot;./src/demo/index.html&quot;</span>,</span><br><span class="line">            <span class="attr">filename</span>: <span class="string">&quot;demo.html&quot;</span>,</span><br><span class="line">            <span class="attr">chunks</span>: [<span class="string">&#x27;main&#x27;</span>],</span><br><span class="line">            <span class="attr">minify</span>: &#123;</span><br><span class="line">                <span class="attr">collapseWhitespace</span>: <span class="literal">true</span>, <span class="comment">//    移除空格（结构中的空格，文字间的还是保留的）</span></span><br><span class="line">                <span class="attr">removeComments</span>: <span class="literal">true</span>    <span class="comment">//    移除注释</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;),</span><br><span class="line">        <span class="keyword">new</span> <span class="title class_">MiniCssExtractPlugin</span>(&#123;</span><br><span class="line">            <span class="comment">//指定单独打包的 css 文件的路径和文件名  output标签的 path 下的 ./css/demo.css</span></span><br><span class="line">            <span class="attr">filename</span>:<span class="string">&#x27;./css/demo.css&#x27;</span>&#125;)</span><br><span class="line">    ]</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h1 id="压缩-css"><a href="#压缩-css" class="headerlink" title="压缩 css"></a>压缩 css</h1><ul>
<li>下载插件 optimize-css-assets-webpack-plugin</li>
<li>引入插件：const OptimizeCssAssetsWebpackPlugin &#x3D;  require(‘optimize-css-assets-webpack-plugin’);</li>
<li>使用插件： plugins: [ new OptimizeCssAssetsWebpackPlugin() ]</li>
</ul>
<h2 id="下载插件-1"><a href="#下载插件-1" class="headerlink" title="下载插件"></a>下载插件</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># npm 引入插件（开发环境）</span></span><br><span class="line">npm i optimize-css-assets-webpack-plugin -D</span><br><span class="line"><span class="comment"># yarn 引入插件（开发环境）</span></span><br><span class="line">yarn add optimize-css-assets-webpack-plugin -D</span><br></pre></td></tr></table></figure>

<h2 id="webpack-config-js-配置"><a href="#webpack-config-js-配置" class="headerlink" title="webpack.config.js 配置"></a>webpack.config.js 配置</h2><ul>
<li>引入：const OptimizeCssAssetsWebpackPlugin &#x3D; require(‘optimize-css-assets-webpack-plugin’); </li>
<li>创建对象：new OptimizeCssAssetsWebpackPlugin()</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//压缩 css</span></span><br><span class="line"><span class="keyword">const</span> &#123;resolve&#125; = <span class="built_in">require</span>(<span class="string">&quot;path&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> htmlWebpackPlugin = <span class="built_in">require</span>(<span class="string">&#x27;html-webpack-plugin&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> <span class="title class_">MiniCssExtractPlugin</span> = <span class="built_in">require</span>(<span class="string">&#x27;mini-css-extract-plugin&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> <span class="title class_">OptimizeCssAssetsWebpackPlugin</span> = <span class="built_in">require</span>(<span class="string">&#x27;optimize-css-assets-webpack-plugin&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = &#123;</span><br><span class="line">    <span class="attr">mode</span>: <span class="string">&quot;development&quot;</span>,</span><br><span class="line"></span><br><span class="line">    <span class="attr">entry</span>: <span class="string">&#x27;./src/demo/js/index.js&#x27;</span>,</span><br><span class="line">    <span class="attr">output</span>: &#123;</span><br><span class="line">        <span class="attr">filename</span>: <span class="string">&quot;[name].js&quot;</span>,</span><br><span class="line">        <span class="attr">path</span>: <span class="title function_">resolve</span>(__dirname, <span class="string">&quot;build&quot;</span>)</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">module</span>: &#123;</span><br><span class="line">        <span class="attr">rules</span>: [</span><br><span class="line">            &#123;<span class="attr">test</span>: <span class="regexp">/\.css$/</span>, <span class="attr">use</span>: [<span class="title class_">MiniCssExtractPlugin</span>.<span class="property">loader</span>, <span class="string">&#x27;css-loader&#x27;</span>,<span class="string">&#x27;postcss-loader&#x27;</span>]&#125;,</span><br><span class="line">            &#123;<span class="attr">test</span>: <span class="regexp">/\.less$/</span>, <span class="attr">use</span>: [<span class="title class_">MiniCssExtractPlugin</span>.<span class="property">loader</span>, <span class="string">&#x27;css-loader&#x27;</span>, <span class="string">&#x27;less-loader&#x27;</span>,<span class="string">&#x27;postcss-loader&#x27;</span>]&#125;,</span><br><span class="line">            &#123;<span class="attr">test</span>: <span class="regexp">/\.scss$/</span>, <span class="attr">use</span>: [<span class="title class_">MiniCssExtractPlugin</span>.<span class="property">loader</span>, <span class="string">&#x27;css-loader&#x27;</span>, <span class="string">&#x27;sass-loader&#x27;</span>,<span class="string">&#x27;postcss-loader&#x27;</span>],&#125;</span><br><span class="line">        ]</span><br><span class="line">    &#125;,</span><br><span class="line"></span><br><span class="line">    <span class="attr">plugins</span>: [</span><br><span class="line">        <span class="keyword">new</span> <span class="title function_">htmlWebpackPlugin</span>(&#123;</span><br><span class="line">            <span class="attr">template</span>: <span class="string">&quot;./src/demo/index.html&quot;</span>,</span><br><span class="line">            <span class="attr">filename</span>: <span class="string">&quot;demo.html&quot;</span>,</span><br><span class="line">            <span class="attr">chunks</span>: [<span class="string">&#x27;main&#x27;</span>],</span><br><span class="line">            <span class="attr">minify</span>: &#123;</span><br><span class="line">                <span class="attr">collapseWhitespace</span>: <span class="literal">true</span>,</span><br><span class="line">                <span class="attr">removeComments</span>: <span class="literal">true</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;),</span><br><span class="line">        <span class="keyword">new</span> <span class="title class_">MiniCssExtractPlugin</span>(&#123;</span><br><span class="line">            <span class="attr">filename</span>:<span class="string">&#x27;./css/demo.css&#x27;</span>&#125;),</span><br><span class="line">        <span class="comment">// 用于压缩 css 的，开发环境下可以先不要压缩，不然格式不太好看</span></span><br><span class="line">        <span class="keyword">new</span> <span class="title class_">OptimizeCssAssetsWebpackPlugin</span>()</span><br><span class="line">    ]</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h1 id="图片资源打包"><a href="#图片资源打包" class="headerlink" title="图片资源打包"></a>图片资源打包</h1><h2 id="css中引入图片"><a href="#css中引入图片" class="headerlink" title="css中引入图片"></a>css中引入图片</h2><h3 id="实现方式"><a href="#实现方式" class="headerlink" title="实现方式"></a>实现方式</h3><ul>
<li>webpack4 需要用 <code>file-loader</code> <code>url-loader</code> 这两个插件（需要下载）</li>
<li>webpack5 直接使用 <code>assets-module</code>  <strong>因为在<code>v5</code>中<code>url-loader</code>已经被废弃</strong>（该模块不需要下载）</li>
</ul>
<h3 id="webpack-config-js-配置-1"><a href="#webpack-config-js-配置-1" class="headerlink" title="webpack.config.js 配置"></a>webpack.config.js 配置</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//打包图片资源（css html中引入）</span></span><br><span class="line"><span class="keyword">const</span> &#123;resolve&#125; = <span class="built_in">require</span>(<span class="string">&quot;path&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> htmlWebpackPlugin = <span class="built_in">require</span>(<span class="string">&#x27;html-webpack-plugin&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> <span class="title class_">MiniCssExtractPlugin</span> = <span class="built_in">require</span>(<span class="string">&#x27;mini-css-extract-plugin&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> <span class="title class_">OptimizeCssAssetsWebpackPlugin</span> = <span class="built_in">require</span>(<span class="string">&#x27;optimize-css-assets-webpack-plugin&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = &#123;</span><br><span class="line">    <span class="attr">mode</span>: <span class="string">&quot;development&quot;</span>,</span><br><span class="line"></span><br><span class="line">    <span class="attr">entry</span>: <span class="string">&#x27;./src/demo/js/index.js&#x27;</span>,</span><br><span class="line">    <span class="attr">output</span>: &#123;</span><br><span class="line">        <span class="attr">filename</span>: <span class="string">&quot;[name].js&quot;</span>,</span><br><span class="line">        <span class="attr">path</span>: <span class="title function_">resolve</span>(__dirname, <span class="string">&quot;build&quot;</span>)</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">module</span>: &#123;</span><br><span class="line">        <span class="attr">rules</span>: [</span><br><span class="line">            &#123;<span class="attr">test</span>: <span class="regexp">/\.css$/</span>, <span class="attr">use</span>: [<span class="title class_">MiniCssExtractPlugin</span>.<span class="property">loader</span>, <span class="string">&#x27;css-loader&#x27;</span>, <span class="string">&#x27;postcss-loader&#x27;</span>]&#125;,</span><br><span class="line">            &#123;<span class="attr">test</span>: <span class="regexp">/\.less$/</span>, <span class="attr">use</span>: [<span class="title class_">MiniCssExtractPlugin</span>.<span class="property">loader</span>, <span class="string">&#x27;css-loader&#x27;</span>, <span class="string">&#x27;less-loader&#x27;</span>, <span class="string">&#x27;postcss-loader&#x27;</span>]&#125;,</span><br><span class="line">            &#123;<span class="attr">test</span>: <span class="regexp">/\.scss$/</span>, <span class="attr">use</span>: [<span class="title class_">MiniCssExtractPlugin</span>.<span class="property">loader</span>, <span class="string">&#x27;css-loader&#x27;</span>, <span class="string">&#x27;sass-loader&#x27;</span>, <span class="string">&#x27;postcss-loader&#x27;</span>],&#125;,</span><br><span class="line">            <span class="comment">//打包图片的规则配置，只有一个 loader 可以直接写，不用写在 use 里面</span></span><br><span class="line">            &#123;</span><br><span class="line">                <span class="attr">test</span>: <span class="regexp">/\.(jpg|png|gif|jpeg)$/</span>,</span><br><span class="line">                <span class="attr">type</span>: <span class="string">&quot;asset&quot;</span>,</span><br><span class="line">                <span class="comment">//解析</span></span><br><span class="line">                <span class="attr">parser</span>: &#123;</span><br><span class="line">                    <span class="attr">dataUrlCondition</span>: &#123;</span><br><span class="line">                        <span class="attr">maxSize</span>: <span class="number">25</span> * <span class="number">1024</span>, <span class="comment">//   超过25kb不转base64</span></span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;,</span><br><span class="line">                <span class="attr">generator</span>: &#123;</span><br><span class="line">                    <span class="comment">//文件生成路径及规则（超出 maxSize 的会在output标签下的 path下，也就是自己定义的 build 下生成 img/文件名.hash值.图片后缀）</span></span><br><span class="line">                    <span class="attr">filename</span>: <span class="string">&#x27;img/[name].[hash:6][ext]&#x27;</span>,</span><br><span class="line">                &#125;,</span><br><span class="line">            &#125;,</span><br><span class="line">        ]</span><br><span class="line">    &#125;,</span><br><span class="line"></span><br><span class="line">    <span class="attr">plugins</span>: [</span><br><span class="line">        <span class="keyword">new</span> <span class="title function_">htmlWebpackPlugin</span>(&#123;</span><br><span class="line">            <span class="attr">template</span>: <span class="string">&quot;./src/demo/index.html&quot;</span>,</span><br><span class="line">            <span class="attr">filename</span>: <span class="string">&quot;demo.html&quot;</span>,</span><br><span class="line">            <span class="attr">chunks</span>: [<span class="string">&#x27;main&#x27;</span>],</span><br><span class="line">            <span class="attr">minify</span>: &#123;</span><br><span class="line">                <span class="attr">collapseWhitespace</span>: <span class="literal">true</span>,</span><br><span class="line">                <span class="attr">removeComments</span>: <span class="literal">true</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;),</span><br><span class="line">        <span class="keyword">new</span> <span class="title class_">MiniCssExtractPlugin</span>(&#123;</span><br><span class="line">            <span class="attr">filename</span>: <span class="string">&#x27;./css/demo.css&#x27;</span></span><br><span class="line">        &#125;),</span><br><span class="line">        <span class="comment">// 用于压缩 css 的，开发环境下可以先不要压缩，不然格式不太好看</span></span><br><span class="line">        <span class="keyword">new</span> <span class="title class_">OptimizeCssAssetsWebpackPlugin</span>()</span><br><span class="line">    ]</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://automation-manage.oss-cn-shanghai.aliyuncs.com/blog/image-20220215001630007.png" alt="图片资源打包"></p>
<h2 id="html中引入图片"><a href="#html中引入图片" class="headerlink" title="html中引入图片"></a>html中引入图片</h2><h3 id="实现方式-1"><a href="#实现方式-1" class="headerlink" title="实现方式"></a>实现方式</h3><ul>
<li>使用 html-loader 插件实现</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># npm 安装（开发环境）</span></span><br><span class="line">npm i html-loader -i</span><br><span class="line"><span class="comment"># yarn 安装（开发环境）</span></span><br><span class="line">yarn add html-loader -D</span><br></pre></td></tr></table></figure>



<h3 id="webpack-config-js-配置-2"><a href="#webpack-config-js-配置-2" class="headerlink" title="webpack.config.js 配置"></a>webpack.config.js 配置</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//打包图片资源（css html中引入）</span></span><br><span class="line"><span class="keyword">const</span> &#123;resolve&#125; = <span class="built_in">require</span>(<span class="string">&quot;path&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> htmlWebpackPlugin = <span class="built_in">require</span>(<span class="string">&#x27;html-webpack-plugin&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> <span class="title class_">MiniCssExtractPlugin</span> = <span class="built_in">require</span>(<span class="string">&#x27;mini-css-extract-plugin&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> <span class="title class_">OptimizeCssAssetsWebpackPlugin</span> = <span class="built_in">require</span>(<span class="string">&#x27;optimize-css-assets-webpack-plugin&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = &#123;</span><br><span class="line">    <span class="attr">mode</span>: <span class="string">&quot;development&quot;</span>,</span><br><span class="line"></span><br><span class="line">    <span class="attr">entry</span>: <span class="string">&#x27;./src/demo/js/index.js&#x27;</span>,</span><br><span class="line">    <span class="attr">output</span>: &#123;</span><br><span class="line">        <span class="attr">filename</span>: <span class="string">&quot;[name].js&quot;</span>,</span><br><span class="line">        <span class="attr">path</span>: <span class="title function_">resolve</span>(__dirname, <span class="string">&quot;build&quot;</span>)</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">module</span>: &#123;</span><br><span class="line">        <span class="attr">rules</span>: [</span><br><span class="line">            &#123;<span class="attr">test</span>: <span class="regexp">/\.css$/</span>, <span class="attr">use</span>: [<span class="title class_">MiniCssExtractPlugin</span>.<span class="property">loader</span>, <span class="string">&#x27;css-loader&#x27;</span>, <span class="string">&#x27;postcss-loader&#x27;</span>]&#125;,</span><br><span class="line">            &#123;<span class="attr">test</span>: <span class="regexp">/\.less$/</span>, <span class="attr">use</span>: [<span class="title class_">MiniCssExtractPlugin</span>.<span class="property">loader</span>, <span class="string">&#x27;css-loader&#x27;</span>, <span class="string">&#x27;less-loader&#x27;</span>, <span class="string">&#x27;postcss-loader&#x27;</span>]&#125;,</span><br><span class="line">            &#123;<span class="attr">test</span>: <span class="regexp">/\.scss$/</span>, <span class="attr">use</span>: [<span class="title class_">MiniCssExtractPlugin</span>.<span class="property">loader</span>, <span class="string">&#x27;css-loader&#x27;</span>, <span class="string">&#x27;sass-loader&#x27;</span>, <span class="string">&#x27;postcss-loader&#x27;</span>],&#125;,</span><br><span class="line">            <span class="comment">//打包图片的规则配置，只有一个 loader 可以直接写，不用写在 use 里面</span></span><br><span class="line">            &#123;</span><br><span class="line">                <span class="attr">test</span>: <span class="regexp">/\.(jpg|png|gif|jpeg)$/</span>,</span><br><span class="line">                <span class="attr">type</span>: <span class="string">&quot;asset&quot;</span>,</span><br><span class="line">                <span class="comment">//解析</span></span><br><span class="line">                <span class="attr">parser</span>: &#123;</span><br><span class="line">                    <span class="attr">dataUrlCondition</span>: &#123;</span><br><span class="line">                        <span class="comment">//超过25kb不转base64</span></span><br><span class="line">                        <span class="attr">maxSize</span>: <span class="number">25</span> * <span class="number">1024</span>,</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;,</span><br><span class="line">                <span class="attr">generator</span>: &#123;</span><br><span class="line">                    <span class="comment">//文件生成路径及规则（超出 maxSize 的会在output标签下的 path下，也就是自己定义的 build 下生成 img/文件名.hash值.图片后缀）</span></span><br><span class="line">                    <span class="attr">filename</span>: <span class="string">&#x27;img/[name].[hash:6][ext]&#x27;</span>,</span><br><span class="line">                &#125;,</span><br><span class="line">            &#125;,</span><br><span class="line">            &#123;<span class="attr">test</span>: <span class="regexp">/\.html$/</span>,<span class="attr">loader</span>:<span class="string">&#x27;html-loader&#x27;</span>,&#125;   <span class="comment">// html中引入的图片打包</span></span><br><span class="line">        ]</span><br><span class="line">    &#125;,</span><br><span class="line"></span><br><span class="line">    <span class="attr">plugins</span>: [</span><br><span class="line">        <span class="keyword">new</span> <span class="title function_">htmlWebpackPlugin</span>(&#123;</span><br><span class="line">            <span class="attr">template</span>: <span class="string">&quot;./src/demo/index.html&quot;</span>,</span><br><span class="line">            <span class="attr">filename</span>: <span class="string">&quot;demo.html&quot;</span>,</span><br><span class="line">            <span class="attr">chunks</span>: [<span class="string">&#x27;main&#x27;</span>],</span><br><span class="line">            <span class="attr">minify</span>: &#123;</span><br><span class="line">                <span class="attr">collapseWhitespace</span>: <span class="literal">true</span>,</span><br><span class="line">                <span class="attr">removeComments</span>: <span class="literal">true</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;),</span><br><span class="line">        <span class="keyword">new</span> <span class="title class_">MiniCssExtractPlugin</span>(&#123;</span><br><span class="line">            <span class="attr">filename</span>: <span class="string">&#x27;./css/demo.css&#x27;</span></span><br><span class="line">        &#125;),</span><br><span class="line">        <span class="comment">// 用于压缩 css 的，开发环境下可以先不要压缩，不然格式不太好看</span></span><br><span class="line">        <span class="keyword">new</span> <span class="title class_">OptimizeCssAssetsWebpackPlugin</span>()</span><br><span class="line">    ]</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://automation-manage.oss-cn-shanghai.aliyuncs.com/blog/image-20220215223851559.png" alt="html中引入图片"></p>
<h1 id="打包其它资源"><a href="#打包其它资源" class="headerlink" title="打包其它资源"></a>打包其它资源</h1><ul>
<li>不需要优化和压缩处理，直接输出的资源，称为其他资源，如字体</li>
</ul>
<h2 id="字体icon资源打包"><a href="#字体icon资源打包" class="headerlink" title="字体icon资源打包"></a>字体icon资源打包</h2><h3 id="流程"><a href="#流程" class="headerlink" title="流程"></a>流程</h3><ul>
<li>iconfont 图标库下载对应的资源后将【.css .ttf .woff .woff2】文件 copy 至项目下 </li>
<li>入口 js 中引入 iconfont.css <code>require(&#39;../font/iconfont.css&#39;)</code></li>
<li>webpack5 直接使用 <code>asset/resource</code> 模块（无需下载）</li>
<li>webpack 配置 asset&#x2F;resource 规则</li>
</ul>
<h3 id="下载及-copy-字体文件"><a href="#下载及-copy-字体文件" class="headerlink" title="下载及 copy 字体文件"></a>下载及 copy 字体文件</h3><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://automation-manage.oss-cn-shanghai.aliyuncs.com/blog/image-20220215235342867.png" alt="下载字体到项目中"></p>
<h3 id="入口-js-中引入-iconfont"><a href="#入口-js-中引入-iconfont" class="headerlink" title="入口 js 中引入 iconfont"></a>入口 js 中引入 iconfont</h3><ul>
<li>在入口 js 文件中引入 iconfont.css 文件</li>
<li><code>require(&#39;../font/iconfont.css&#39;)</code></li>
</ul>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://automation-manage.oss-cn-shanghai.aliyuncs.com/blog/image-20220215235713437.png" alt="入口文件引入iconfont.css"></p>
<h3 id="webpack-config-js-配置-3"><a href="#webpack-config-js-配置-3" class="headerlink" title="webpack.config.js 配置"></a>webpack.config.js 配置</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//打包字体资源</span></span><br><span class="line"><span class="keyword">const</span> &#123;resolve&#125; = <span class="built_in">require</span>(<span class="string">&quot;path&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> htmlWebpackPlugin = <span class="built_in">require</span>(<span class="string">&#x27;html-webpack-plugin&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> <span class="title class_">MiniCssExtractPlugin</span> = <span class="built_in">require</span>(<span class="string">&#x27;mini-css-extract-plugin&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> <span class="title class_">OptimizeCssAssetsWebpackPlugin</span> = <span class="built_in">require</span>(<span class="string">&#x27;optimize-css-assets-webpack-plugin&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = &#123;</span><br><span class="line">    <span class="attr">mode</span>: <span class="string">&quot;development&quot;</span>,</span><br><span class="line"></span><br><span class="line">    <span class="attr">entry</span>: <span class="string">&#x27;./src/demo/js/index.js&#x27;</span>,</span><br><span class="line">    <span class="attr">output</span>: &#123;</span><br><span class="line">        <span class="attr">filename</span>: <span class="string">&quot;[name].js&quot;</span>,</span><br><span class="line">        <span class="attr">path</span>: <span class="title function_">resolve</span>(__dirname, <span class="string">&quot;build&quot;</span>)</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">module</span>: &#123;</span><br><span class="line">        <span class="attr">rules</span>: [</span><br><span class="line">            &#123;<span class="attr">test</span>: <span class="regexp">/\.css$/</span>, <span class="attr">use</span>: [<span class="title class_">MiniCssExtractPlugin</span>.<span class="property">loader</span>, <span class="string">&#x27;css-loader&#x27;</span>, <span class="string">&#x27;postcss-loader&#x27;</span>]&#125;,</span><br><span class="line">            &#123;<span class="attr">test</span>: <span class="regexp">/\.less$/</span>, <span class="attr">use</span>: [<span class="title class_">MiniCssExtractPlugin</span>.<span class="property">loader</span>, <span class="string">&#x27;css-loader&#x27;</span>, <span class="string">&#x27;less-loader&#x27;</span>, <span class="string">&#x27;postcss-loader&#x27;</span>]&#125;,</span><br><span class="line">            &#123;<span class="attr">test</span>: <span class="regexp">/\.scss$/</span>, <span class="attr">use</span>: [<span class="title class_">MiniCssExtractPlugin</span>.<span class="property">loader</span>, <span class="string">&#x27;css-loader&#x27;</span>, <span class="string">&#x27;sass-loader&#x27;</span>, <span class="string">&#x27;postcss-loader&#x27;</span>],&#125;,</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="attr">test</span>: <span class="regexp">/\.(jpg|png|gif|jpeg)$/</span>,</span><br><span class="line">                <span class="attr">type</span>: <span class="string">&quot;asset&quot;</span>,</span><br><span class="line">                <span class="attr">parser</span>: &#123;</span><br><span class="line">                    <span class="attr">dataUrlCondition</span>: &#123;</span><br><span class="line">                        <span class="attr">maxSize</span>: <span class="number">25</span> * <span class="number">1024</span>,</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;,</span><br><span class="line">                <span class="attr">generator</span>: &#123;</span><br><span class="line">                    <span class="attr">filename</span>: <span class="string">&#x27;img/[name].[hash:6][ext]&#x27;</span>,</span><br><span class="line">                &#125;,</span><br><span class="line">            &#125;,</span><br><span class="line">            &#123;<span class="attr">test</span>: <span class="regexp">/\.html$/</span>,<span class="attr">loader</span>:<span class="string">&#x27;html-loader&#x27;</span>,&#125;,   <span class="comment">// html中引入的图片打包</span></span><br><span class="line">            <span class="comment">//打包字体资源</span></span><br><span class="line">            &#123;</span><br><span class="line">                <span class="attr">test</span>:<span class="regexp">/\.ttf|eot|woff2?$/</span>,</span><br><span class="line">                <span class="attr">type</span>:<span class="string">&quot;asset/resource&quot;</span>,</span><br><span class="line">                <span class="attr">generator</span>:&#123;</span><br><span class="line">                    <span class="attr">filename</span>:<span class="string">&quot;font/[name].[hash:6][ext]&quot;</span></span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">            &#125;,</span><br><span class="line">        ]</span><br><span class="line">    &#125;,</span><br><span class="line"></span><br><span class="line">    <span class="attr">plugins</span>: [</span><br><span class="line">        <span class="keyword">new</span> <span class="title function_">htmlWebpackPlugin</span>(&#123;</span><br><span class="line">            <span class="attr">template</span>: <span class="string">&quot;./src/demo/index.html&quot;</span>,</span><br><span class="line">            <span class="attr">filename</span>: <span class="string">&quot;demo.html&quot;</span>,</span><br><span class="line">            <span class="attr">chunks</span>: [<span class="string">&#x27;main&#x27;</span>],</span><br><span class="line">            <span class="attr">minify</span>: &#123;</span><br><span class="line">                <span class="attr">collapseWhitespace</span>: <span class="literal">true</span>,</span><br><span class="line">                <span class="attr">removeComments</span>: <span class="literal">true</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;),</span><br><span class="line">        <span class="keyword">new</span> <span class="title class_">MiniCssExtractPlugin</span>(&#123;</span><br><span class="line">            <span class="attr">filename</span>: <span class="string">&#x27;./css/demo.css&#x27;</span></span><br><span class="line">        &#125;),</span><br><span class="line">        <span class="keyword">new</span> <span class="title class_">OptimizeCssAssetsWebpackPlugin</span>()</span><br><span class="line">    ]</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://automation-manage.oss-cn-shanghai.aliyuncs.com/blog/image-20220216000635948.png" alt="打包字体效果"></p>
<h1 id="eslint"><a href="#eslint" class="headerlink" title="eslint"></a>eslint</h1><h2 id="简介-2"><a href="#简介-2" class="headerlink" title="简介"></a>简介</h2><ul>
<li>eslint 是一个开源的<code> js 代码检查工具</code>，初衷是为了让程序员可以创建自己的检测规则。实际生产中，团队内往往会制订一套统一的标准，让整个团队的编码风格达到一致</li>
<li>eslint 其实与 webpack 没有任何关系，两者并不互相依赖，甚至一般情况下我们并不会在 webpack 中进行 eslint 的配置，可以单独使用。</li>
<li>语法检查使用eslint-loader， 并基于eslint包，<code>只用来检查js语法</code>。（eslint-loader –&gt; eslint-webpack-plugin ）</li>
<li>注意只检查自己写的js源代码， 第三方库是不用检查的， 可以在npmjs.com中查看规则。</li>
<li>需要使用js来的规则库来检查代码 “airbnb”， 需要eslint-config-airbnb-base和eslint-plugin-import 两个包</li>
<li></li>
<li>eslin进行检查需要依赖eslint-loader，同时告诉它用什么标准去检查 常用的就是 <code>airbnb</code> airbnb 又依赖 eslint-config-airbnb-base和eslint-plugin-import 两个包</li>
</ul>
<h2 id="安装插件包"><a href="#安装插件包" class="headerlink" title="安装插件包"></a>安装插件包</h2><ul>
<li><p>有很多视频在使用 eslint-loader 我在 webpack5.68.0 使用时会有如下报错，网上说 eslint-loader 已经弃用了 采用 eslint-webpack-plugin 插件</p>
<p>Module build failed (from .&#x2F;node_modules&#x2F;eslint-loader&#x2F;dist&#x2F;cjs.js):</p>
<p>TypeError: Cannot read properties of undefined (reading ‘getFormatter’)</p>
</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># npm 安装（开发环境）</span></span><br><span class="line">npm i eslint eslint-config-airbnb-base eslint-plugin-import eslint-webpack-plugin -D</span><br><span class="line"><span class="comment"># yarn 安装（开发环境）</span></span><br><span class="line">yarn add  eslint eslint-config-airbnb-base eslint-plugin-import eslint-webpack-plugin -D</span><br></pre></td></tr></table></figure>

<ul>
<li>如果在安装的插件的时候有提示 Expected version “^12.22.0 || ^14.17.0 || &gt;&#x3D;16.0.0” ，需要更换 node 版本</li>
<li>我是在 node 官网下载最近的一个稳定版本重新安装的就可以了  v16.14.0</li>
</ul>
<h2 id="配置文件-1"><a href="#配置文件-1" class="headerlink" title="配置文件"></a>配置文件</h2><ul>
<li>const ESLintPlugin &#x3D; require(‘eslint-webpack-plugin’);  <code>引入插件</code></li>
<li>new ESLintPlugin({fix: true })  <code>使用插件，自动修复不合理写法，规则会根据 package.json 中的 eslintConfig 下 extends 对应的属性去检查</code></li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// eslint 语法规范检查</span></span><br><span class="line"><span class="keyword">const</span> &#123;resolve&#125; = <span class="built_in">require</span>(<span class="string">&quot;path&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> htmlWebpackPlugin = <span class="built_in">require</span>(<span class="string">&#x27;html-webpack-plugin&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> <span class="title class_">MiniCssExtractPlugin</span> = <span class="built_in">require</span>(<span class="string">&#x27;mini-css-extract-plugin&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> <span class="title class_">OptimizeCssAssetsWebpackPlugin</span> = <span class="built_in">require</span>(<span class="string">&#x27;optimize-css-assets-webpack-plugin&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> <span class="title class_">ESLintPlugin</span> = <span class="built_in">require</span>(<span class="string">&#x27;eslint-webpack-plugin&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = &#123;</span><br><span class="line">    <span class="attr">mode</span>: <span class="string">&quot;development&quot;</span>,</span><br><span class="line"></span><br><span class="line">    <span class="attr">entry</span>: <span class="string">&#x27;./src/demo/js/index.js&#x27;</span>,</span><br><span class="line">    <span class="attr">output</span>: &#123;</span><br><span class="line">        <span class="attr">filename</span>: <span class="string">&quot;[name].js&quot;</span>,</span><br><span class="line">        <span class="attr">path</span>: <span class="title function_">resolve</span>(__dirname, <span class="string">&quot;build&quot;</span>)</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">module</span>: &#123;</span><br><span class="line">        <span class="attr">rules</span>: [</span><br><span class="line">            &#123;<span class="attr">test</span>: <span class="regexp">/\.css$/</span>, <span class="attr">use</span>: [<span class="title class_">MiniCssExtractPlugin</span>.<span class="property">loader</span>, <span class="string">&#x27;css-loader&#x27;</span>, <span class="string">&#x27;postcss-loader&#x27;</span>]&#125;,</span><br><span class="line">            &#123;<span class="attr">test</span>: <span class="regexp">/\.less$/</span>, <span class="attr">use</span>: [<span class="title class_">MiniCssExtractPlugin</span>.<span class="property">loader</span>, <span class="string">&#x27;css-loader&#x27;</span>, <span class="string">&#x27;less-loader&#x27;</span>, <span class="string">&#x27;postcss-loader&#x27;</span>]&#125;,</span><br><span class="line">            &#123;<span class="attr">test</span>: <span class="regexp">/\.scss$/</span>, <span class="attr">use</span>: [<span class="title class_">MiniCssExtractPlugin</span>.<span class="property">loader</span>, <span class="string">&#x27;css-loader&#x27;</span>, <span class="string">&#x27;sass-loader&#x27;</span>, <span class="string">&#x27;postcss-loader&#x27;</span>],&#125;,</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="attr">test</span>: <span class="regexp">/\.(jpg|png|gif|jpeg)$/</span>,</span><br><span class="line">                <span class="attr">type</span>: <span class="string">&quot;asset&quot;</span>,</span><br><span class="line">                <span class="attr">parser</span>: &#123;</span><br><span class="line">                    <span class="attr">dataUrlCondition</span>: &#123;</span><br><span class="line">                        <span class="attr">maxSize</span>: <span class="number">25</span> * <span class="number">1024</span>,</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;,</span><br><span class="line">                <span class="attr">generator</span>: &#123;</span><br><span class="line">                    <span class="attr">filename</span>: <span class="string">&#x27;img/[name].[hash:6][ext]&#x27;</span>,</span><br><span class="line">                &#125;,</span><br><span class="line">            &#125;,</span><br><span class="line">            &#123;<span class="attr">test</span>: <span class="regexp">/\.html$/</span>, <span class="attr">loader</span>: <span class="string">&#x27;html-loader&#x27;</span>,&#125;,   <span class="comment">// html中引入的图片打包</span></span><br><span class="line">            <span class="comment">//打包字体资源</span></span><br><span class="line">            &#123;</span><br><span class="line">                <span class="attr">test</span>: <span class="regexp">/\.ttf|eot|woff2?$/</span>,</span><br><span class="line">                <span class="attr">type</span>: <span class="string">&quot;asset/resource&quot;</span>,</span><br><span class="line">                <span class="attr">generator</span>: &#123;</span><br><span class="line">                    <span class="attr">filename</span>: <span class="string">&quot;font/[name].[hash:6][ext]&quot;</span></span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">            &#125;</span><br><span class="line">        ]</span><br><span class="line">    &#125;,</span><br><span class="line"></span><br><span class="line">    <span class="attr">plugins</span>: [</span><br><span class="line">        <span class="keyword">new</span> <span class="title function_">htmlWebpackPlugin</span>(&#123;</span><br><span class="line">            <span class="attr">template</span>: <span class="string">&quot;./src/demo/index.html&quot;</span>,</span><br><span class="line">            <span class="attr">filename</span>: <span class="string">&quot;demo.html&quot;</span>,</span><br><span class="line">            <span class="attr">chunks</span>: [<span class="string">&#x27;main&#x27;</span>],</span><br><span class="line">            <span class="attr">minify</span>: &#123;</span><br><span class="line">                <span class="attr">collapseWhitespace</span>: <span class="literal">true</span>,</span><br><span class="line">                <span class="attr">removeComments</span>: <span class="literal">true</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;),</span><br><span class="line">        <span class="keyword">new</span> <span class="title class_">MiniCssExtractPlugin</span>(&#123;</span><br><span class="line">            <span class="attr">filename</span>: <span class="string">&#x27;./css/demo.css&#x27;</span></span><br><span class="line">        &#125;),</span><br><span class="line">        <span class="keyword">new</span> <span class="title class_">OptimizeCssAssetsWebpackPlugin</span>(),</span><br><span class="line">        <span class="comment">//js语法检查</span></span><br><span class="line">        <span class="keyword">new</span> <span class="title class_">ESLintPlugin</span>(&#123;</span><br><span class="line">            <span class="attr">fix</span>: <span class="literal">true</span> <span class="comment">// 自动修复不合理的写法</span></span><br><span class="line">        &#125;)</span><br><span class="line">    ]</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>







<ul>
<li>“scripts”: { “eslint”: “eslint src” }  在控制台可通过执行 <code>npm run eslint</code> 或者 <code>yarn eslint</code> 会去检查 src目录下的 js 规范</li>
<li>“eslintConfig”: { “extends”: “airbnb-base” }  定义的检查规范为 <code>airbnb-base</code></li>
</ul>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;scripts&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;eslint&quot;</span><span class="punctuation">:</span> <span class="string">&quot;eslint src&quot;</span></span><br><span class="line">  <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;devDependencies&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;css-loader&quot;</span><span class="punctuation">:</span> <span class="string">&quot;^6.6.0&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;eslint&quot;</span><span class="punctuation">:</span> <span class="string">&quot;^8.9.0&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;eslint-config-airbnb-base&quot;</span><span class="punctuation">:</span> <span class="string">&quot;^15.0.0&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;eslint-plugin-import&quot;</span><span class="punctuation">:</span> <span class="string">&quot;^2.25.4&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;eslint-webpack-plugin&quot;</span><span class="punctuation">:</span> <span class="string">&quot;^3.1.1&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;html-loader&quot;</span><span class="punctuation">:</span> <span class="string">&quot;^3.1.0&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;html-webpack-plugin&quot;</span><span class="punctuation">:</span> <span class="string">&quot;^5.5.0&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;less&quot;</span><span class="punctuation">:</span> <span class="string">&quot;^4.1.2&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;less-loader&quot;</span><span class="punctuation">:</span> <span class="string">&quot;^10.2.0&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;mini-css-extract-plugin&quot;</span><span class="punctuation">:</span> <span class="string">&quot;^2.5.3&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;node-sass&quot;</span><span class="punctuation">:</span> <span class="string">&quot;^7.0.1&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;optimize-css-assets-webpack-plugin&quot;</span><span class="punctuation">:</span> <span class="string">&quot;^6.0.1&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;postcss-loader&quot;</span><span class="punctuation">:</span> <span class="string">&quot;^6.2.1&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;postcss-preset-env&quot;</span><span class="punctuation">:</span> <span class="string">&quot;^7.3.3&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;sass-loader&quot;</span><span class="punctuation">:</span> <span class="string">&quot;^12.4.0&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;style-loader&quot;</span><span class="punctuation">:</span> <span class="string">&quot;^3.3.1&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;webpack&quot;</span><span class="punctuation">:</span> <span class="string">&quot;^5.68.0&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;webpack-cli&quot;</span><span class="punctuation">:</span> <span class="string">&quot;^4.9.2&quot;</span></span><br><span class="line">  <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;dependencies&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;jquery&quot;</span><span class="punctuation">:</span> <span class="string">&quot;^3.6.0&quot;</span></span><br><span class="line">  <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;browserslistcomment&quot;</span><span class="punctuation">:</span> <span class="string">&quot;支持80%以上的浏览器,支持最后两个版本,忽略已经死掉的浏览器&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;browserslist&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">    <span class="string">&quot;&gt; 0.2%&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="string">&quot;last 2 version&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="string">&quot;not dead&quot;</span></span><br><span class="line">  <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;eslintConfig&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;extends&quot;</span><span class="punctuation">:</span> <span class="string">&quot;airbnb-base&quot;</span></span><br><span class="line">  <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>



<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://automation-manage.oss-cn-shanghai.aliyuncs.com/blog/image-20220217233417839.png" alt="eslint检查"></p>
<h2 id="特殊配置"><a href="#特殊配置" class="headerlink" title="特殊配置"></a>特殊配置</h2><ul>
<li>有的时候想针对某行代码跳过检查只需要在该行代码上添加 <code>// eslint-disable-next-line</code> 即可跳过对下一行的检查（只针对下一行有效）</li>
</ul>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://automation-manage.oss-cn-shanghai.aliyuncs.com/blog/image-20220217234825819.png" alt="跳过语法检查"></p>
<h1 id="热部署"><a href="#热部署" class="headerlink" title="热部署"></a>热部署</h1><h2 id="简介-3"><a href="#简介-3" class="headerlink" title="简介"></a>简介</h2><ul>
<li>在前面的章节中，我们每次写完程序或者修改了内容后都需要通过 webpack 进行打包到 build 目录，这种情况一般是用在生产环境，开发完了打包测试上线，在实际的工作中我们更加希望我们每次修改完代码后就能够自动刷新对应的 html css js 等内容便于我们实时的查看调试，这也就本次记录的内容热部署</li>
<li>devServer给我们提供了开发过程中的服务器，是一个使用了express的Http服务器，它的作用主要是为了监听资源文件的改变，该http服务器和client使用了websocket通信协议，只要资源文件发生改变，webpack-dev-server就会实时的进行编译。</li>
<li>只会在内存中编译，不会有任何输出,下载webpack-dev-server包</li>
<li>webpack-dev-server并不能读取你的webpack.config.js的配置output <code>也就是说每次修改了配置文件需要手动重启一下，修改其它的 html css js 会自动刷新</code></li>
<li>启动devServer指令为: npx webpack serve 本目录执行</li>
<li>webpack5无法自动刷新，解决：添加配置：target: ‘web’</li>
</ul>
<h2 id="流程-1"><a href="#流程-1" class="headerlink" title="流程"></a>流程</h2><ul>
<li>下载 webpack-dev-server 包</li>
<li>webpackage.config.js 下新增 <code>devServer</code> 属性用于指定端口等信息</li>
<li>package.json 中指定启动命令</li>
</ul>
<h2 id="示例"><a href="#示例" class="headerlink" title="示例"></a>示例</h2><h3 id="下载包"><a href="#下载包" class="headerlink" title="下载包"></a>下载包</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># npm 安装（开发环境）</span></span><br><span class="line">npm i webpack-dev-server -D </span><br><span class="line"><span class="comment"># yarn 安装（开发环境）</span></span><br><span class="line">yarn add webpack-dev-server -D</span><br></pre></td></tr></table></figure>

<h3 id="webpack-config-js-配置-4"><a href="#webpack-config-js-配置-4" class="headerlink" title="webpack.config.js 配置"></a>webpack.config.js 配置</h3><ul>
<li>每次配置文件 webpack.config.js 发生了变化需要重启 devServer 服务器（因为配置文件是在启动时生效，发生改变不能修改启动时的参数设置这些）</li>
<li>注释了 eslint 检查（开发环境不方便）</li>
<li>去除了 <code>mode: &quot;development&quot;</code> 更改为在启动命令 <code>scripts</code> 中指定</li>
<li>新增 <code>target</code> <code>devServer</code> </li>
<li>htmlWebpackPlugin  filename 需要指定为 index.html 不然会报错 404（应该是热部署启动后默认去读取 index.html 文件）</li>
<li>如果自动刷新无效的话注意一般是开启了HMR(devServer中 hot:true) 看 entry属性下有没有配置需要监听的html（entry: [‘.&#x2F;src&#x2F;demo&#x2F;js&#x2F;index.js’,’.&#x2F;src&#x2F;demo&#x2F;index.html’]） 这里的<code>./src/demo/index.html</code> 就是需要自动刷新的页面</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 热部署 htmlWebpackPlugin  filename 需要指定为 index.html 不然会报错 404</span></span><br><span class="line"><span class="keyword">const</span> &#123;resolve&#125; = <span class="built_in">require</span>(<span class="string">&quot;path&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> htmlWebpackPlugin = <span class="built_in">require</span>(<span class="string">&#x27;html-webpack-plugin&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> <span class="title class_">MiniCssExtractPlugin</span> = <span class="built_in">require</span>(<span class="string">&#x27;mini-css-extract-plugin&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> <span class="title class_">OptimizeCssAssetsWebpackPlugin</span> = <span class="built_in">require</span>(<span class="string">&#x27;optimize-css-assets-webpack-plugin&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> <span class="title class_">ESLintPlugin</span> = <span class="built_in">require</span>(<span class="string">&#x27;eslint-webpack-plugin&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = &#123;</span><br><span class="line"></span><br><span class="line">    <span class="attr">entry</span>: [<span class="string">&#x27;./src/demo/js/index.js&#x27;</span>,<span class="string">&#x27;./src/demo/index.html&#x27;</span>],</span><br><span class="line">    <span class="attr">output</span>: &#123;</span><br><span class="line">        <span class="attr">filename</span>: <span class="string">&quot;[name].js&quot;</span>,</span><br><span class="line">        <span class="attr">path</span>: <span class="title function_">resolve</span>(__dirname, <span class="string">&quot;./build&quot;</span>)</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">module</span>: &#123;</span><br><span class="line">        <span class="attr">rules</span>: [</span><br><span class="line">            &#123;<span class="attr">test</span>: <span class="regexp">/\.css$/</span>, <span class="attr">use</span>: [<span class="title class_">MiniCssExtractPlugin</span>.<span class="property">loader</span>, <span class="string">&#x27;css-loader&#x27;</span>, <span class="string">&#x27;postcss-loader&#x27;</span>]&#125;,</span><br><span class="line">            &#123;<span class="attr">test</span>: <span class="regexp">/\.less$/</span>, <span class="attr">use</span>: [<span class="title class_">MiniCssExtractPlugin</span>.<span class="property">loader</span>, <span class="string">&#x27;css-loader&#x27;</span>, <span class="string">&#x27;less-loader&#x27;</span>, <span class="string">&#x27;postcss-loader&#x27;</span>]&#125;,</span><br><span class="line">            &#123;<span class="attr">test</span>: <span class="regexp">/\.scss$/</span>, <span class="attr">use</span>: [<span class="title class_">MiniCssExtractPlugin</span>.<span class="property">loader</span>, <span class="string">&#x27;css-loader&#x27;</span>, <span class="string">&#x27;sass-loader&#x27;</span>, <span class="string">&#x27;postcss-loader&#x27;</span>],&#125;,</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="attr">test</span>: <span class="regexp">/\.(jpg|png|gif|jpeg)$/</span>,</span><br><span class="line">                <span class="attr">type</span>: <span class="string">&quot;asset&quot;</span>,</span><br><span class="line">                <span class="attr">parser</span>: &#123;</span><br><span class="line">                    <span class="attr">dataUrlCondition</span>: &#123;</span><br><span class="line">                        <span class="attr">maxSize</span>: <span class="number">25</span> * <span class="number">1024</span>,</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;,</span><br><span class="line">                <span class="attr">generator</span>: &#123;</span><br><span class="line">                    <span class="attr">filename</span>: <span class="string">&#x27;img/[name].[hash:6][ext]&#x27;</span>,</span><br><span class="line">                &#125;,</span><br><span class="line">            &#125;,</span><br><span class="line">            &#123;<span class="attr">test</span>: <span class="regexp">/\.html$/</span>, <span class="attr">loader</span>: <span class="string">&#x27;html-loader&#x27;</span>,&#125;,   <span class="comment">// html中引入的图片打包</span></span><br><span class="line">            <span class="comment">//打包字体资源</span></span><br><span class="line">            &#123;</span><br><span class="line">                <span class="attr">test</span>: <span class="regexp">/\.ttf|eot|woff2?$/</span>,</span><br><span class="line">                <span class="attr">type</span>: <span class="string">&quot;asset/resource&quot;</span>,</span><br><span class="line">                <span class="attr">generator</span>: &#123;</span><br><span class="line">                    <span class="attr">filename</span>: <span class="string">&quot;font/[name].[hash:6][ext]&quot;</span></span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">            &#125;</span><br><span class="line">        ]</span><br><span class="line">    &#125;,</span><br><span class="line"></span><br><span class="line">    <span class="attr">plugins</span>: [</span><br><span class="line">        <span class="keyword">new</span> <span class="title function_">htmlWebpackPlugin</span>(&#123;</span><br><span class="line">            <span class="attr">template</span>: <span class="string">&quot;./src/demo/index.html&quot;</span>,</span><br><span class="line">            <span class="attr">filename</span>: <span class="string">&quot;index.html&quot;</span>,</span><br><span class="line">            <span class="attr">chunks</span>: [<span class="string">&#x27;main&#x27;</span>],</span><br><span class="line">            <span class="attr">minify</span>: &#123;</span><br><span class="line">                <span class="attr">collapseWhitespace</span>: <span class="literal">true</span>,</span><br><span class="line">                <span class="attr">removeComments</span>: <span class="literal">true</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;),</span><br><span class="line">        <span class="keyword">new</span> <span class="title class_">MiniCssExtractPlugin</span>(&#123;</span><br><span class="line">            <span class="attr">filename</span>: <span class="string">&#x27;./css/demo.css&#x27;</span></span><br><span class="line">        &#125;),</span><br><span class="line">        <span class="keyword">new</span> <span class="title class_">OptimizeCssAssetsWebpackPlugin</span>(),</span><br><span class="line">        <span class="comment">//js语法检查</span></span><br><span class="line">        <span class="comment">/*new ESLintPlugin(&#123;</span></span><br><span class="line"><span class="comment">            fix: true // 自动修复不合理的写法</span></span><br><span class="line"><span class="comment">        &#125;)*/</span></span><br><span class="line">    ],</span><br><span class="line">    <span class="comment">// 在webpack5 需要加上这个配置项才可以自动刷新，如果自动刷新无效的话注意一般是开启了HMR(devServer中 hot:true) 看 entry属性下有没有配置需要监听的html</span></span><br><span class="line">    <span class="attr">target</span>: <span class="string">&quot;web&quot;</span>,</span><br><span class="line">    <span class="attr">devServer</span>: &#123;</span><br><span class="line">        <span class="attr">port</span>:<span class="number">3001</span>,</span><br><span class="line">        <span class="attr">compress</span>:<span class="literal">true</span>,</span><br><span class="line">        <span class="attr">open</span>:<span class="literal">true</span>,</span><br><span class="line">        <span class="attr">hot</span>:<span class="literal">true</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<ul>
<li>content-base &#x2F;&#x2F;设定webpack-dev-server的director根目录。如果不进行设定的话，默认是在当前目录下。</li>
<li>quiet: &#x2F;&#x2F;控制台中不输出打包的信息，开发中一般设置为false，进行 打印，这样查看错误比较方面</li>
<li>no-info: &#x2F;&#x2F; 不显示任何信息</li>
<li>colors: &#x2F;&#x2F;对信息进行颜色输出</li>
<li>no-colors: &#x2F;&#x2F;对信息不进行颜色输出</li>
<li>compress:  &#x2F;&#x2F;开启gzip压缩</li>
<li>host &lt;hostname&#x2F;ip&gt;: &#x2F;&#x2F;设置ip</li>
<li>port <number>: &#x2F;&#x2F;设置端口号，默认是:8080</li>
<li>inline: &#x2F;&#x2F;webpack-dev-server会在你的webpack.config.js的入口配置文件中再添加一个入口,</li>
<li>hot: &#x2F;&#x2F;开发热替换</li>
<li>open: &#x2F;&#x2F;启动命令，自动打开浏览器</li>
<li>history-api-fallback: &#x2F;&#x2F;查看历史url</li>
</ul>
<h3 id="package-json"><a href="#package-json" class="headerlink" title="package.json"></a>package.json</h3><ul>
<li><code>scripts</code>下新增 <code>dev</code> <code>build</code> 通过命令指定开发模式启动或者打包，并且携带参数指定 mode 这样就不需要在 webpack.config.js 中指定 mode</li>
<li>命令行中的比配置文件中参数的优先级高</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="string">&quot;scripts&quot;</span>: &#123;</span><br><span class="line">    <span class="string">&quot;eslint&quot;</span>: <span class="string">&quot;eslint src&quot;</span>,</span><br><span class="line">    <span class="string">&quot;dev&quot;</span>: <span class="string">&quot;webpack serve --mode development&quot;</span>,</span><br><span class="line">    <span class="string">&quot;build&quot;</span>: <span class="string">&quot;webpack --mode production&quot;</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="string">&quot;devDependencies&quot;</span>: &#123;</span><br><span class="line">    <span class="string">&quot;css-loader&quot;</span>: <span class="string">&quot;^6.6.0&quot;</span>,</span><br><span class="line">    <span class="string">&quot;eslint&quot;</span>: <span class="string">&quot;^8.9.0&quot;</span>,</span><br><span class="line">    <span class="string">&quot;eslint-config-airbnb-base&quot;</span>: <span class="string">&quot;^15.0.0&quot;</span>,</span><br><span class="line">    <span class="string">&quot;eslint-plugin-import&quot;</span>: <span class="string">&quot;^2.25.4&quot;</span>,</span><br><span class="line">    <span class="string">&quot;eslint-webpack-plugin&quot;</span>: <span class="string">&quot;^3.1.1&quot;</span>,</span><br><span class="line">    <span class="string">&quot;html-loader&quot;</span>: <span class="string">&quot;^3.1.0&quot;</span>,</span><br><span class="line">    <span class="string">&quot;html-webpack-plugin&quot;</span>: <span class="string">&quot;^5.5.0&quot;</span>,</span><br><span class="line">    <span class="string">&quot;less&quot;</span>: <span class="string">&quot;^4.1.2&quot;</span>,</span><br><span class="line">    <span class="string">&quot;less-loader&quot;</span>: <span class="string">&quot;^10.2.0&quot;</span>,</span><br><span class="line">    <span class="string">&quot;mini-css-extract-plugin&quot;</span>: <span class="string">&quot;^2.5.3&quot;</span>,</span><br><span class="line">    <span class="string">&quot;node-sass&quot;</span>: <span class="string">&quot;^7.0.1&quot;</span>,</span><br><span class="line">    <span class="string">&quot;optimize-css-assets-webpack-plugin&quot;</span>: <span class="string">&quot;^6.0.1&quot;</span>,</span><br><span class="line">    <span class="string">&quot;postcss-loader&quot;</span>: <span class="string">&quot;^6.2.1&quot;</span>,</span><br><span class="line">    <span class="string">&quot;postcss-preset-env&quot;</span>: <span class="string">&quot;^7.3.3&quot;</span>,</span><br><span class="line">    <span class="string">&quot;sass-loader&quot;</span>: <span class="string">&quot;^12.4.0&quot;</span>,</span><br><span class="line">    <span class="string">&quot;style-loader&quot;</span>: <span class="string">&quot;^3.3.1&quot;</span>,</span><br><span class="line">    <span class="string">&quot;webpack&quot;</span>: <span class="string">&quot;^5.68.0&quot;</span>,</span><br><span class="line">    <span class="string">&quot;webpack-cli&quot;</span>: <span class="string">&quot;^4.9.2&quot;</span>,</span><br><span class="line">    <span class="string">&quot;webpack-dev-server&quot;</span>: <span class="string">&quot;^4.7.4&quot;</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="string">&quot;dependencies&quot;</span>: &#123;</span><br><span class="line">    <span class="string">&quot;jquery&quot;</span>: <span class="string">&quot;^3.6.0&quot;</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="string">&quot;browserslistcomment&quot;</span>: <span class="string">&quot;支持80%以上的浏览器,支持最后两个版本,忽略已经死掉的浏览器&quot;</span>,</span><br><span class="line">  <span class="string">&quot;browserslist&quot;</span>: [</span><br><span class="line">    <span class="string">&quot;&gt; 0.2%&quot;</span>,</span><br><span class="line">    <span class="string">&quot;last 2 versions&quot;</span>,</span><br><span class="line">    <span class="string">&quot;not dead&quot;</span></span><br><span class="line">  ],</span><br><span class="line">  <span class="string">&quot;eslintConfig&quot;</span>: &#123;</span><br><span class="line">    <span class="string">&quot;extends&quot;</span>: <span class="string">&quot;airbnb-base&quot;</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h1 id="环境优化"><a href="#环境优化" class="headerlink" title="环境优化"></a>环境优化</h1><ul>
<li>开发环境的优化：打包构建速度（比如我们只更新了一个js文件重新编译的时候只编译这一个 js 文件，热加载）、优化代码调式</li>
<li>生产环境的优化：代码运行的性能（例如尽量减小代码文件的大小，只打包引用到了的 css  js ）</li>
</ul>
<h2 id="开发环境HMR-模块热替换"><a href="#开发环境HMR-模块热替换" class="headerlink" title="开发环境HMR(模块热替换)"></a>开发环境HMR(模块热替换)</h2><ul>
<li><code>热模块替换一般是针对开发环境的优化</code></li>
<li>模块热替换(Hot Module Replacement 即 HMR)是 webpack 提供的最有用的功能之一, 它允许在运行时更新各种模块, 而<code>无需进行完全刷新</code>。</li>
<li>启用这个功能，只需要修改一下 webpack.config.js 的配置, 使用 webpack 内置的 HMR 插件就可以了， <code>在devServer中使用hot参数（hot:true）</code>。</li>
<li>启用 webpack 内置的 HMR插件后, module.hot 接口就会暴露在 index.js 中, 接下来需要在 index.js 中配置告诉 webpack 接受HMR的模块。</li>
</ul>
<h3 id="样式文件"><a href="#样式文件" class="headerlink" title="样式文件"></a>样式文件</h3><ul>
<li>样式文件(css less sass)在使用HMR功能的时候，开发环境中使用<code>style-loader</code>（之前使用的 <code>MiniCssExtractPlugin.loader</code> 把所有 css less sass 打包成一个单独的文件，这样 HMR 就没有意义了因为更新了这个所有打包一起的文件比较大，开发环境使用 style-loader 就不会打包成单独的文件，这样就能做到只更新这一个样式文件 ）</li>
<li>这里我没去实践，一般是会根据配置什么的去设置比如开发环境用 style-loader 线上用 MiniCssExtractPlugin.loader 打包成一个 css 文件</li>
</ul>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://automation-manage.oss-cn-shanghai.aliyuncs.com/blog/image-20220223225504907.png" alt="HMR-css"></p>
<h3 id="html"><a href="#html" class="headerlink" title="html"></a>html</h3><ul>
<li>HTML 的HMR功能，默认也没有HMR功能（不用做HMR功能）需要在entry入口中引入html文件(entry:[‘.&#x2F;src&#x2F;demo&#x2F;js&#x2F;index.js’,’.&#x2F;src&#x2F;demo&#x2F;index.html’])</li>
</ul>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://automation-manage.oss-cn-shanghai.aliyuncs.com/blog/image-20220223230008336.png" alt="HMR-html"></p>
<h3 id="js"><a href="#js" class="headerlink" title="js"></a>js</h3><ul>
<li>js的HMR功能，默认没有HMR功能，只能处理非入口文件的js文件</li>
<li>启用 webpack 内置的 HMR插件后, module.hot 接口就会暴露在 index.js 中, 接下来需要在 index.js 中配置告诉 webpack 接受HMR的模块（通过代码 <code>module.hot.accept</code>）</li>
</ul>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://automation-manage.oss-cn-shanghai.aliyuncs.com/blog/image-20220223225008642.png" alt="HMR-js配置前"></p>
<ul>
<li>如上图所示当一个 js 文件发生变化时，所有的 js 都会去执行，如果想要去实现只更新我们自己修改了的 js 文件需要在入口文件中通过代码指定文件示例如下</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (<span class="variable language_">module</span>.<span class="property">hot</span>) &#123;</span><br><span class="line">    <span class="comment">//告诉 webpack 接受热替换的模块为 ./print.js</span></span><br><span class="line">    <span class="variable language_">module</span>.<span class="property">hot</span>.<span class="title function_">accept</span>(<span class="string">&#x27;./print.js&#x27;</span>, <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">      <span class="comment">//服务器检测到了 print.js 的代码变化后需要执行的 module.hot.accept 的回调函数</span></span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;./print.js 这个文件有发生变化&#x27;</span>);</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li><p>修改 print.js 中将 【111】改为 【33333】 后并未执行 index.js 中的打印语句（打包 css样式的 js 文件这句话），只执行了module.hot.accept的回调函数</p>
</li>
<li><p>修改 print.js后并未再次打印这句话，也就证明热加载只加载了 print.js</p>
</li>
<li><p>HMR 中只监听了 print.js</p>
</li>
<li><p>服务器检测到了 print.js 的代码变化后需要执行的 module.hot.accept 的回调函数</p>
</li>
</ul>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://automation-manage.oss-cn-shanghai.aliyuncs.com/blog/image-20220223232055475.png" alt="HMR-js配置后"></p>
<h2 id="线上环境-去除死代码"><a href="#线上环境-去除死代码" class="headerlink" title="线上环境(去除死代码)"></a>线上环境(去除死代码)</h2><ul>
<li><code>该内容是针对线上环境</code> 且指的是 js css 这类文件</li>
<li>html文件 不需要，因为如果不需要的 html 我们会注释掉，然后打包的时候会去压缩注释掉的内容，但是 js css 这些可能会留着暂时不注释，可能以后会用，那么我们就期望打包的时候 没有引用的 js css 这些东西不打包进去（比如去网上 copy 了一个一万行的js 但是我们只用了其中的一部分，但是又不敢乱删除，以前的方法就会把所有的一万行打包进去，优化了的话它自动就会去找到这一万行代码中我们使用到的 js 打包进去）</li>
<li>或者说引入的第三方的BootStrap jQuery 我们也期望只把我们项目使用到的js css 打包进去多余的就不要</li>
</ul>
<h3 id="js-1"><a href="#js-1" class="headerlink" title="js"></a>js</h3><ul>
<li>Webpack通过 tree-shaking 去掉了实际上并没有使用的js代码来减少包的大小</li>
<li>tree-shaking 是 webpack 自带的功能不需要下载其它的包（tree-shaking:树摇，摇晃树子把黄了的叶子摇下来不要）</li>
<li>前提条件：<code>必须使用es6模块化</code>  <code>开启production环境（mode中指定）</code></li>
</ul>
<h3 id="css"><a href="#css" class="headerlink" title="css"></a>css</h3><h4 id="下载插件-2"><a href="#下载插件-2" class="headerlink" title="下载插件"></a>下载插件</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># npm 安装（开发环境）</span></span><br><span class="line">npm i purgecss-webpack-plugin -D</span><br><span class="line"><span class="comment"># yarn 安装（开发环境）</span></span><br><span class="line">yarn add purgecss-webpack-plugin -D</span><br></pre></td></tr></table></figure>

<h4 id="webpack-config-js-配置-5"><a href="#webpack-config-js-配置-5" class="headerlink" title="webpack.config.js 配置"></a>webpack.config.js 配置</h4><ul>
<li>plugins下新增以下内容 四个引入 const 一个 new</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//const &#123;resolve, join&#125; = require(&#x27;path&#x27;);</span></span><br><span class="line"><span class="comment">//const PurgecssPlugin = require(&#x27;purgecss-webpack-plugin&#x27;);</span></span><br><span class="line"><span class="comment">//const glob = require(&#x27;glob&#x27;);</span></span><br><span class="line"><span class="comment">//const PATHS = &#123; src: join(__dirname, &#x27;src&#x27;)&#125;</span></span><br><span class="line"><span class="keyword">new</span> <span class="title class_">PurgecssPlugin</span>(&#123;</span><br><span class="line">            <span class="attr">paths</span>: glob.<span class="title function_">sync</span>(<span class="string">`<span class="subst">$&#123;PATHS.src&#125;</span>/**/*`</span>, &#123;<span class="attr">nodir</span>: <span class="literal">true</span>&#125;),</span><br><span class="line">        &#125;),</span><br></pre></td></tr></table></figure>



</article><div class="post-copyright"><div class="copyright-cc-box"><i class="anzhiyufont anzhiyu-icon-copyright"></i></div><div class="post-copyright__author_box"><a class="post-copyright__author_img" href="/" title="头像"><img class="post-copyright__author_img_back" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://image.3001.net/images/20210606/16229390604952.png" title="头像" alt="头像"><img class="post-copyright__author_img_front" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://image.3001.net/images/20210606/16229390604952.png" title="头像" alt="头像"></a><div class="post-copyright__author_name">Ada</div><div class="post-copyright__author_desc"></div></div><div class="post-copyright__post__info"><a class="post-copyright__original" title="该文章为原创文章，注意版权协议" href="https://adalucky.github.io/worker/Developer/webpack5/">原创</a><a class="post-copyright-title"><span onclick="rm.copyPageUrl('https://adalucky.github.io/worker/Developer/webpack5/')">webpack5</span></a></div><div class="post-tools" id="post-tools"><div class="post-tools-left"><div class="rewardLeftButton"><div class="post-reward" onclick="anzhiyu.addRewardMask()"><div class="reward-button button--animated" title="赞赏作者"><i class="anzhiyufont anzhiyu-icon-hand-heart-fill"></i>打赏作者</div><div class="reward-main"><div class="reward-all"><span class="reward-title">感谢你赐予我前进的力量</span><ul class="reward-group"><li class="reward-item"><a href="https://automation-manage.oss-cn-shanghai.aliyuncs.com/blog/wechat.png" target="_blank"><img class="post-qr-code-img" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://automation-manage.oss-cn-shanghai.aliyuncs.com/blog/wechat.png" alt="wechat"/></a><div class="post-qr-code-desc">wechat</div></li><li class="reward-item"><a href="https://automation-manage.oss-cn-shanghai.aliyuncs.com/blog/alipay.png" target="_blank"><img class="post-qr-code-img" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://automation-manage.oss-cn-shanghai.aliyuncs.com/blog/alipay.png" alt="alipay"/></a><div class="post-qr-code-desc">alipay</div></li></ul><a class="reward-main-btn" href="/about/#about-reward" target="_blank"><div class="reward-text">赞赏者名单</div><div class="reward-dec">因为你们的支持让我意识到写文章的价值🙏</div></a></div></div></div><div id="quit-box" onclick="anzhiyu.removeRewardMask()" style="display: none"></div></div><div class="shareRight"><div class="share-link mobile"><div class="share-qrcode"><div class="share-button" title="使用手机访问这篇文章"><i class="anzhiyufont anzhiyu-icon-qrcode"></i></div><div class="share-main"><div class="share-main-all"><div id="qrcode" title="https://adalucky.github.io/worker/Developer/webpack5/"></div><div class="reward-dec">使用手机访问这篇文章</div></div></div></div></div><div class="share-link weibo"><a class="share-button" target="_blank" href="https://service.weibo.com/share/share.php?title=webpack5&amp;url=https://adalucky.github.io/worker/Developer/webpack5/&amp;pic=https://automation-manage.oss-cn-shanghai.aliyuncs.com/blog/auto/webpack.jpg" rel="external nofollow noreferrer noopener"><i class="anzhiyufont anzhiyu-icon-weibo"></i></a></div><div class="share-link copyurl"><div class="share-button" id="post-share-url" title="复制链接" onclick="rm.copyPageUrl()"><i class="anzhiyufont anzhiyu-icon-link"></i></div></div></div></div></div><div class="post-copyright__notice"><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://adalucky.github.io" target="_blank">Ada</a>！</span></div></div><div class="post-tools-right"><div class="tag_share"><div class="post-meta__box"><div class="post-meta__box__tag-list"><a class="post-meta__box__tags" href="/tags/%E5%89%8D%E7%AB%AF%E5%9F%BA%E7%A1%80/"><span class="tags-punctuation"> <i class="anzhiyufont anzhiyu-icon-tag"></i></span>前端基础<span class="tagsPageCount">6</span></a><a class="post-meta__box__tags" href="/tags/Webpack/"><span class="tags-punctuation"> <i class="anzhiyufont anzhiyu-icon-tag"></i></span>Webpack<span class="tagsPageCount">1</span></a><a class="post-meta__box__tags" href="/tags/eslint/"><span class="tags-punctuation"> <i class="anzhiyufont anzhiyu-icon-tag"></i></span>eslint<span class="tagsPageCount">1</span></a></div></div></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/worker/Tester/Automation/Appium/"><img class="prev-cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://automation-manage.oss-cn-shanghai.aliyuncs.com/blog/auto/appium.jpeg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">Appium</div></div></a></div><div class="next-post pull-right"><a href="/worker/Developer/ES6/"><img class="next-cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://automation-manage.oss-cn-shanghai.aliyuncs.com/blog/auto/ES6.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">ECMAScript 6</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="anzhiyufont anzhiyu-icon-thumbs-up fa-fw" style="font-size: 1.5rem; margin-right: 4px"></i><span>猜你喜欢</span></div><div class="relatedPosts-list"><div><a href="/worker/Developer/TypeScript2/" title="TypeScript 下"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://automation-manage.oss-cn-shanghai.aliyuncs.com/blog/auto/TypeScript.png" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2022-06-03</div><div class="title">TypeScript 下</div></div></a></div><div><a href="/worker/Developer/TypeScript1/" title="TypeScript 上"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://automation-manage.oss-cn-shanghai.aliyuncs.com/blog/auto/TypeScript.png" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2022-05-21</div><div class="title">TypeScript 上</div></div></a></div><div><a href="/worker/Developer/Axios/" title="Axios"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://automation-manage.oss-cn-shanghai.aliyuncs.com/blog/auto/axios.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2022-02-26</div><div class="title">Axios</div></div></a></div><div><a href="/worker/Developer/ES6/" title="ECMAScript 6"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://automation-manage.oss-cn-shanghai.aliyuncs.com/blog/auto/ES6.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2022-02-24</div><div class="title">ECMAScript 6</div></div></a></div><div><a href="/worker/Developer/NPM/" title="NPM"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://automation-manage.oss-cn-shanghai.aliyuncs.com/blog/auto/npm.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2022-02-04</div><div class="title">NPM</div></div></a></div></div></div><hr/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="anzhiyufont anzhiyu-icon-comments"></i><span> 评论</span></div><div class="comment-randomInfo"><a onclick="anzhiyu.addRandomCommentInfo()" href="javascript:void(0)">匿名评论</a><a href="/privacy" style="margin-left: 4px">隐私政策</a></div></div><div class="comment-wrap"><div><div class="vcomment" id="vcomment"></div></div></div></div><div class="comment-barrage"></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="card-content"><div class="author-info__sayhi" id="author-info__sayhi" onclick="anzhiyu.changeSayHelloText()"></div><div class="author-info-top" title="点击展开"><div class="card-info-avatar"><div class="avatar-img"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://image.3001.net/images/20210606/16229390604952.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div></div></div><div class="author-info__description">我的个人博客</div></div></div><div class="card-widget anzhiyu-right-widget" id="card-wechat" onclick="null"><div id="flip-wrapper"><div id="flip-content"><div class="face" style="background: url(https://bu.dusays.com/2023/01/13/63c02edf44033.png) center center / 100% no-repeat"></div><div class="back face" style="background: url(https://automation-manage.oss-cn-shanghai.aliyuncs.com/blog/jqqdgzh.png) center center / 100% no-repeat"></div></div></div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-bars"></i><span>文章目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%AE%80%E4%BB%8B"><span class="toc-number">1.</span> <span class="toc-text">简介</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99"><span class="toc-number">1.0.1.</span> <span class="toc-text">参考资料</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%AE%80%E4%BB%8B%E5%AE%89%E8%A3%85%E9%85%8D%E7%BD%AE"><span class="toc-number">2.</span> <span class="toc-text">简介安装配置</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AE%80%E4%BB%8B-1"><span class="toc-number">2.1.</span> <span class="toc-text">简介</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#webpack%E5%8E%9F%E7%90%86%E5%92%8C%E6%A6%82%E5%BF%B5"><span class="toc-number">2.2.</span> <span class="toc-text">webpack原理和概念</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#webpack%E7%8E%AF%E5%A2%83%E5%AE%89%E8%A3%85"><span class="toc-number">2.3.</span> <span class="toc-text">webpack环境安装</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#webpack%E5%9F%BA%E7%A1%80%E9%85%8D%E7%BD%AE"><span class="toc-number">2.4.</span> <span class="toc-text">webpack基础配置</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#html%E8%B5%84%E6%BA%90%E6%89%93%E5%8C%85%E9%85%8D%E7%BD%AE"><span class="toc-number">3.</span> <span class="toc-text">html资源打包配置</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%8F%92%E4%BB%B6%E5%AE%89%E8%A3%85"><span class="toc-number">3.1.</span> <span class="toc-text">插件安装</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%85%8D%E7%BD%AEwebpack-config-js%E6%96%87%E4%BB%B6"><span class="toc-number">3.2.</span> <span class="toc-text">配置webpack.config.js文件</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%88%86%E5%BC%80%E6%89%93%E5%8C%85-html-%E6%96%87%E4%BB%B6"><span class="toc-number">3.3.</span> <span class="toc-text">分开打包 html 文件</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#css%E8%B5%84%E6%BA%90%E6%89%93%E5%8C%85"><span class="toc-number">4.</span> <span class="toc-text">css资源打包</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%86%85%E8%81%94%E6%89%93%E5%8C%85"><span class="toc-number">4.1.</span> <span class="toc-text">内联打包</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/worker/Toolbox/Hexo/" title="Hexo"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://automation-manage.oss-cn-shanghai.aliyuncs.com/blog/other/hexo.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Hexo"/></a><div class="content"><a class="title" href="/worker/Toolbox/Hexo/" title="Hexo">Hexo</a><time datetime="2023-08-14T16:00:00.000Z" title="发表于 2023-08-15 00:00:00">2023-08-15</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/worker/Backender/MongoDB/" title="MongoDB"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://automation-manage.oss-cn-shanghai.aliyuncs.com/blog/mongodb.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="MongoDB"/></a><div class="content"><a class="title" href="/worker/Backender/MongoDB/" title="MongoDB">MongoDB</a><time datetime="2023-07-04T16:00:00.000Z" title="发表于 2023-07-05 00:00:00">2023-07-05</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/worker/Ops/Docker%20Compose/" title="Docker Compose"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://automation-manage.oss-cn-shanghai.aliyuncs.com/blog/docker-compose.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Docker Compose"/></a><div class="content"><a class="title" href="/worker/Ops/Docker%20Compose/" title="Docker Compose">Docker Compose</a><time datetime="2023-06-26T16:00:00.000Z" title="发表于 2023-06-27 00:00:00">2023-06-27</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/worker/Ops/Linux%E5%91%BD%E4%BB%A4/" title="Linux 命令"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://automation-manage.oss-cn-shanghai.aliyuncs.com/blog/linux.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Linux 命令"/></a><div class="content"><a class="title" href="/worker/Ops/Linux%E5%91%BD%E4%BB%A4/" title="Linux 命令">Linux 命令</a><time datetime="2023-06-26T16:00:00.000Z" title="发表于 2023-06-27 00:00:00">2023-06-27</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/worker/Ops/asdf%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83%E7%AE%A1%E7%90%86/" title="asdf"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://automation-manage.oss-cn-shanghai.aliyuncs.com/blog/asdf.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="asdf"/></a><div class="content"><a class="title" href="/worker/Ops/asdf%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83%E7%AE%A1%E7%90%86/" title="asdf">asdf</a><time datetime="2023-06-13T16:00:00.000Z" title="发表于 2023-06-14 00:00:00">2023-06-14</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"></div><div id="footer-bar"><div class="footer-bar-links"><div class="footer-bar-left"><div id="footer-bar-tips"><div class="copyright">&copy;2020 - 2023 By <a class="footer-bar-link" href="/" title="Ada" target="_blank">Ada</a></div></div><div id="footer-type-tips"></div></div><div class="footer-bar-right"><a class="footer-bar-link" target="_blank" rel="noopener" href="https://github.com/anzhiyu-c/hexo-theme-anzhiyu" title="主题">主题</a></div></div></div></footer></div></div></div><div id="sidebar"><div id="sidebar-menus"><div class="avatar-img is-center"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://image.3001.net/images/20210606/16229390604952.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/" title="archive"><div class="headline">文章</div><div class="length-num">56</div></a><a href="/tags/" title="tag"><div class="headline">标签</div><div class="length-num">75</div></a><a href="/categories/" title="category"><div class="headline">分类</div><div class="length-num">8</div></a></div><div class="menus_items"><div class="menus_item"><a class="site-page faa-parent animated-hover" href="/archives/"><span> 总览</span></a></div><div class="menus_item"><a class="site-page faa-parent animated-hover" href="/categories/"><span> 分类</span></a></div><div class="menus_item"><a class="site-page faa-parent animated-hover" href="/tags/"><span> 标签</span></a></div></div></div></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="anzhiyufont anzhiyu-icon-book-open"></i></button><button id="translateLink" type="button" title="简繁转换">繁</button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="anzhiyufont anzhiyu-icon-circle-half-stroke"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="anzhiyufont anzhiyu-icon-arrows-left-right"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="anzhiyufont anzhiyu-icon-gear"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="anzhiyufont anzhiyu-icon-list-ul"></i></button><button id="chat_btn" type="button" title="聊天"><i class="anzhiyufont anzhiyu-icon-comment-sms"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="anzhiyufont anzhiyu-icon-comments"></i></a><a id="switch_commentBarrage" href="javascript:anzhiyu.switchCommentBarrage();" title="开关弹幕"><i class="anzhiyufont anzhiyu-icon-danmu"></i></a><button id="go-up" type="button" title="回到顶部"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i></button></div></div><div id="algolia-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><button class="search-close-button"><i class="anzhiyufont anzhiyu-icon-xmark"></i></button></nav><div class="search-wrap"><div id="algolia-search-input"></div><hr/><div id="algolia-search-results"><div id="algolia-hits"></div><div id="algolia-pagination"></div><div id="algolia-info"><div class="algolia-stats"></div><div class="algolia-poweredBy"></div></div></div></div></div><div id="search-mask"></div></div><div id="rightMenu"><div class="rightMenu-group rightMenu-small"><div class="rightMenu-item" id="menu-backward"><i class="anzhiyufont anzhiyu-icon-arrow-left"></i></div><div class="rightMenu-item" id="menu-forward"><i class="anzhiyufont anzhiyu-icon-arrow-right"></i></div><div class="rightMenu-item" id="menu-refresh"><i class="anzhiyufont anzhiyu-icon-arrow-rotate-right" style="font-size: 1rem;"></i></div><div class="rightMenu-item" id="menu-top"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i></div></div><div class="rightMenu-group rightMenu-line rightMenuPlugin"><div class="rightMenu-item" id="menu-copytext"><i class="anzhiyufont anzhiyu-icon-copy"></i><span>复制选中文本</span></div><div class="rightMenu-item" id="menu-pastetext"><i class="anzhiyufont anzhiyu-icon-paste"></i><span>粘贴文本</span></div><a class="rightMenu-item" id="menu-commenttext"><i class="anzhiyufont anzhiyu-icon-comment-medical"></i><span>引用到评论</span></a><div class="rightMenu-item" id="menu-newwindow"><i class="anzhiyufont anzhiyu-icon-window-restore"></i><span>新窗口打开</span></div><div class="rightMenu-item" id="menu-copylink"><i class="anzhiyufont anzhiyu-icon-link"></i><span>复制链接地址</span></div><div class="rightMenu-item" id="menu-copyimg"><i class="anzhiyufont anzhiyu-icon-images"></i><span>复制此图片</span></div><div class="rightMenu-item" id="menu-downloadimg"><i class="anzhiyufont anzhiyu-icon-download"></i><span>下载此图片</span></div><div class="rightMenu-item" id="menu-newwindowimg"><i class="anzhiyufont anzhiyu-icon-window-restore"></i><span>新窗口打开图片</span></div><div class="rightMenu-item" id="menu-search"><i class="anzhiyufont anzhiyu-icon-magnifying-glass"></i><span>站内搜索</span></div><div class="rightMenu-item" id="menu-searchBaidu"><i class="anzhiyufont anzhiyu-icon-magnifying-glass"></i><span>百度搜索</span></div><div class="rightMenu-item" id="menu-music-toggle"><i class="anzhiyufont anzhiyu-icon-play"></i><span>播放音乐</span></div><div class="rightMenu-item" id="menu-music-back"><i class="anzhiyufont anzhiyu-icon-backward"></i><span>切换到上一首</span></div><div class="rightMenu-item" id="menu-music-forward"><i class="anzhiyufont anzhiyu-icon-forward"></i><span>切换到下一首</span></div><div class="rightMenu-item" id="menu-music-playlist" onclick="window.open(&quot;https://y.qq.com/n/ryqq/playlist/8802438608&quot;, &quot;_blank&quot;);" style="display: none;"><i class="anzhiyufont anzhiyu-icon-radio"></i><span>查看所有歌曲</span></div><div class="rightMenu-item" id="menu-music-copyMusicName"><i class="anzhiyufont anzhiyu-icon-copy"></i><span>复制歌名</span></div></div><div class="rightMenu-group rightMenu-line rightMenuOther"><a class="rightMenu-item menu-link" id="menu-randomPost"><i class="anzhiyufont anzhiyu-icon-shuffle"></i><span>随便逛逛</span></a><a class="rightMenu-item menu-link" href="/categories/"><i class="anzhiyufont anzhiyu-icon-cube"></i><span>博客分类</span></a><a class="rightMenu-item menu-link" href="/tags/"><i class="anzhiyufont anzhiyu-icon-tags"></i><span>文章标签</span></a></div><div class="rightMenu-group rightMenu-line rightMenuOther"><a class="rightMenu-item" id="menu-copy" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-copy"></i><span>复制地址</span></a><a class="rightMenu-item" id="menu-commentBarrage" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-message"></i><span class="menu-commentBarrage-text">关闭热评</span></a><a class="rightMenu-item" id="menu-darkmode" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-circle-half-stroke"></i><span class="menu-darkmode-text">深色模式</span></a><a class="rightMenu-item" id="menu-translate" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-language"></i><span>轉為繁體</span></a></div></div><div id="rightmenu-mask"></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.cbd.int/@fancyapps/ui@5.0.20/dist/fancybox/fancybox.umd.js"></script><script src="https://cdn.cbd.int/instant.page@5.2.0/instantpage.js" type="module"></script><script src="https://cdn.cbd.int/vanilla-lazyload@17.3.1/dist/lazyload.iife.min.js"></script><script src="https://cdn.cbd.int/node-snackbar@0.1.16/dist/snackbar.min.js"></script><script>function panguFn () {
  if (typeof pangu === 'object') pangu.autoSpacingPage()
  else {
    getScript('https://cdn.cbd.int/pangu@4.0.7/dist/browser/pangu.min.js')
      .then(() => {
        pangu.autoSpacingPage()
      })
  }
}

function panguInit () {
  if (false){
    GLOBAL_CONFIG_SITE.isPost && panguFn()
  } else {
    panguFn()
  }
}

document.addEventListener('DOMContentLoaded', panguInit)</script><canvas id="universe"></canvas><script async src="https://npm.elemecdn.com/anzhiyu-theme-static@1.0.0/dark/dark.js"></script><script>// 消除控制台打印
var HoldLog = console.log;
console.log = function () {};
let now1 = new Date();
queueMicrotask(() => {
  const Log = function () {
    HoldLog.apply(console, arguments);
  }; //在恢复前输出日志
  const grt = new Date("07/01/2021 00:00:00"); //此处修改你的建站时间或者网站上线时间
  now1.setTime(now1.getTime() + 250);
  const days = (now1 - grt) / 1000 / 60 / 60 / 24;
  const dnum = Math.floor(days);
  const ascll = [
    `欢迎使用安知鱼!`,
    `生活明朗, 万物可爱`,
    `
        
       █████╗ ███╗   ██╗███████╗██╗  ██╗██╗██╗   ██╗██╗   ██╗
      ██╔══██╗████╗  ██║╚══███╔╝██║  ██║██║╚██╗ ██╔╝██║   ██║
      ███████║██╔██╗ ██║  ███╔╝ ███████║██║ ╚████╔╝ ██║   ██║
      ██╔══██║██║╚██╗██║ ███╔╝  ██╔══██║██║  ╚██╔╝  ██║   ██║
      ██║  ██║██║ ╚████║███████╗██║  ██║██║   ██║   ╚██████╔╝
      ╚═╝  ╚═╝╚═╝  ╚═══╝╚══════╝╚═╝  ╚═╝╚═╝   ╚═╝    ╚═════╝
        
        `,
    "已上线",
    dnum,
    "天",
    "©2020 By 安知鱼 V1.5.4",
  ];
  const ascll2 = [`NCC2-036`, `调用前置摄像头拍照成功，识别为【小笨蛋】.`, `Photo captured: `, `🤪`];

  setTimeout(
    Log.bind(
      console,
      `\n%c${ascll[0]} %c ${ascll[1]} %c ${ascll[2]} %c${ascll[3]}%c ${ascll[4]}%c ${ascll[5]}\n\n%c ${ascll[6]}\n`,
      "color:#3b70fc",
      "",
      "color:#3b70fc",
      "color:#3b70fc",
      "",
      "color:#3b70fc",
      ""
    )
  );
  setTimeout(
    Log.bind(
      console,
      `%c ${ascll2[0]} %c ${ascll2[1]} %c \n${ascll2[2]} %c\n${ascll2[3]}\n`,
      "color:white; background-color:#4fd953",
      "",
      "",
      'background:url("https://npm.elemecdn.com/anzhiyu-blog@1.1.6/img/post/common/tinggge.gif") no-repeat;font-size:450%'
    )
  );

  setTimeout(Log.bind(console, "%c WELCOME %c 你好，小笨蛋.", "color:white; background-color:#4f90d9", ""));

  setTimeout(
    console.warn.bind(
      console,
      "%c ⚡ Powered by 安知鱼 %c 你正在访问 Ada 的博客.",
      "color:white; background-color:#f0ad4e",
      ""
    )
  );

  setTimeout(Log.bind(console, "%c W23-12 %c 你已打开控制台.", "color:white; background-color:#4f90d9", ""));

  setTimeout(
    console.warn.bind(console, "%c S013-782 %c 你现在正处于监控中.", "color:white; background-color:#d9534f", "")
  );
});</script><script async src="/anzhiyu/random.js"></script><script src="https://cdn.cbd.int/algoliasearch@4.18.0/dist/algoliasearch-lite.umd.js"></script><script src="https://cdn.cbd.int/instantsearch.js@4.56.5/dist/instantsearch.production.min.js"></script><script src="/js/search/algolia.js"></script><div class="js-pjax"><script>function loadValine () {
  function initValine () {
    const valine = new Valine(Object.assign({
      el: '#vcomment',
      appId: 'HvNn2fnND9DnBkt32cvR8g5x-gzGzoHsz',
      appKey: '1FgE4n7EeWrdtvsJCcB20dfD',
      avatar: 'mp',
      serverURLs: '',
      emojiMaps: "",
      path: window.location.pathname,
      visitor: false
    }, null))
  }

  if (typeof Valine === 'function') initValine() 
  else getScript('https://cdn.cbd.int/valine@1.5.1/dist/Valine.min.js').then(initValine)
}

if ('Valine' === 'Valine' || !false) {
  if (false) anzhiyu.loadComment(document.getElementById('vcomment'),loadValine)
  else setTimeout(loadValine, 0)
} else {
  function loadOtherComment () {
    loadValine()
  }
}</script><input type="hidden" name="page-type" id="page-type" value="post"></div><script src="https://cdn.cbd.int/blueimp-md5@2.19.0/js/md5.min.js"></script><script>window.addEventListener('load', () => {
  const changeContent = (content) => {
    if (content === '') return content

    content = content.replace(/<img.*?src="(.*?)"?[^\>]+>/ig, '[图片]') // replace image link
    content = content.replace(/<a[^>]+?href=["']?([^"']+)["']?[^>]*>([^<]+)<\/a>/gi, '[链接]') // replace url
    content = content.replace(/<pre><code>.*?<\/pre>/gi, '[代码]') // replace code
    content = content.replace(/<[^>]+>/g,"") // remove html tag

    if (content.length > 150) {
      content = content.substring(0,150) + '...'
    }
    return content
  }

  const getIcon = (icon, mail) => {
    if (icon) return icon
    let defaultIcon = '?d=mp'
    let iconUrl = `https://gravatar.loli.net/avatar/${md5(mail.toLowerCase()) + defaultIcon}`
    return iconUrl
  }

  const generateHtml = array => {
    let result = ''

    if (array.length) {
      for (let i = 0; i < array.length; i++) {
        result += '<div class=\'aside-list-item\'>'

        if (true) {
          const name = 'data-lazy-src'
          result += `<a href='${array[i].url}' class='thumbnail'><img ${name}='${array[i].avatar}' alt='${array[i].nick}'></a>`
        }

        result += `<div class='content'>
        <a class='comment' href='${array[i].url}' title='${array[i].content}'>${array[i].content}</a>
        <div class='name'><span>${array[i].nick} / </span><time datetime="${array[i].date}">${anzhiyu.diffDate(array[i].date, true)}</time></div>
        </div></div>`
      }
    } else {
      result += '没有评论'
    }

    let $dom = document.querySelector('#card-newest-comments .aside-list')
    $dom.innerHTML= result
    window.lazyLoadInstance && window.lazyLoadInstance.update()
    window.pjax && window.pjax.refresh($dom)
  }

  const getComment = () => {
    const serverURL = 'https://HvNn2fnN.api.lncldglobal.com'

    var settings = {
      "method": "GET",
      "headers": {
        "X-LC-Id": 'HvNn2fnND9DnBkt32cvR8g5x-gzGzoHsz',
        "X-LC-Key": '1FgE4n7EeWrdtvsJCcB20dfD',
        "Content-Type": "application/json"
      },
    }

    fetch(`${serverURL}/1.1/classes/Comment?limit=6&order=-createdAt`,settings)
      .then(response => response.json())
      .then(data => {
        const valineArray = data.results.map(function (e) {
          return {
            'avatar': getIcon(e.QQAvatar, e.mail),
            'content': changeContent(e.comment),
            'nick': e.nick,
            'url': e.url + '#' + e.objectId,
            'date': e.updatedAt,
          }
        })
        saveToLocal.set('valine-newest-comments', JSON.stringify(valineArray), 10/(60*24))
        generateHtml(valineArray)
      }).catch(e => {
        const $dom = document.querySelector('#card-newest-comments .aside-list')
        $dom.innerHTML= "无法获取评论，请确认相关配置是否正确"
      }) 
  }

  const newestCommentInit = () => {
    if (document.querySelector('#card-newest-comments .aside-list')) {
      const data = saveToLocal.get('valine-newest-comments')
      if (data) {
        generateHtml(JSON.parse(data))
      } else {
        getComment()
      }
    }
  }

  newestCommentInit()
  document.addEventListener('pjax:complete', newestCommentInit)
})</script><script>var visitorMail = "visitor@anheyu.com";</script><script>//动态标题
let leaveTitle = 'w(ﾟДﾟ)w 不要走！再看看嘛！';
let backTitle = '♪(^∇^*)欢迎肥来！';
let OriginTitile = document.title
let titleTime
document.addEventListener('visibilitychange', function () {
  if (document.hidden) {
    //离开当前页面时标签显示内容
    document.title = leaveTitle
    clearTimeout(titleTime)
  } else {
    //返回当前页面时标签显示内容
    document.title = backTitle + OriginTitile
    //两秒后变回正常标题
    titleTime = setTimeout(function () {
      document.title = OriginTitile
    }, 2000)
  }
})</script><script async data-pjax src="https://cdn.cbd.int/anzhiyu-theme-static@1.0.0/waterfall/waterfall.js"></script><script src="https://lf3-cdn-tos.bytecdntp.com/cdn/expire-1-M/qrcodejs/1.0.0/qrcode.min.js"></script><script>// 初始化函数
let rm = {};

//禁止图片与超链接拖拽
let aElements = document.getElementsByTagName("a");
for (let i = 0; i < aElements.length; i++) {
  aElements[i].setAttribute("draggable", "false");
  let imgElements = aElements[i].getElementsByTagName("img");
  for (let j = 0; j < imgElements.length; j++) {
    imgElements[j].setAttribute("draggable", "false");
  }
}

// 显示菜单
rm.showRightMenu = function (isTrue, x = 0, y = 0) {
  console.info(x, y)
  let rightMenu = document.getElementById("rightMenu");
  rightMenu.style.top = x + "px";
  rightMenu.style.left = y + "px";
  if (isTrue) {
    rightMenu.style.display = "block";
    stopMaskScroll();
  } else {
    rightMenu.style.display = "none";
  }
};

// 隐藏菜单
rm.hideRightMenu = function () {
  rm.showRightMenu(false);
  let rightMenuMask = document.querySelector("#rightmenu-mask");
  rightMenuMask.style.display = "none";
};

// 尺寸
let rmWidth = document.getElementById("rightMenu").offsetWidth;
let rmHeight = document.getElementById("rightMenu").offsetHeight;

// 重新定义尺寸
rm.reloadrmSize = function () {
  rightMenu.style.visibility = "hidden";
  rightMenu.style.display = "block";
  // 获取宽度和高度
  rmWidth = document.getElementById("rightMenu").offsetWidth;
  rmHeight = document.getElementById("rightMenu").offsetHeight;
  rightMenu.style.visibility = "visible";
};

// 获取点击的href
let domhref = "";
let domImgSrc = "";
let globalEvent = null;

var oncontextmenuFunction = function (event) {
  if (document.body.clientWidth > 768) {
    let pageX = event.clientX + 10; //加10是为了防止显示时鼠标遮在菜单上
    let pageY = event.clientY;

    //其他额外菜单
    const $rightMenuOther = document.querySelector(".rightMenuOther");
    const $rightMenuPlugin = document.querySelector(".rightMenuPlugin");
    const $rightMenuCopyText = document.querySelector("#menu-copytext");
    const $rightMenuPasteText = document.querySelector("#menu-pastetext");
    const $rightMenuCommentText = document.querySelector("#menu-commenttext");
    const $rightMenuNewWindow = document.querySelector("#menu-newwindow");
    const $rightMenuNewWindowImg = document.querySelector("#menu-newwindowimg");
    const $rightMenuCopyLink = document.querySelector("#menu-copylink");
    const $rightMenuCopyImg = document.querySelector("#menu-copyimg");
    const $rightMenuDownloadImg = document.querySelector("#menu-downloadimg");
    const $rightMenuSearch = document.querySelector("#menu-search");
    const $rightMenuSearchBaidu = document.querySelector("#menu-searchBaidu");
    const $rightMenuMusicToggle = document.querySelector("#menu-music-toggle");
    const $rightMenuMusicBack = document.querySelector("#menu-music-back");
    const $rightMenuMusicForward = document.querySelector("#menu-music-forward");
    const $rightMenuMusicPlaylist = document.querySelector("#menu-music-playlist");
    const $rightMenuMusicCopyMusicName = document.querySelector("#menu-music-copyMusicName");

    let href = event.target.href;
    let imgsrc = event.target.currentSrc;

    // 判断模式 扩展模式为有事件
    let pluginMode = false;
    $rightMenuOther.style.display = "block";
    globalEvent = event;

    // 检查是否需要复制 是否有选中文本
    if (selectTextNow && window.getSelection()) {
      pluginMode = true;
      $rightMenuCopyText.style.display = "block";
      $rightMenuCommentText.style.display = "block";
      $rightMenuSearch.style.display = "block";
      $rightMenuSearchBaidu.style.display = "block";
    } else {
      $rightMenuCopyText.style.display = "none";
      $rightMenuCommentText.style.display = "none";
      $rightMenuSearchBaidu.style.display = "none";
      $rightMenuSearch.style.display = "none";
    }

    //检查是否右键点击了链接a标签
    if (href) {
      pluginMode = true;
      $rightMenuNewWindow.style.display = "block";
      $rightMenuCopyLink.style.display = "block";
      domhref = href;
    } else {
      $rightMenuNewWindow.style.display = "none";
      $rightMenuCopyLink.style.display = "none";
    }

    //检查是否需要复制图片
    if (imgsrc) {
      pluginMode = true;
      $rightMenuCopyImg.style.display = "block";
      $rightMenuDownloadImg.style.display = "block";
      $rightMenuNewWindowImg.style.display = "block";
      document.getElementById("rightMenu").style.width="12rem"
      domImgSrc = imgsrc;
    } else {
      $rightMenuCopyImg.style.display = "none";
      $rightMenuDownloadImg.style.display = "none";
      $rightMenuNewWindowImg.style.display = "none";
    }

    // 判断是否为输入框
    if (event.target.tagName.toLowerCase() === "input" || event.target.tagName.toLowerCase() === "textarea") {
      pluginMode = true;
      $rightMenuPasteText.style.display = "block";
    } else {
      $rightMenuPasteText.style.display = "none";
    }
    const navMusicEl = document.querySelector("#nav-music");
    //判断是否是音乐
    if (navMusicEl && navMusicEl.contains(event.target)) {
      pluginMode = true;
      $rightMenuMusicToggle.style.display = "block";
      $rightMenuMusicBack.style.display = "block";
      $rightMenuMusicForward.style.display = "block";
      $rightMenuMusicPlaylist.style.display = "block";
      $rightMenuMusicCopyMusicName.style.display = "block";
    } else {
      $rightMenuMusicToggle.style.display = "none";
      $rightMenuMusicBack.style.display = "none";
      $rightMenuMusicForward.style.display = "none";
      $rightMenuMusicPlaylist.style.display = "none";
      $rightMenuMusicCopyMusicName.style.display = "none";
    }

    // 如果不是扩展模式则隐藏扩展模块
    if (pluginMode) {
      $rightMenuOther.style.display = "none";
      $rightMenuPlugin.style.display = "block";
    } else {
      $rightMenuPlugin.style.display = "none";
    }

    rm.reloadrmSize();

    // 鼠标默认显示在鼠标右下方，当鼠标靠右或靠下时，将菜单显示在鼠标左方\上方
    if (pageX + rmWidth > window.innerWidth) {
      pageX -= rmWidth + 10;
    }
    if (pageY + rmHeight > window.innerHeight) {
      pageY -= pageY + rmHeight - window.innerHeight;
    }

    rm.showRightMenu(true, pageY, pageX);
    document.getElementById("rightmenu-mask").style.display = "flex";
    return false;
  }
};

// 监听右键初始化
window.oncontextmenu = oncontextmenuFunction

// 下载图片状态
rm.downloadimging = false;

// 复制图片到剪贴板
rm.writeClipImg = function (imgsrc) {
  console.log("按下复制");
  rm.hideRightMenu();
  anzhiyu.snackbarShow("正在下载中，请稍后", false, 10000);
  if (rm.downloadimging == false) {
    rm.downloadimging = true;
    setTimeout(function () {
      copyImage(imgsrc);
      anzhiyu.snackbarShow("复制成功！图片已添加盲水印，请遵守版权协议");
      rm.downloadimging = false;
    }, "10000");
  }
};

function imageToBlob(imageURL) {
  const img = new Image();
  const c = document.createElement("canvas");
  const ctx = c.getContext("2d");
  img.crossOrigin = "";
  img.src = imageURL;
  return new Promise(resolve => {
    img.onload = function () {
      c.width = this.naturalWidth;
      c.height = this.naturalHeight;
      ctx.drawImage(this, 0, 0);
      c.toBlob(
        blob => {
          // here the image is a blob
          resolve(blob);
        },
        "image/png",
        0.75
      );
    };
  });
}

async function copyImage(imageURL) {
  const blob = await imageToBlob(imageURL);
  const item = new ClipboardItem({ "image/png": blob });
  navigator.clipboard.write([item]);
}

rm.copyUrl = function (id) {
  const input = document.createElement("input"); // Create a new <input> element
  input.id = "copyVal"; // Set the id of the new element to "copyVal"
  document.body.appendChild(input); // Append the new element to the end of the <body> element
  
  const text = id;
  input.value = text;
  input.select();
  input.setSelectionRange(0, input.value.length);
  document.execCommand("copy");
  
  input.remove(); // Remove the <input> element from the DOM
};

function stopMaskScroll() {
  if (document.getElementById("rightmenu-mask")) {
    let xscroll = document.getElementById("rightmenu-mask");
    xscroll.addEventListener(
      "mousewheel",
      function (e) {
        //阻止浏览器默认方法
        rm.hideRightMenu();
        // e.preventDefault();
      },
      { passive: true }
    );
  }
  if (document.getElementById("rightMenu")) {
    let xscroll = document.getElementById("rightMenu");
    xscroll.addEventListener(
      "mousewheel",
      function (e) {
        //阻止浏览器默认方法
        rm.hideRightMenu();
        // e.preventDefault();
      },
      { passive: true }
    );
  }
}

rm.rightmenuCopyText = function (txt) {
  if (navigator.clipboard) {
    navigator.clipboard.writeText(txt);
  }
  rm.hideRightMenu();
};

rm.copyPageUrl = function (url) {
  if (!url) {
    url = window.location.href;
  }
  rm.copyUrl(url);
  anzhiyu.snackbarShow("复制链接地址成功", false, 2000);
  rm.hideRightMenu();
};

rm.sharePage = function () {
  var content = window.location.href;
  rm.copyUrl(url);
  anzhiyu.snackbarShow("复制链接地址成功", false, 2000);
  rm.hideRightMenu();
};

// 复制当前选中文本
var selectTextNow = "";
document.onmouseup = document.ondblclick = selceText;

function selceText() {
  var txt;
  if (document.selection) {
    txt = document.selection.createRange().text;
  } else {
    txt = window.getSelection().toString();
  }
  selectTextNow = txt !== "" ? txt : "";
}

// 读取剪切板
rm.readClipboard = function () {
  if (navigator.clipboard) {
    navigator.clipboard.readText().then(clipText => rm.insertAtCaret(globalEvent.target, clipText));
  }
};

// 粘贴文本到焦点
rm.insertAtCaret = function (elemt, value) {
  const startPos = elemt.selectionStart,
    endPos = elemt.selectionEnd;
  if (document.selection) {
    elemt.focus();
    var sel = document.selection.createRange();
    sel.text = value;
    elemt.focus();
  } else {
    if (startPos || startPos == "0") {
      var scrollTop = elemt.scrollTop;
      elemt.value = elemt.value.substring(0, startPos) + value + elemt.value.substring(endPos, elemt.value.length);
      elemt.focus();
      elemt.selectionStart = startPos + value.length;
      elemt.selectionEnd = startPos + value.length;
      elemt.scrollTop = scrollTop;
    } else {
      elemt.value += value;
      elemt.focus();
    }
  }
};

//粘贴文本
rm.pasteText = function () {
  const result = rm.readClipboard() || "";
  rm.hideRightMenu();
};

//引用到评论
rm.rightMenuCommentText = function (txt) {
  rm.hideRightMenu();
  const postCommentDom = document.getElementById("post-comment");
  var domTop = postCommentDom.offsetTop;
  window.scrollTo(0, domTop - 80);
  if (txt == "undefined" || txt == "null") txt = "好棒！";
  function setText() {
    setTimeout(() => {
      var input = document.getElementsByClassName("el-textarea__inner")[0];
      if (!input) setText();
      let evt = document.createEvent("HTMLEvents");
      evt.initEvent("input", true, true);
      let inputValue = replaceAll(txt, "\n", "\n> ");
      input.value = "> " + inputValue + "\n\n";
      input.dispatchEvent(evt);
      input.focus();
      input.setSelectionRange(-1, -1);
      if (document.getElementById("comment-tips")) {
        document.getElementById("comment-tips").classList.add("show");
      }
    }, 100);
  }
  setText();
};

//替换所有内容
function replaceAll(string, search, replace) {
  return string.split(search).join(replace);
}

// 百度搜索
rm.searchBaidu = function () {
  anzhiyu.snackbarShow("即将跳转到百度搜索", false, 2000);
  setTimeout(function () {
    window.open("https://www.baidu.com/s?wd=" + selectTextNow);
  }, "2000");
  rm.hideRightMenu();
};

//分享链接
rm.copyLink = function () {
  rm.rightmenuCopyText(domhref);
  anzhiyu.snackbarShow("已复制链接地址");
};

function addRightMenuClickEvent() {
  // 添加点击事件
  document.getElementById("menu-backward").addEventListener("click", function () {
  window.history.back();
    rm.hideRightMenu();
  });

  document.getElementById("menu-forward").addEventListener("click", function () {
    window.history.forward();
    rm.hideRightMenu();
  });

  document.getElementById("menu-refresh").addEventListener("click", function () {
    window.location.reload();
  });

  document.getElementById("menu-top").addEventListener("click", function () {
    anzhiyu.scrollToDest(0, 500);
    rm.hideRightMenu();
  });

  const menuLinks = document.querySelectorAll(".menu-link");
  menuLinks.forEach(function (link) {
    link.addEventListener("click", rm.hideRightMenu);
  });

  document.getElementById("menu-darkmode").addEventListener("click", anzhiyu.switchDarkMode);

  document.getElementById("menu-home") && document.getElementById("menu-home").addEventListener("click", function () {
    window.location.href = window.location.origin;
  });

  document.getElementById("menu-randomPost").addEventListener("click", function () {
    toRandomPost();
  });

  document.getElementById("menu-commentBarrage").addEventListener("click", anzhiyu.switchCommentBarrage);

  document.getElementById("rightmenu-mask").addEventListener("click", rm.hideRightMenu);

  document.getElementById("rightmenu-mask").addEventListener("contextmenu", function (event) {
    rm.hideRightMenu();
    event.preventDefault(); // Prevent the default context menu from appearing
  });

  document.getElementById("menu-copy").addEventListener("click", rm.copyPageUrl);

  document.getElementById("menu-pastetext").addEventListener("click", rm.pasteText);

  document.getElementById("menu-copytext").addEventListener("click", function () {
    rm.rightmenuCopyText(selectTextNow);
    anzhiyu.snackbarShow("复制成功，复制和转载请标注本文地址");
  });

  document.getElementById("menu-commenttext").addEventListener("click", function () {
    rm.rightMenuCommentText(selectTextNow);
  });

  document.getElementById("menu-newwindow").addEventListener("click", function () {
    window.open(domhref, "_blank");
    rm.hideRightMenu();
  });

  document.getElementById("menu-copylink").addEventListener("click", rm.copyLink);

  document.getElementById("menu-downloadimg").addEventListener("click", function () {
    anzhiyu.downloadImage(domImgSrc, "anzhiyu");
  });

  document.getElementById("menu-newwindowimg").addEventListener("click", function () {
    window.open(domImgSrc, "_blank");
    rm.hideRightMenu();
  });

  document.getElementById("menu-copyimg").addEventListener("click", function () {
    rm.writeClipImg(domImgSrc);
  });

  document.getElementById("menu-searchBaidu").addEventListener("click", rm.searchBaidu);

  //音乐
  document.getElementById("menu-music-toggle").addEventListener("click", anzhiyu.musicToggle);

  document.getElementById("menu-music-back").addEventListener("click", anzhiyu.musicSkipBack);

  document.getElementById("menu-music-forward").addEventListener("click", anzhiyu.musicSkipForward);

  document.getElementById("menu-music-copyMusicName").addEventListener("click", function () {
    rm.rightmenuCopyText(anzhiyu.musicGetName());
    anzhiyu.snackbarShow("复制歌曲名称成功", false, 3000);
  });

}

addRightMenuClickEvent();</script><script data-pjax>var themeColorMeta = document.querySelector('meta[name="theme-color"]');
var pageHeaderEl = document.getElementById("page-header");
var navMusicEl = document.getElementById("nav-music");
var consoleEl = document.getElementById("console");
// 已随机的歌曲
var selectRandomSong = [];
// 音乐默认声音大小
var musicVolume = 0.8;
// 是否切换了周杰伦音乐列表
var changeMusicListFlag = false;
// 当前默认播放列表
var defaultPlayMusicList = [];

document.getElementById("page-name").innerText = document.title.split(" | Ada")[0];
anzhiyu.initIndexEssay();
anzhiyu.changeTimeInEssay();
anzhiyu.removeBodyPaceClass();
anzhiyu.qrcodeCreate();
anzhiyu.changeTimeInAlbumDetail();
anzhiyu.reflashEssayWaterFall();
anzhiyu.sayhi();
anzhiyu.stopImgRightDrag();
anzhiyu.addNavBackgroundInit();
anzhiyu.setValueToBodyType();
anzhiyu.catalogActive();
anzhiyu.tagsPageActive();
anzhiyu.categoriesBarActive();
anzhiyu.topCategoriesBarScroll();
anzhiyu.switchRightClickMenuHotReview();
anzhiyu.getCustomPlayList();
anzhiyu.addEventListenerConsoleMusicList(false);
setTimeout(() => {if (typeof addFriendLinksInFooter === "function") {addFriendLinksInFooter();}}, 200)</script><link rel="stylesheet" href="https://cdn.cbd.int/anzhiyu-theme-static@1.1.9/icon/ali_iconfont_css.css"><script>(function(i,s,o,g,r,a,m){i["DaoVoiceObject"]=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;a.charset="utf-8";m.parentNode.insertBefore(a,m)})(window,document,"script",('https:' == document.location.protocol ? 'https:' : 'http:') + "//widget.daovoice.io/widget/51b8faf5.js","daovoice")
</script><script>var isChatBtn = true
daovoice('init', {
  app_id: '51b8faf5',},{
  launcher: { 
     disableLauncherIcon: isChatBtn // 悬浮 ICON 是否显示
  },
});
daovoice('update');

if (isChatBtn) {
  var chatBtnFn = () => {
    var chatBtn = document.getElementById("chat_btn")
    chatBtn.addEventListener("click", function(){
      daovoice('show')
    });
  }
  chatBtnFn()
} else {
  if (false) {
    function chatBtnHide () {
      daovoice('update', {},{
        launcher: { 
        disableLauncherIcon: true // 悬浮 ICON 是否显示
        },
      });
    }
    function chatBtnShow () {
      daovoice('update', {},{
        launcher: { 
        disableLauncherIcon: false // 悬浮 ICON 是否显示
        },
      });
    }
  }
}</script><link rel="stylesheet" href="https://cdn.cbd.int/anzhiyu-theme-static@1.0.0/aplayer/APlayer.min.css" media="print" onload="this.media='all'"><script src="https://cdn.cbd.int/anzhiyu-blog-static@1.0.1/js/APlayer.min.js"></script><script src="https://cdn.cbd.int/hexo-anzhiyu-music@1.0.1/assets/js/Meting2.min.js"></script><script src="https://cdn.cbd.int/pjax@0.2.8/pjax.min.js"></script><script>let pjaxSelectors = ["head > title","#config-diff","#body-wrap","#rightside-config-hide","#rightside-config-show",".js-pjax"]

var pjax = new Pjax({
  elements: 'a:not([target="_blank"])',
  selectors: pjaxSelectors,
  cacheBust: false,
  analytics: false,
  scrollRestoration: false
})

document.addEventListener('pjax:send', function () {
  // removeEventListener scroll 
  window.tocScrollFn && window.removeEventListener('scroll', window.tocScrollFn)
  window.scrollCollect && window.removeEventListener('scroll', scrollCollect)

  document.getElementById('rightside').style.cssText = "opacity: ''; transform: ''"
  
  if (window.aplayers) {
    for (let i = 0; i < window.aplayers.length; i++) {
      if (!window.aplayers[i].options.fixed) {
        window.aplayers[i].destroy()
      }
    }
  }

  typeof typed === 'object' && typed.destroy()

  //reset readmode
  const $bodyClassList = document.body.classList
  $bodyClassList.contains('read-mode') && $bodyClassList.remove('read-mode')
})

document.addEventListener('pjax:complete', function () {
  window.refreshFn()

  document.querySelectorAll('script[data-pjax]').forEach(item => {
    const newScript = document.createElement('script')
    const content = item.text || item.textContent || item.innerHTML || ""
    Array.from(item.attributes).forEach(attr => newScript.setAttribute(attr.name, attr.value))
    newScript.appendChild(document.createTextNode(content))
    item.parentNode.replaceChild(newScript, item)
  })

  GLOBAL_CONFIG.islazyload && window.lazyLoadInstance.update()

  typeof chatBtnFn === 'function' && chatBtnFn()
  typeof panguInit === 'function' && panguInit()

  // google analytics
  typeof gtag === 'function' && gtag('config', '', {'page_path': window.location.pathname});

  // baidu analytics
  typeof _hmt === 'object' && _hmt.push(['_trackPageview',window.location.pathname]);

  typeof loadMeting === 'function' && document.getElementsByClassName('aplayer').length && loadMeting()

  // prismjs
  typeof Prism === 'object' && Prism.highlightAll()
})

document.addEventListener('pjax:error', (e) => {
  if (e.request.status === 404) {
    pjax.loadUrl('/404.html')
  }
})</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script charset="UTF-8" src="https://cdn.cbd.int/anzhiyu-theme-static@1.1.5/accesskey/accesskey.js"></script></div><div id="popup-window"><div class="popup-window-title">通知</div><div class="popup-window-divider"></div><div class="popup-window-content"><div class="popup-tip">你好呀</div><div class="popup-link"><i class="anzhiyufont anzhiyu-icon-arrow-circle-right"></i></div></div></div><script>(function (w, d, s, id) {
            if (typeof (w.webpushr) !== 'undefined') return; w.webpushr = w.webpushr || function () { (w.webpushr.q = w.webpushr.q || []).push(arguments) }; var js, fjs = d.getElementsByTagName(s)[0]; js = d.createElement(s); js.id = id; js.async = 1; js.src = "https://cdn.webpushr.com/app.min.js";fjs.parentNode.appendChild(js);}(window, document, 'script', 'webpushr-jssdk'));webpushr('setup', { 'key': 'BJjeD4reRc-1D_UEhL5kJQ8sMsvWDWxrZjvv5Wg1G1OHaFJhaKNKofyRr208shfSmbYfP2v8u9hZ7LlTZ0LnXK0' });</script></body></html>